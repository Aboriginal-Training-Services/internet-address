var $E=Object.defineProperty;var bw=n=>{throw TypeError(n)};var BE=(n,e,t)=>e in n?$E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var W=(n,e,t)=>BE(n,typeof e!="symbol"?e+"":e,t),Hg=(n,e,t)=>e.has(n)||bw("Cannot "+t);var c=(n,e,t)=>(Hg(n,e,"read from private field"),t?t.call(n):e.get(n)),S=(n,e,t)=>e.has(n)?bw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),v=(n,e,t,s)=>(Hg(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),A=(n,e,t)=>(Hg(n,e,"access private method"),t);var Gt=(n,e,t,s)=>({set _(r){v(n,e,r,t)},get _(){return c(n,e,s)}});function UE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function zE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function HE(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var N1={exports:{}},dg={},j1={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kf=Symbol.for("react.element"),WE=Symbol.for("react.portal"),VE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),GE=Symbol.for("react.profiler"),XE=Symbol.for("react.provider"),KE=Symbol.for("react.context"),YE=Symbol.for("react.forward_ref"),QE=Symbol.for("react.suspense"),JE=Symbol.for("react.memo"),ZE=Symbol.for("react.lazy"),_w=Symbol.iterator;function ek(n){return n===null||typeof n!="object"?null:(n=_w&&n[_w]||n["@@iterator"],typeof n=="function"?n:null)}var C1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T1=Object.assign,P1={};function xu(n,e,t){this.props=n,this.context=e,this.refs=P1,this.updater=t||C1}xu.prototype.isReactComponent={};xu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};xu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function R1(){}R1.prototype=xu.prototype;function ev(n,e,t){this.props=n,this.context=e,this.refs=P1,this.updater=t||C1}var tv=ev.prototype=new R1;tv.constructor=ev;T1(tv,xu.prototype);tv.isPureReactComponent=!0;var Sw=Array.isArray,L1=Object.prototype.hasOwnProperty,sv={current:null},I1={key:!0,ref:!0,__self:!0,__source:!0};function M1(n,e,t){var s,r={},i=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)L1.call(e,s)&&!I1.hasOwnProperty(s)&&(r[s]=e[s]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),d=0;d<o;d++)l[d]=arguments[d+2];r.children=l}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)r[s]===void 0&&(r[s]=o[s]);return{$$typeof:kf,type:n,key:i,ref:a,props:r,_owner:sv.current}}function tk(n,e){return{$$typeof:kf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function nv(n){return typeof n=="object"&&n!==null&&n.$$typeof===kf}function sk(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Aw=/\/+/g;function Wg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?sk(""+n.key):e.toString(36)}function yp(n,e,t,s,r){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case kf:case WE:a=!0}}if(a)return a=n,r=r(a),n=s===""?"."+Wg(a,0):s,Sw(r)?(t="",n!=null&&(t=n.replace(Aw,"$&/")+"/"),yp(r,e,t,"",function(d){return d})):r!=null&&(nv(r)&&(r=tk(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(Aw,"$&/")+"/")+n)),e.push(r)),1;if(a=0,s=s===""?".":s+":",Sw(n))for(var o=0;o<n.length;o++){i=n[o];var l=s+Wg(i,o);a+=yp(i,e,t,l,r)}else if(l=ek(n),typeof l=="function")for(n=l.call(n),o=0;!(i=n.next()).done;)i=i.value,l=s+Wg(i,o++),a+=yp(i,e,t,l,r);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Hf(n,e,t){if(n==null)return n;var s=[],r=0;return yp(n,s,"","",function(i){return e.call(t,i,r++)}),s}function nk(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var as={current:null},vp={transition:null},rk={ReactCurrentDispatcher:as,ReactCurrentBatchConfig:vp,ReactCurrentOwner:sv};function D1(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:Hf,forEach:function(n,e,t){Hf(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Hf(n,function(){e++}),e},toArray:function(n){return Hf(n,function(e){return e})||[]},only:function(n){if(!nv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};me.Component=xu;me.Fragment=VE;me.Profiler=GE;me.PureComponent=ev;me.StrictMode=qE;me.Suspense=QE;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rk;me.act=D1;me.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=T1({},n.props),r=n.key,i=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=sv.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)L1.call(e,l)&&!I1.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=t;else if(1<l){o=Array(l);for(var d=0;d<l;d++)o[d]=arguments[d+2];s.children=o}return{$$typeof:kf,type:n.type,key:r,ref:i,props:s,_owner:a}};me.createContext=function(n){return n={$$typeof:KE,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:XE,_context:n},n.Consumer=n};me.createElement=M1;me.createFactory=function(n){var e=M1.bind(null,n);return e.type=n,e};me.createRef=function(){return{current:null}};me.forwardRef=function(n){return{$$typeof:YE,render:n}};me.isValidElement=nv;me.lazy=function(n){return{$$typeof:ZE,_payload:{_status:-1,_result:n},_init:nk}};me.memo=function(n,e){return{$$typeof:JE,type:n,compare:e===void 0?null:e}};me.startTransition=function(n){var e=vp.transition;vp.transition={};try{n()}finally{vp.transition=e}};me.unstable_act=D1;me.useCallback=function(n,e){return as.current.useCallback(n,e)};me.useContext=function(n){return as.current.useContext(n)};me.useDebugValue=function(){};me.useDeferredValue=function(n){return as.current.useDeferredValue(n)};me.useEffect=function(n,e){return as.current.useEffect(n,e)};me.useId=function(){return as.current.useId()};me.useImperativeHandle=function(n,e,t){return as.current.useImperativeHandle(n,e,t)};me.useInsertionEffect=function(n,e){return as.current.useInsertionEffect(n,e)};me.useLayoutEffect=function(n,e){return as.current.useLayoutEffect(n,e)};me.useMemo=function(n,e){return as.current.useMemo(n,e)};me.useReducer=function(n,e,t){return as.current.useReducer(n,e,t)};me.useRef=function(n){return as.current.useRef(n)};me.useState=function(n){return as.current.useState(n)};me.useSyncExternalStore=function(n,e,t){return as.current.useSyncExternalStore(n,e,t)};me.useTransition=function(){return as.current.useTransition()};me.version="18.3.1";j1.exports=me;var C=j1.exports;const O1=zE(C),ik=UE({__proto__:null,default:O1},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ak=C,ok=Symbol.for("react.element"),lk=Symbol.for("react.fragment"),ck=Object.prototype.hasOwnProperty,uk=ak.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dk={key:!0,ref:!0,__self:!0,__source:!0};function F1(n,e,t){var s,r={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)ck.call(e,s)&&!dk.hasOwnProperty(s)&&(r[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:ok,type:n,key:i,ref:a,props:r,_owner:uk.current}}dg.Fragment=lk;dg.jsx=F1;dg.jsxs=F1;N1.exports=dg;var u=N1.exports,$1={exports:{}},qs={},B1={exports:{}},U1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(P,O){var L=P.length;P.push(O);e:for(;0<L;){var H=L-1>>>1,G=P[H];if(0<r(G,O))P[H]=O,P[L]=G,L=H;else break e}}function t(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var O=P[0],L=P.pop();if(L!==O){P[0]=L;e:for(var H=0,G=P.length,ie=G>>>1;H<ie;){var U=2*(H+1)-1,X=P[U],he=U+1,le=P[he];if(0>r(X,L))he<G&&0>r(le,X)?(P[H]=le,P[he]=L,H=he):(P[H]=X,P[U]=L,H=U);else if(he<G&&0>r(le,L))P[H]=le,P[he]=L,H=he;else break e}}return O}function r(P,O){var L=P.sortIndex-O.sortIndex;return L!==0?L:P.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],d=[],h=1,f=null,p=3,m=!1,y=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(P){for(var O=t(d);O!==null;){if(O.callback===null)s(d);else if(O.startTime<=P)s(d),O.sortIndex=O.expirationTime,e(l,O);else break;O=t(d)}}function k(P){if(x=!1,b(P),!y)if(t(l)!==null)y=!0,B(E);else{var O=t(d);O!==null&&I(k,O.startTime-P)}}function E(P,O){y=!1,x&&(x=!1,g(T),T=-1),m=!0;var L=p;try{for(b(O),f=t(l);f!==null&&(!(f.expirationTime>O)||P&&!R());){var H=f.callback;if(typeof H=="function"){f.callback=null,p=f.priorityLevel;var G=H(f.expirationTime<=O);O=n.unstable_now(),typeof G=="function"?f.callback=G:f===t(l)&&s(l),b(O)}else s(l);f=t(l)}if(f!==null)var ie=!0;else{var U=t(d);U!==null&&I(k,U.startTime-O),ie=!1}return ie}finally{f=null,p=L,m=!1}}var N=!1,j=null,T=-1,M=5,F=-1;function R(){return!(n.unstable_now()-F<M)}function V(){if(j!==null){var P=n.unstable_now();F=P;var O=!0;try{O=j(!0,P)}finally{O?$():(N=!1,j=null)}}else N=!1}var $;if(typeof w=="function")$=function(){w(V)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,Z=D.port2;D.port1.onmessage=V,$=function(){Z.postMessage(null)}}else $=function(){_(V,0)};function B(P){j=P,N||(N=!0,$())}function I(P,O){T=_(function(){P(n.unstable_now())},O)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,B(E))},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(P){switch(p){case 1:case 2:case 3:var O=3;break;default:O=p}var L=p;p=O;try{return P()}finally{p=L}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(P,O){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var L=p;p=P;try{return O()}finally{p=L}},n.unstable_scheduleCallback=function(P,O,L){var H=n.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?H+L:H):L=H,P){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=L+G,P={id:h++,callback:O,priorityLevel:P,startTime:L,expirationTime:G,sortIndex:-1},L>H?(P.sortIndex=L,e(d,P),t(l)===null&&P===t(d)&&(x?(g(T),T=-1):x=!0,I(k,L-H))):(P.sortIndex=G,e(l,P),y||m||(y=!0,B(E))),P},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(P){var O=p;return function(){var L=p;p=O;try{return P.apply(this,arguments)}finally{p=L}}}})(U1);B1.exports=U1;var hk=B1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fk=C,Vs=hk;function z(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z1=new Set,_d={};function dl(n,e){lu(n,e),lu(n+"Capture",e)}function lu(n,e){for(_d[n]=e,n=0;n<e.length;n++)z1.add(e[n])}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),P0=Object.prototype.hasOwnProperty,pk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ew={},kw={};function mk(n){return P0.call(kw,n)?!0:P0.call(Ew,n)?!1:pk.test(n)?kw[n]=!0:(Ew[n]=!0,!1)}function gk(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function xk(n,e,t,s){if(e===null||typeof e>"u"||gk(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function os(n,e,t,s,r,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Rt[n]=new os(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Rt[e]=new os(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Rt[n]=new os(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Rt[n]=new os(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Rt[n]=new os(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Rt[n]=new os(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Rt[n]=new os(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Rt[n]=new os(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Rt[n]=new os(n,5,!1,n.toLowerCase(),null,!1,!1)});var rv=/[\-:]([a-z])/g;function iv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(rv,iv);Rt[e]=new os(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(rv,iv);Rt[e]=new os(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(rv,iv);Rt[e]=new os(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Rt[n]=new os(n,1,!1,n.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new os("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Rt[n]=new os(n,1,!1,n.toLowerCase(),null,!0,!0)});function av(n,e,t,s){var r=Rt.hasOwnProperty(e)?Rt[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xk(e,t,r,s)&&(t=null),s||r===null?mk(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,s=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var ui=fk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wf=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Il=Symbol.for("react.fragment"),ov=Symbol.for("react.strict_mode"),R0=Symbol.for("react.profiler"),H1=Symbol.for("react.provider"),W1=Symbol.for("react.context"),lv=Symbol.for("react.forward_ref"),L0=Symbol.for("react.suspense"),I0=Symbol.for("react.suspense_list"),cv=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),V1=Symbol.for("react.offscreen"),Nw=Symbol.iterator;function Au(n){return n===null||typeof n!="object"?null:(n=Nw&&n[Nw]||n["@@iterator"],typeof n=="function"?n:null)}var Ve=Object.assign,Vg;function $u(n){if(Vg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Vg=e&&e[1]||""}return`
`+Vg+n}var qg=!1;function Gg(n,e){if(!n||qg)return"";qg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){s=d}n.call(e.prototype)}else{try{throw Error()}catch(d){s=d}n()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=s.stack.split(`
`),a=r.length-1,o=i.length-1;1<=a&&0<=o&&r[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==i[o]){var l=`
`+r[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{qg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$u(n):""}function yk(n){switch(n.tag){case 5:return $u(n.type);case 16:return $u("Lazy");case 13:return $u("Suspense");case 19:return $u("SuspenseList");case 0:case 2:case 15:return n=Gg(n.type,!1),n;case 11:return n=Gg(n.type.render,!1),n;case 1:return n=Gg(n.type,!0),n;default:return""}}function M0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Il:return"Fragment";case Ll:return"Portal";case R0:return"Profiler";case ov:return"StrictMode";case L0:return"Suspense";case I0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case W1:return(n.displayName||"Context")+".Consumer";case H1:return(n._context.displayName||"Context")+".Provider";case lv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case cv:return e=n.displayName||null,e!==null?e:M0(n.type)||"Memo";case mi:e=n._payload,n=n._init;try{return M0(n(e))}catch{}}return null}function vk(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M0(e);case 8:return e===ov?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ya(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function q1(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wk(n){var e=q1(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){s=""+a,i.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Vf(n){n._valueTracker||(n._valueTracker=wk(n))}function G1(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=q1(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function lm(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function D0(n,e){var t=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function jw(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=ya(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X1(n,e){e=e.checked,e!=null&&av(n,"checked",e,!1)}function O0(n,e){X1(n,e);var t=ya(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?F0(n,e.type,t):e.hasOwnProperty("defaultValue")&&F0(n,e.type,ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Cw(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function F0(n,e,t){(e!=="number"||lm(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Bu=Array.isArray;function Kl(n,e,t,s){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&s&&(n[t].defaultSelected=!0)}else{for(t=""+ya(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,s&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function $0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Tw(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(z(92));if(Bu(t)){if(1<t.length)throw Error(z(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ya(t)}}function K1(n,e){var t=ya(e.value),s=ya(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function Pw(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Y1(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function B0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Y1(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var qf,Q1=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(qf=qf||document.createElement("div"),qf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Sd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bk=["Webkit","ms","Moz","O"];Object.keys(cd).forEach(function(n){bk.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),cd[e]=cd[n]})});function J1(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||cd.hasOwnProperty(n)&&cd[n]?(""+e).trim():e+"px"}function Z1(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,r=J1(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,r):n[t]=r}}var _k=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function U0(n,e){if(e){if(_k[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function z0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H0=null;function uv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var W0=null,Yl=null,Ql=null;function Rw(n){if(n=Cf(n)){if(typeof W0!="function")throw Error(z(280));var e=n.stateNode;e&&(e=gg(e),W0(n.stateNode,n.type,e))}}function e_(n){Yl?Ql?Ql.push(n):Ql=[n]:Yl=n}function t_(){if(Yl){var n=Yl,e=Ql;if(Ql=Yl=null,Rw(n),e)for(n=0;n<e.length;n++)Rw(e[n])}}function s_(n,e){return n(e)}function n_(){}var Xg=!1;function r_(n,e,t){if(Xg)return n(e,t);Xg=!0;try{return s_(n,e,t)}finally{Xg=!1,(Yl!==null||Ql!==null)&&(n_(),t_())}}function Ad(n,e){var t=n.stateNode;if(t===null)return null;var s=gg(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(z(231,e,typeof t));return t}var V0=!1;if(ii)try{var Eu={};Object.defineProperty(Eu,"passive",{get:function(){V0=!0}}),window.addEventListener("test",Eu,Eu),window.removeEventListener("test",Eu,Eu)}catch{V0=!1}function Sk(n,e,t,s,r,i,a,o,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(h){this.onError(h)}}var ud=!1,cm=null,um=!1,q0=null,Ak={onError:function(n){ud=!0,cm=n}};function Ek(n,e,t,s,r,i,a,o,l){ud=!1,cm=null,Sk.apply(Ak,arguments)}function kk(n,e,t,s,r,i,a,o,l){if(Ek.apply(this,arguments),ud){if(ud){var d=cm;ud=!1,cm=null}else throw Error(z(198));um||(um=!0,q0=d)}}function hl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function i_(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Lw(n){if(hl(n)!==n)throw Error(z(188))}function Nk(n){var e=n.alternate;if(!e){if(e=hl(n),e===null)throw Error(z(188));return e!==n?null:n}for(var t=n,s=e;;){var r=t.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){t=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===t)return Lw(r),n;if(i===s)return Lw(r),e;i=i.sibling}throw Error(z(188))}if(t.return!==s.return)t=r,s=i;else{for(var a=!1,o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a)throw Error(z(189))}}if(t.alternate!==s)throw Error(z(190))}if(t.tag!==3)throw Error(z(188));return t.stateNode.current===t?n:e}function a_(n){return n=Nk(n),n!==null?o_(n):null}function o_(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=o_(n);if(e!==null)return e;n=n.sibling}return null}var l_=Vs.unstable_scheduleCallback,Iw=Vs.unstable_cancelCallback,jk=Vs.unstable_shouldYield,Ck=Vs.unstable_requestPaint,Ye=Vs.unstable_now,Tk=Vs.unstable_getCurrentPriorityLevel,dv=Vs.unstable_ImmediatePriority,c_=Vs.unstable_UserBlockingPriority,dm=Vs.unstable_NormalPriority,Pk=Vs.unstable_LowPriority,u_=Vs.unstable_IdlePriority,hg=null,cr=null;function Rk(n){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot(hg,n,void 0,(n.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:Mk,Lk=Math.log,Ik=Math.LN2;function Mk(n){return n>>>=0,n===0?32:31-(Lk(n)/Ik|0)|0}var Gf=64,Xf=4194304;function Uu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function hm(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,r=n.suspendedLanes,i=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~r;o!==0?s=Uu(o):(i&=a,i!==0&&(s=Uu(i)))}else a=t&~r,a!==0?s=Uu(a):i!==0&&(s=Uu(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-In(e),r=1<<t,s|=n[t],e&=~r;return s}function Dk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ok(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,r=n.expirationTimes,i=n.pendingLanes;0<i;){var a=31-In(i),o=1<<a,l=r[a];l===-1?(!(o&t)||o&s)&&(r[a]=Dk(o,e)):l<=e&&(n.expiredLanes|=o),i&=~o}}function G0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function d_(){var n=Gf;return Gf<<=1,!(Gf&4194240)&&(Gf=64),n}function Kg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Nf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-In(e),n[e]=t}function Fk(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-In(t),i=1<<r;e[r]=0,s[r]=-1,n[r]=-1,t&=~i}}function hv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-In(t),r=1<<s;r&e|n[s]&e&&(n[s]|=e),t&=~r}}var Ee=0;function h_(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var f_,fv,p_,m_,g_,X0=!1,Kf=[],ca=null,ua=null,da=null,Ed=new Map,kd=new Map,yi=[],$k="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mw(n,e){switch(n){case"focusin":case"focusout":ca=null;break;case"dragenter":case"dragleave":ua=null;break;case"mouseover":case"mouseout":da=null;break;case"pointerover":case"pointerout":Ed.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kd.delete(e.pointerId)}}function ku(n,e,t,s,r,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=Cf(e),e!==null&&fv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function Bk(n,e,t,s,r){switch(e){case"focusin":return ca=ku(ca,n,e,t,s,r),!0;case"dragenter":return ua=ku(ua,n,e,t,s,r),!0;case"mouseover":return da=ku(da,n,e,t,s,r),!0;case"pointerover":var i=r.pointerId;return Ed.set(i,ku(Ed.get(i)||null,n,e,t,s,r)),!0;case"gotpointercapture":return i=r.pointerId,kd.set(i,ku(kd.get(i)||null,n,e,t,s,r)),!0}return!1}function x_(n){var e=za(n.target);if(e!==null){var t=hl(e);if(t!==null){if(e=t.tag,e===13){if(e=i_(t),e!==null){n.blockedOn=e,g_(n.priority,function(){p_(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function wp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=K0(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);H0=s,t.target.dispatchEvent(s),H0=null}else return e=Cf(t),e!==null&&fv(e),n.blockedOn=t,!1;e.shift()}return!0}function Dw(n,e,t){wp(n)&&t.delete(e)}function Uk(){X0=!1,ca!==null&&wp(ca)&&(ca=null),ua!==null&&wp(ua)&&(ua=null),da!==null&&wp(da)&&(da=null),Ed.forEach(Dw),kd.forEach(Dw)}function Nu(n,e){n.blockedOn===e&&(n.blockedOn=null,X0||(X0=!0,Vs.unstable_scheduleCallback(Vs.unstable_NormalPriority,Uk)))}function Nd(n){function e(r){return Nu(r,n)}if(0<Kf.length){Nu(Kf[0],n);for(var t=1;t<Kf.length;t++){var s=Kf[t];s.blockedOn===n&&(s.blockedOn=null)}}for(ca!==null&&Nu(ca,n),ua!==null&&Nu(ua,n),da!==null&&Nu(da,n),Ed.forEach(e),kd.forEach(e),t=0;t<yi.length;t++)s=yi[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<yi.length&&(t=yi[0],t.blockedOn===null);)x_(t),t.blockedOn===null&&yi.shift()}var Jl=ui.ReactCurrentBatchConfig,fm=!0;function zk(n,e,t,s){var r=Ee,i=Jl.transition;Jl.transition=null;try{Ee=1,pv(n,e,t,s)}finally{Ee=r,Jl.transition=i}}function Hk(n,e,t,s){var r=Ee,i=Jl.transition;Jl.transition=null;try{Ee=4,pv(n,e,t,s)}finally{Ee=r,Jl.transition=i}}function pv(n,e,t,s){if(fm){var r=K0(n,e,t,s);if(r===null)i0(n,e,s,pm,t),Mw(n,s);else if(Bk(r,n,e,t,s))s.stopPropagation();else if(Mw(n,s),e&4&&-1<$k.indexOf(n)){for(;r!==null;){var i=Cf(r);if(i!==null&&f_(i),i=K0(n,e,t,s),i===null&&i0(n,e,s,pm,t),i===r)break;r=i}r!==null&&s.stopPropagation()}else i0(n,e,s,null,t)}}var pm=null;function K0(n,e,t,s){if(pm=null,n=uv(s),n=za(n),n!==null)if(e=hl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=i_(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return pm=n,null}function y_(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Tk()){case dv:return 1;case c_:return 4;case dm:case Pk:return 16;case u_:return 536870912;default:return 16}default:return 16}}var aa=null,mv=null,bp=null;function v_(){if(bp)return bp;var n,e=mv,t=e.length,s,r="value"in aa?aa.value:aa.textContent,i=r.length;for(n=0;n<t&&e[n]===r[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===r[i-s];s++);return bp=r.slice(n,1<s?1-s:void 0)}function _p(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Yf(){return!0}function Ow(){return!1}function Gs(n){function e(t,s,r,i,a){this._reactName=t,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Yf:Ow,this.isPropagationStopped=Ow,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Yf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Yf)},persist:function(){},isPersistent:Yf}),e}var yu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gv=Gs(yu),jf=Ve({},yu,{view:0,detail:0}),Wk=Gs(jf),Yg,Qg,ju,fg=Ve({},jf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ju&&(ju&&n.type==="mousemove"?(Yg=n.screenX-ju.screenX,Qg=n.screenY-ju.screenY):Qg=Yg=0,ju=n),Yg)},movementY:function(n){return"movementY"in n?n.movementY:Qg}}),Fw=Gs(fg),Vk=Ve({},fg,{dataTransfer:0}),qk=Gs(Vk),Gk=Ve({},jf,{relatedTarget:0}),Jg=Gs(Gk),Xk=Ve({},yu,{animationName:0,elapsedTime:0,pseudoElement:0}),Kk=Gs(Xk),Yk=Ve({},yu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qk=Gs(Yk),Jk=Ve({},yu,{data:0}),$w=Gs(Jk),Zk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=tN[n])?!!e[n]:!1}function xv(){return sN}var nN=Ve({},jf,{key:function(n){if(n.key){var e=Zk[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=_p(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?eN[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xv,charCode:function(n){return n.type==="keypress"?_p(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?_p(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),rN=Gs(nN),iN=Ve({},fg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bw=Gs(iN),aN=Ve({},jf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xv}),oN=Gs(aN),lN=Ve({},yu,{propertyName:0,elapsedTime:0,pseudoElement:0}),cN=Gs(lN),uN=Ve({},fg,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),dN=Gs(uN),hN=[9,13,27,32],yv=ii&&"CompositionEvent"in window,dd=null;ii&&"documentMode"in document&&(dd=document.documentMode);var fN=ii&&"TextEvent"in window&&!dd,w_=ii&&(!yv||dd&&8<dd&&11>=dd),Uw=" ",zw=!1;function b_(n,e){switch(n){case"keyup":return hN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function __(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ml=!1;function pN(n,e){switch(n){case"compositionend":return __(e);case"keypress":return e.which!==32?null:(zw=!0,Uw);case"textInput":return n=e.data,n===Uw&&zw?null:n;default:return null}}function mN(n,e){if(Ml)return n==="compositionend"||!yv&&b_(n,e)?(n=v_(),bp=mv=aa=null,Ml=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return w_&&e.locale!=="ko"?null:e.data;default:return null}}var gN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!gN[n.type]:e==="textarea"}function S_(n,e,t,s){e_(s),e=mm(e,"onChange"),0<e.length&&(t=new gv("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var hd=null,jd=null;function xN(n){I_(n,0)}function pg(n){var e=Fl(n);if(G1(e))return n}function yN(n,e){if(n==="change")return e}var A_=!1;if(ii){var Zg;if(ii){var e0="oninput"in document;if(!e0){var Ww=document.createElement("div");Ww.setAttribute("oninput","return;"),e0=typeof Ww.oninput=="function"}Zg=e0}else Zg=!1;A_=Zg&&(!document.documentMode||9<document.documentMode)}function Vw(){hd&&(hd.detachEvent("onpropertychange",E_),jd=hd=null)}function E_(n){if(n.propertyName==="value"&&pg(jd)){var e=[];S_(e,jd,n,uv(n)),r_(xN,e)}}function vN(n,e,t){n==="focusin"?(Vw(),hd=e,jd=t,hd.attachEvent("onpropertychange",E_)):n==="focusout"&&Vw()}function wN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return pg(jd)}function bN(n,e){if(n==="click")return pg(e)}function _N(n,e){if(n==="input"||n==="change")return pg(e)}function SN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Dn=typeof Object.is=="function"?Object.is:SN;function Cd(n,e){if(Dn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var r=t[s];if(!P0.call(e,r)||!Dn(n[r],e[r]))return!1}return!0}function qw(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Gw(n,e){var t=qw(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qw(t)}}function k_(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?k_(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function N_(){for(var n=window,e=lm();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=lm(n.document)}return e}function vv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function AN(n){var e=N_(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&k_(t.ownerDocument.documentElement,t)){if(s!==null&&vv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!n.extend&&i>s&&(r=s,s=i,i=r),r=Gw(t,i);var a=Gw(t,s);r&&a&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),i>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var EN=ii&&"documentMode"in document&&11>=document.documentMode,Dl=null,Y0=null,fd=null,Q0=!1;function Xw(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Q0||Dl==null||Dl!==lm(s)||(s=Dl,"selectionStart"in s&&vv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),fd&&Cd(fd,s)||(fd=s,s=mm(Y0,"onSelect"),0<s.length&&(e=new gv("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Dl)))}function Qf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ol={animationend:Qf("Animation","AnimationEnd"),animationiteration:Qf("Animation","AnimationIteration"),animationstart:Qf("Animation","AnimationStart"),transitionend:Qf("Transition","TransitionEnd")},t0={},j_={};ii&&(j_=document.createElement("div").style,"AnimationEvent"in window||(delete Ol.animationend.animation,delete Ol.animationiteration.animation,delete Ol.animationstart.animation),"TransitionEvent"in window||delete Ol.transitionend.transition);function mg(n){if(t0[n])return t0[n];if(!Ol[n])return n;var e=Ol[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in j_)return t0[n]=e[t];return n}var C_=mg("animationend"),T_=mg("animationiteration"),P_=mg("animationstart"),R_=mg("transitionend"),L_=new Map,Kw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ea(n,e){L_.set(n,e),dl(e,[n])}for(var s0=0;s0<Kw.length;s0++){var n0=Kw[s0],kN=n0.toLowerCase(),NN=n0[0].toUpperCase()+n0.slice(1);Ea(kN,"on"+NN)}Ea(C_,"onAnimationEnd");Ea(T_,"onAnimationIteration");Ea(P_,"onAnimationStart");Ea("dblclick","onDoubleClick");Ea("focusin","onFocus");Ea("focusout","onBlur");Ea(R_,"onTransitionEnd");lu("onMouseEnter",["mouseout","mouseover"]);lu("onMouseLeave",["mouseout","mouseover"]);lu("onPointerEnter",["pointerout","pointerover"]);lu("onPointerLeave",["pointerout","pointerover"]);dl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dl("onBeforeInput",["compositionend","keypress","textInput","paste"]);dl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jN=new Set("cancel close invalid load scroll toggle".split(" ").concat(zu));function Yw(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,kk(s,e,void 0,n),n.currentTarget=null}function I_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],l=o.instance,d=o.currentTarget;if(o=o.listener,l!==i&&r.isPropagationStopped())break e;Yw(r,o,d),i=l}else for(a=0;a<s.length;a++){if(o=s[a],l=o.instance,d=o.currentTarget,o=o.listener,l!==i&&r.isPropagationStopped())break e;Yw(r,o,d),i=l}}}if(um)throw n=q0,um=!1,q0=null,n}function Ie(n,e){var t=e[sx];t===void 0&&(t=e[sx]=new Set);var s=n+"__bubble";t.has(s)||(M_(e,n,2,!1),t.add(s))}function r0(n,e,t){var s=0;e&&(s|=4),M_(t,n,s,e)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function Td(n){if(!n[Jf]){n[Jf]=!0,z1.forEach(function(t){t!=="selectionchange"&&(jN.has(t)||r0(t,!1,n),r0(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jf]||(e[Jf]=!0,r0("selectionchange",!1,e))}}function M_(n,e,t,s){switch(y_(e)){case 1:var r=zk;break;case 4:r=Hk;break;default:r=pv}t=r.bind(null,e,t,n),r=void 0,!V0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function i0(n,e,t,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=s.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=za(o),a===null)return;if(l=a.tag,l===5||l===6){s=i=a;continue e}o=o.parentNode}}s=s.return}r_(function(){var d=i,h=uv(t),f=[];e:{var p=L_.get(n);if(p!==void 0){var m=gv,y=n;switch(n){case"keypress":if(_p(t)===0)break e;case"keydown":case"keyup":m=rN;break;case"focusin":y="focus",m=Jg;break;case"focusout":y="blur",m=Jg;break;case"beforeblur":case"afterblur":m=Jg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Fw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=qk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=oN;break;case C_:case T_:case P_:m=Kk;break;case R_:m=cN;break;case"scroll":m=Wk;break;case"wheel":m=dN;break;case"copy":case"cut":case"paste":m=Qk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Bw}var x=(e&4)!==0,_=!x&&n==="scroll",g=x?p!==null?p+"Capture":null:p;x=[];for(var w=d,b;w!==null;){b=w;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,g!==null&&(k=Ad(w,g),k!=null&&x.push(Pd(w,k,b)))),_)break;w=w.return}0<x.length&&(p=new m(p,y,null,t,h),f.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==H0&&(y=t.relatedTarget||t.fromElement)&&(za(y)||y[ai]))break e;if((m||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=d,y=y?za(y):null,y!==null&&(_=hl(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=d),m!==y)){if(x=Fw,k="onMouseLeave",g="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(x=Bw,k="onPointerLeave",g="onPointerEnter",w="pointer"),_=m==null?p:Fl(m),b=y==null?p:Fl(y),p=new x(k,w+"leave",m,t,h),p.target=_,p.relatedTarget=b,k=null,za(h)===d&&(x=new x(g,w+"enter",y,t,h),x.target=b,x.relatedTarget=_,k=x),_=k,m&&y)t:{for(x=m,g=y,w=0,b=x;b;b=wl(b))w++;for(b=0,k=g;k;k=wl(k))b++;for(;0<w-b;)x=wl(x),w--;for(;0<b-w;)g=wl(g),b--;for(;w--;){if(x===g||g!==null&&x===g.alternate)break t;x=wl(x),g=wl(g)}x=null}else x=null;m!==null&&Qw(f,p,m,x,!1),y!==null&&_!==null&&Qw(f,_,y,x,!0)}}e:{if(p=d?Fl(d):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var E=yN;else if(Hw(p))if(A_)E=_N;else{E=wN;var N=vN}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(E=bN);if(E&&(E=E(n,d))){S_(f,E,t,h);break e}N&&N(n,p,d),n==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&F0(p,"number",p.value)}switch(N=d?Fl(d):window,n){case"focusin":(Hw(N)||N.contentEditable==="true")&&(Dl=N,Y0=d,fd=null);break;case"focusout":fd=Y0=Dl=null;break;case"mousedown":Q0=!0;break;case"contextmenu":case"mouseup":case"dragend":Q0=!1,Xw(f,t,h);break;case"selectionchange":if(EN)break;case"keydown":case"keyup":Xw(f,t,h)}var j;if(yv)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ml?b_(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(w_&&t.locale!=="ko"&&(Ml||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ml&&(j=v_()):(aa=h,mv="value"in aa?aa.value:aa.textContent,Ml=!0)),N=mm(d,T),0<N.length&&(T=new $w(T,n,null,t,h),f.push({event:T,listeners:N}),j?T.data=j:(j=__(t),j!==null&&(T.data=j)))),(j=fN?pN(n,t):mN(n,t))&&(d=mm(d,"onBeforeInput"),0<d.length&&(h=new $w("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:d}),h.data=j))}I_(f,e)})}function Pd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function mm(n,e){for(var t=e+"Capture",s=[];n!==null;){var r=n,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Ad(n,t),i!=null&&s.unshift(Pd(n,i,r)),i=Ad(n,e),i!=null&&s.push(Pd(n,i,r))),n=n.return}return s}function wl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Qw(n,e,t,s,r){for(var i=e._reactName,a=[];t!==null&&t!==s;){var o=t,l=o.alternate,d=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&d!==null&&(o=d,r?(l=Ad(t,i),l!=null&&a.unshift(Pd(t,l,o))):r||(l=Ad(t,i),l!=null&&a.push(Pd(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var CN=/\r\n?/g,TN=/\u0000|\uFFFD/g;function Jw(n){return(typeof n=="string"?n:""+n).replace(CN,`
`).replace(TN,"")}function Zf(n,e,t){if(e=Jw(e),Jw(n)!==e&&t)throw Error(z(425))}function gm(){}var J0=null,Z0=null;function ex(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tx=typeof setTimeout=="function"?setTimeout:void 0,PN=typeof clearTimeout=="function"?clearTimeout:void 0,Zw=typeof Promise=="function"?Promise:void 0,RN=typeof queueMicrotask=="function"?queueMicrotask:typeof Zw<"u"?function(n){return Zw.resolve(null).then(n).catch(LN)}:tx;function LN(n){setTimeout(function(){throw n})}function a0(n,e){var t=e,s=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(s===0){n.removeChild(r),Nd(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=r}while(t);Nd(e)}function ha(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function eb(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var vu=Math.random().toString(36).slice(2),or="__reactFiber$"+vu,Rd="__reactProps$"+vu,ai="__reactContainer$"+vu,sx="__reactEvents$"+vu,IN="__reactListeners$"+vu,MN="__reactHandles$"+vu;function za(n){var e=n[or];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ai]||t[or]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=eb(n);n!==null;){if(t=n[or])return t;n=eb(n)}return e}n=t,t=n.parentNode}return null}function Cf(n){return n=n[or]||n[ai],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Fl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(z(33))}function gg(n){return n[Rd]||null}var nx=[],$l=-1;function ka(n){return{current:n}}function Me(n){0>$l||(n.current=nx[$l],nx[$l]=null,$l--)}function Re(n,e){$l++,nx[$l]=n.current,n.current=e}var va={},qt=ka(va),ys=ka(!1),nl=va;function cu(n,e){var t=n.type.contextTypes;if(!t)return va;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in t)r[i]=e[i];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function vs(n){return n=n.childContextTypes,n!=null}function xm(){Me(ys),Me(qt)}function tb(n,e,t){if(qt.current!==va)throw Error(z(168));Re(qt,e),Re(ys,t)}function D_(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(z(108,vk(n)||"Unknown",r));return Ve({},t,s)}function ym(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||va,nl=qt.current,Re(qt,n),Re(ys,ys.current),!0}function sb(n,e,t){var s=n.stateNode;if(!s)throw Error(z(169));t?(n=D_(n,e,nl),s.__reactInternalMemoizedMergedChildContext=n,Me(ys),Me(qt),Re(qt,n)):Me(ys),Re(ys,t)}var br=null,xg=!1,o0=!1;function O_(n){br===null?br=[n]:br.push(n)}function DN(n){xg=!0,O_(n)}function Na(){if(!o0&&br!==null){o0=!0;var n=0,e=Ee;try{var t=br;for(Ee=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}br=null,xg=!1}catch(r){throw br!==null&&(br=br.slice(n+1)),l_(dv,Na),r}finally{Ee=e,o0=!1}}return null}var Bl=[],Ul=0,vm=null,wm=0,nn=[],rn=0,rl=null,Zr=1,ei="";function La(n,e){Bl[Ul++]=wm,Bl[Ul++]=vm,vm=n,wm=e}function F_(n,e,t){nn[rn++]=Zr,nn[rn++]=ei,nn[rn++]=rl,rl=n;var s=Zr;n=ei;var r=32-In(s)-1;s&=~(1<<r),t+=1;var i=32-In(e)+r;if(30<i){var a=r-r%5;i=(s&(1<<a)-1).toString(32),s>>=a,r-=a,Zr=1<<32-In(e)+r|t<<r|s,ei=i+n}else Zr=1<<i|t<<r|s,ei=n}function wv(n){n.return!==null&&(La(n,1),F_(n,1,0))}function bv(n){for(;n===vm;)vm=Bl[--Ul],Bl[Ul]=null,wm=Bl[--Ul],Bl[Ul]=null;for(;n===rl;)rl=nn[--rn],nn[rn]=null,ei=nn[--rn],nn[rn]=null,Zr=nn[--rn],nn[rn]=null}var Hs=null,Us=null,Be=!1,Rn=null;function $_(n,e){var t=on(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function nb(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Hs=n,Us=ha(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Hs=n,Us=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=rl!==null?{id:Zr,overflow:ei}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=on(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Hs=n,Us=null,!0):!1;default:return!1}}function rx(n){return(n.mode&1)!==0&&(n.flags&128)===0}function ix(n){if(Be){var e=Us;if(e){var t=e;if(!nb(n,e)){if(rx(n))throw Error(z(418));e=ha(t.nextSibling);var s=Hs;e&&nb(n,e)?$_(s,t):(n.flags=n.flags&-4097|2,Be=!1,Hs=n)}}else{if(rx(n))throw Error(z(418));n.flags=n.flags&-4097|2,Be=!1,Hs=n}}}function rb(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Hs=n}function ep(n){if(n!==Hs)return!1;if(!Be)return rb(n),Be=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!ex(n.type,n.memoizedProps)),e&&(e=Us)){if(rx(n))throw B_(),Error(z(418));for(;e;)$_(n,e),e=ha(e.nextSibling)}if(rb(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(z(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Us=ha(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Us=null}}else Us=Hs?ha(n.stateNode.nextSibling):null;return!0}function B_(){for(var n=Us;n;)n=ha(n.nextSibling)}function uu(){Us=Hs=null,Be=!1}function _v(n){Rn===null?Rn=[n]:Rn.push(n)}var ON=ui.ReactCurrentBatchConfig;function Cu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(z(309));var s=t.stateNode}if(!s)throw Error(z(147,n));var r=s,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=r.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof n!="string")throw Error(z(284));if(!t._owner)throw Error(z(290,n))}return n}function tp(n,e){throw n=Object.prototype.toString.call(e),Error(z(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ib(n){var e=n._init;return e(n._payload)}function U_(n){function e(g,w){if(n){var b=g.deletions;b===null?(g.deletions=[w],g.flags|=16):b.push(w)}}function t(g,w){if(!n)return null;for(;w!==null;)e(g,w),w=w.sibling;return null}function s(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function r(g,w){return g=ga(g,w),g.index=0,g.sibling=null,g}function i(g,w,b){return g.index=b,n?(b=g.alternate,b!==null?(b=b.index,b<w?(g.flags|=2,w):b):(g.flags|=2,w)):(g.flags|=1048576,w)}function a(g){return n&&g.alternate===null&&(g.flags|=2),g}function o(g,w,b,k){return w===null||w.tag!==6?(w=p0(b,g.mode,k),w.return=g,w):(w=r(w,b),w.return=g,w)}function l(g,w,b,k){var E=b.type;return E===Il?h(g,w,b.props.children,k,b.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===mi&&ib(E)===w.type)?(k=r(w,b.props),k.ref=Cu(g,w,b),k.return=g,k):(k=Cp(b.type,b.key,b.props,null,g.mode,k),k.ref=Cu(g,w,b),k.return=g,k)}function d(g,w,b,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=m0(b,g.mode,k),w.return=g,w):(w=r(w,b.children||[]),w.return=g,w)}function h(g,w,b,k,E){return w===null||w.tag!==7?(w=tl(b,g.mode,k,E),w.return=g,w):(w=r(w,b),w.return=g,w)}function f(g,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=p0(""+w,g.mode,b),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wf:return b=Cp(w.type,w.key,w.props,null,g.mode,b),b.ref=Cu(g,null,w),b.return=g,b;case Ll:return w=m0(w,g.mode,b),w.return=g,w;case mi:var k=w._init;return f(g,k(w._payload),b)}if(Bu(w)||Au(w))return w=tl(w,g.mode,b,null),w.return=g,w;tp(g,w)}return null}function p(g,w,b,k){var E=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:o(g,w,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Wf:return b.key===E?l(g,w,b,k):null;case Ll:return b.key===E?d(g,w,b,k):null;case mi:return E=b._init,p(g,w,E(b._payload),k)}if(Bu(b)||Au(b))return E!==null?null:h(g,w,b,k,null);tp(g,b)}return null}function m(g,w,b,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(b)||null,o(w,g,""+k,E);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Wf:return g=g.get(k.key===null?b:k.key)||null,l(w,g,k,E);case Ll:return g=g.get(k.key===null?b:k.key)||null,d(w,g,k,E);case mi:var N=k._init;return m(g,w,b,N(k._payload),E)}if(Bu(k)||Au(k))return g=g.get(b)||null,h(w,g,k,E,null);tp(w,k)}return null}function y(g,w,b,k){for(var E=null,N=null,j=w,T=w=0,M=null;j!==null&&T<b.length;T++){j.index>T?(M=j,j=null):M=j.sibling;var F=p(g,j,b[T],k);if(F===null){j===null&&(j=M);break}n&&j&&F.alternate===null&&e(g,j),w=i(F,w,T),N===null?E=F:N.sibling=F,N=F,j=M}if(T===b.length)return t(g,j),Be&&La(g,T),E;if(j===null){for(;T<b.length;T++)j=f(g,b[T],k),j!==null&&(w=i(j,w,T),N===null?E=j:N.sibling=j,N=j);return Be&&La(g,T),E}for(j=s(g,j);T<b.length;T++)M=m(j,g,T,b[T],k),M!==null&&(n&&M.alternate!==null&&j.delete(M.key===null?T:M.key),w=i(M,w,T),N===null?E=M:N.sibling=M,N=M);return n&&j.forEach(function(R){return e(g,R)}),Be&&La(g,T),E}function x(g,w,b,k){var E=Au(b);if(typeof E!="function")throw Error(z(150));if(b=E.call(b),b==null)throw Error(z(151));for(var N=E=null,j=w,T=w=0,M=null,F=b.next();j!==null&&!F.done;T++,F=b.next()){j.index>T?(M=j,j=null):M=j.sibling;var R=p(g,j,F.value,k);if(R===null){j===null&&(j=M);break}n&&j&&R.alternate===null&&e(g,j),w=i(R,w,T),N===null?E=R:N.sibling=R,N=R,j=M}if(F.done)return t(g,j),Be&&La(g,T),E;if(j===null){for(;!F.done;T++,F=b.next())F=f(g,F.value,k),F!==null&&(w=i(F,w,T),N===null?E=F:N.sibling=F,N=F);return Be&&La(g,T),E}for(j=s(g,j);!F.done;T++,F=b.next())F=m(j,g,T,F.value,k),F!==null&&(n&&F.alternate!==null&&j.delete(F.key===null?T:F.key),w=i(F,w,T),N===null?E=F:N.sibling=F,N=F);return n&&j.forEach(function(V){return e(g,V)}),Be&&La(g,T),E}function _(g,w,b,k){if(typeof b=="object"&&b!==null&&b.type===Il&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Wf:e:{for(var E=b.key,N=w;N!==null;){if(N.key===E){if(E=b.type,E===Il){if(N.tag===7){t(g,N.sibling),w=r(N,b.props.children),w.return=g,g=w;break e}}else if(N.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===mi&&ib(E)===N.type){t(g,N.sibling),w=r(N,b.props),w.ref=Cu(g,N,b),w.return=g,g=w;break e}t(g,N);break}else e(g,N);N=N.sibling}b.type===Il?(w=tl(b.props.children,g.mode,k,b.key),w.return=g,g=w):(k=Cp(b.type,b.key,b.props,null,g.mode,k),k.ref=Cu(g,w,b),k.return=g,g=k)}return a(g);case Ll:e:{for(N=b.key;w!==null;){if(w.key===N)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(g,w.sibling),w=r(w,b.children||[]),w.return=g,g=w;break e}else{t(g,w);break}else e(g,w);w=w.sibling}w=m0(b,g.mode,k),w.return=g,g=w}return a(g);case mi:return N=b._init,_(g,w,N(b._payload),k)}if(Bu(b))return y(g,w,b,k);if(Au(b))return x(g,w,b,k);tp(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(g,w.sibling),w=r(w,b),w.return=g,g=w):(t(g,w),w=p0(b,g.mode,k),w.return=g,g=w),a(g)):t(g,w)}return _}var du=U_(!0),z_=U_(!1),bm=ka(null),_m=null,zl=null,Sv=null;function Av(){Sv=zl=_m=null}function Ev(n){var e=bm.current;Me(bm),n._currentValue=e}function ax(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Zl(n,e){_m=n,Sv=zl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(xs=!0),n.firstContext=null)}function hn(n){var e=n._currentValue;if(Sv!==n)if(n={context:n,memoizedValue:e,next:null},zl===null){if(_m===null)throw Error(z(308));zl=n,_m.dependencies={lanes:0,firstContext:n}}else zl=zl.next=n;return e}var Ha=null;function kv(n){Ha===null?Ha=[n]:Ha.push(n)}function H_(n,e,t,s){var r=e.interleaved;return r===null?(t.next=t,kv(e)):(t.next=r.next,r.next=t),e.interleaved=t,oi(n,s)}function oi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var gi=!1;function Nv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W_(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ti(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function fa(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,ye&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,oi(n,t)}return r=s.interleaved,r===null?(e.next=e,kv(s)):(e.next=r.next,r.next=e),s.interleaved=e,oi(n,t)}function Sp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,hv(n,t)}}function ab(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var r=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?r=i=a:i=i.next=a,t=t.next}while(t!==null);i===null?r=i=e:i=i.next=e}else r=i=e;t={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Sm(n,e,t,s){var r=n.updateQueue;gi=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,d=l.next;l.next=null,a===null?i=d:a.next=d,a=l;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=d:o.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=r.baseState;a=0,h=d=l=null,o=i;do{var p=o.lane,m=o.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=n,x=o;switch(p=e,m=t,x.tag){case 1:if(y=x.payload,typeof y=="function"){f=y.call(m,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(m,f,p):y,p==null)break e;f=Ve({},f,p);break e;case 2:gi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(d=h=m,l=f):h=h.next=m,a|=p;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;p=o,o=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(h===null&&(l=f),r.baseState=l,r.firstBaseUpdate=d,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);al|=a,n.lanes=a,n.memoizedState=f}}function ob(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],r=s.callback;if(r!==null){if(s.callback=null,s=t,typeof r!="function")throw Error(z(191,r));r.call(s)}}}var Tf={},ur=ka(Tf),Ld=ka(Tf),Id=ka(Tf);function Wa(n){if(n===Tf)throw Error(z(174));return n}function jv(n,e){switch(Re(Id,e),Re(Ld,n),Re(ur,Tf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:B0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=B0(e,n)}Me(ur),Re(ur,e)}function hu(){Me(ur),Me(Ld),Me(Id)}function V_(n){Wa(Id.current);var e=Wa(ur.current),t=B0(e,n.type);e!==t&&(Re(Ld,n),Re(ur,t))}function Cv(n){Ld.current===n&&(Me(ur),Me(Ld))}var He=ka(0);function Am(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var l0=[];function Tv(){for(var n=0;n<l0.length;n++)l0[n]._workInProgressVersionPrimary=null;l0.length=0}var Ap=ui.ReactCurrentDispatcher,c0=ui.ReactCurrentBatchConfig,il=0,We=null,ct=null,wt=null,Em=!1,pd=!1,Md=0,FN=0;function It(){throw Error(z(321))}function Pv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Dn(n[t],e[t]))return!1;return!0}function Rv(n,e,t,s,r,i){if(il=i,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ap.current=n===null||n.memoizedState===null?zN:HN,n=t(s,r),pd){i=0;do{if(pd=!1,Md=0,25<=i)throw Error(z(301));i+=1,wt=ct=null,e.updateQueue=null,Ap.current=WN,n=t(s,r)}while(pd)}if(Ap.current=km,e=ct!==null&&ct.next!==null,il=0,wt=ct=We=null,Em=!1,e)throw Error(z(300));return n}function Lv(){var n=Md!==0;return Md=0,n}function Hn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?We.memoizedState=wt=n:wt=wt.next=n,wt}function fn(){if(ct===null){var n=We.alternate;n=n!==null?n.memoizedState:null}else n=ct.next;var e=wt===null?We.memoizedState:wt.next;if(e!==null)wt=e,ct=n;else{if(n===null)throw Error(z(310));ct=n,n={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},wt===null?We.memoizedState=wt=n:wt=wt.next=n}return wt}function Dd(n,e){return typeof e=="function"?e(n):e}function u0(n){var e=fn(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var s=ct,r=s.baseQueue,i=t.pending;if(i!==null){if(r!==null){var a=r.next;r.next=i.next,i.next=a}s.baseQueue=r=i,t.pending=null}if(r!==null){i=r.next,s=s.baseState;var o=a=null,l=null,d=i;do{var h=d.lane;if((il&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:n(s,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(o=l=f,a=s):l=l.next=f,We.lanes|=h,al|=h}d=d.next}while(d!==null&&d!==i);l===null?a=s:l.next=o,Dn(s,e.memoizedState)||(xs=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=l,t.lastRenderedState=s}if(n=t.interleaved,n!==null){r=n;do i=r.lane,We.lanes|=i,al|=i,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function d0(n){var e=fn(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var s=t.dispatch,r=t.pending,i=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do i=n(i,a.action),a=a.next;while(a!==r);Dn(i,e.memoizedState)||(xs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,s]}function q_(){}function G_(n,e){var t=We,s=fn(),r=e(),i=!Dn(s.memoizedState,r);if(i&&(s.memoizedState=r,xs=!0),s=s.queue,Iv(Y_.bind(null,t,s,n),[n]),s.getSnapshot!==e||i||wt!==null&&wt.memoizedState.tag&1){if(t.flags|=2048,Od(9,K_.bind(null,t,s,r,e),void 0,null),bt===null)throw Error(z(349));il&30||X_(t,e,r)}return r}function X_(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function K_(n,e,t,s){e.value=t,e.getSnapshot=s,Q_(e)&&J_(n)}function Y_(n,e,t){return t(function(){Q_(e)&&J_(n)})}function Q_(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Dn(n,t)}catch{return!0}}function J_(n){var e=oi(n,1);e!==null&&Mn(e,n,1,-1)}function lb(n){var e=Hn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dd,lastRenderedState:n},e.queue=n,n=n.dispatch=UN.bind(null,We,n),[e.memoizedState,n]}function Od(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function Z_(){return fn().memoizedState}function Ep(n,e,t,s){var r=Hn();We.flags|=n,r.memoizedState=Od(1|e,t,void 0,s===void 0?null:s)}function yg(n,e,t,s){var r=fn();s=s===void 0?null:s;var i=void 0;if(ct!==null){var a=ct.memoizedState;if(i=a.destroy,s!==null&&Pv(s,a.deps)){r.memoizedState=Od(e,t,i,s);return}}We.flags|=n,r.memoizedState=Od(1|e,t,i,s)}function cb(n,e){return Ep(8390656,8,n,e)}function Iv(n,e){return yg(2048,8,n,e)}function eS(n,e){return yg(4,2,n,e)}function tS(n,e){return yg(4,4,n,e)}function sS(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function nS(n,e,t){return t=t!=null?t.concat([n]):null,yg(4,4,sS.bind(null,e,n),t)}function Mv(){}function rS(n,e){var t=fn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Pv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function iS(n,e){var t=fn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Pv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function aS(n,e,t){return il&21?(Dn(t,e)||(t=d_(),We.lanes|=t,al|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,xs=!0),n.memoizedState=t)}function $N(n,e){var t=Ee;Ee=t!==0&&4>t?t:4,n(!0);var s=c0.transition;c0.transition={};try{n(!1),e()}finally{Ee=t,c0.transition=s}}function oS(){return fn().memoizedState}function BN(n,e,t){var s=ma(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},lS(n))cS(e,t);else if(t=H_(n,e,t,s),t!==null){var r=rs();Mn(t,n,s,r),uS(t,e,s)}}function UN(n,e,t){var s=ma(n),r={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(lS(n))cS(e,r);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,t);if(r.hasEagerState=!0,r.eagerState=o,Dn(o,a)){var l=e.interleaved;l===null?(r.next=r,kv(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=H_(n,e,r,s),t!==null&&(r=rs(),Mn(t,n,s,r),uS(t,e,s))}}function lS(n){var e=n.alternate;return n===We||e!==null&&e===We}function cS(n,e){pd=Em=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function uS(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,hv(n,t)}}var km={readContext:hn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},zN={readContext:hn,useCallback:function(n,e){return Hn().memoizedState=[n,e===void 0?null:e],n},useContext:hn,useEffect:cb,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Ep(4194308,4,sS.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Ep(4194308,4,n,e)},useInsertionEffect:function(n,e){return Ep(4,2,n,e)},useMemo:function(n,e){var t=Hn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Hn();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=BN.bind(null,We,n),[s.memoizedState,n]},useRef:function(n){var e=Hn();return n={current:n},e.memoizedState=n},useState:lb,useDebugValue:Mv,useDeferredValue:function(n){return Hn().memoizedState=n},useTransition:function(){var n=lb(!1),e=n[0];return n=$N.bind(null,n[1]),Hn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=We,r=Hn();if(Be){if(t===void 0)throw Error(z(407));t=t()}else{if(t=e(),bt===null)throw Error(z(349));il&30||X_(s,e,t)}r.memoizedState=t;var i={value:t,getSnapshot:e};return r.queue=i,cb(Y_.bind(null,s,i,n),[n]),s.flags|=2048,Od(9,K_.bind(null,s,i,t,e),void 0,null),t},useId:function(){var n=Hn(),e=bt.identifierPrefix;if(Be){var t=ei,s=Zr;t=(s&~(1<<32-In(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Md++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=FN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},HN={readContext:hn,useCallback:rS,useContext:hn,useEffect:Iv,useImperativeHandle:nS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:iS,useReducer:u0,useRef:Z_,useState:function(){return u0(Dd)},useDebugValue:Mv,useDeferredValue:function(n){var e=fn();return aS(e,ct.memoizedState,n)},useTransition:function(){var n=u0(Dd)[0],e=fn().memoizedState;return[n,e]},useMutableSource:q_,useSyncExternalStore:G_,useId:oS,unstable_isNewReconciler:!1},WN={readContext:hn,useCallback:rS,useContext:hn,useEffect:Iv,useImperativeHandle:nS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:iS,useReducer:d0,useRef:Z_,useState:function(){return d0(Dd)},useDebugValue:Mv,useDeferredValue:function(n){var e=fn();return ct===null?e.memoizedState=n:aS(e,ct.memoizedState,n)},useTransition:function(){var n=d0(Dd)[0],e=fn().memoizedState;return[n,e]},useMutableSource:q_,useSyncExternalStore:G_,useId:oS,unstable_isNewReconciler:!1};function xn(n,e){if(n&&n.defaultProps){e=Ve({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function ox(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Ve({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var vg={isMounted:function(n){return(n=n._reactInternals)?hl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=rs(),r=ma(n),i=ti(s,r);i.payload=e,t!=null&&(i.callback=t),e=fa(n,i,r),e!==null&&(Mn(e,n,r,s),Sp(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=rs(),r=ma(n),i=ti(s,r);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=fa(n,i,r),e!==null&&(Mn(e,n,r,s),Sp(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=rs(),s=ma(n),r=ti(t,s);r.tag=2,e!=null&&(r.callback=e),e=fa(n,r,s),e!==null&&(Mn(e,n,s,t),Sp(e,n,s))}};function ub(n,e,t,s,r,i,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,i,a):e.prototype&&e.prototype.isPureReactComponent?!Cd(t,s)||!Cd(r,i):!0}function dS(n,e,t){var s=!1,r=va,i=e.contextType;return typeof i=="object"&&i!==null?i=hn(i):(r=vs(e)?nl:qt.current,s=e.contextTypes,i=(s=s!=null)?cu(n,r):va),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vg,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=i),e}function db(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&vg.enqueueReplaceState(e,e.state,null)}function lx(n,e,t,s){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},Nv(n);var i=e.contextType;typeof i=="object"&&i!==null?r.context=hn(i):(i=vs(e)?nl:qt.current,r.context=cu(n,i)),r.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ox(n,e,i,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&vg.enqueueReplaceState(r,r.state,null),Sm(n,t,r,s),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function fu(n,e){try{var t="",s=e;do t+=yk(s),s=s.return;while(s);var r=t}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:r,digest:null}}function h0(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function cx(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var VN=typeof WeakMap=="function"?WeakMap:Map;function hS(n,e,t){t=ti(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){jm||(jm=!0,vx=s),cx(n,e)},t}function fS(n,e,t){t=ti(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;t.payload=function(){return s(r)},t.callback=function(){cx(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){cx(n,e),typeof s!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function hb(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new VN;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(t)||(r.add(t),n=ij.bind(null,n,e,t),e.then(n,n))}function fb(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function pb(n,e,t,s,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ti(-1,1),e.tag=2,fa(t,e,1))),t.lanes|=1),n)}var qN=ui.ReactCurrentOwner,xs=!1;function ts(n,e,t,s){e.child=n===null?z_(e,null,t,s):du(e,n.child,t,s)}function mb(n,e,t,s,r){t=t.render;var i=e.ref;return Zl(e,r),s=Rv(n,e,t,s,i,r),t=Lv(),n!==null&&!xs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,li(n,e,r)):(Be&&t&&wv(e),e.flags|=1,ts(n,e,s,r),e.child)}function gb(n,e,t,s,r){if(n===null){var i=t.type;return typeof i=="function"&&!Hv(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,pS(n,e,i,s,r)):(n=Cp(t.type,null,s,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&r)){var a=i.memoizedProps;if(t=t.compare,t=t!==null?t:Cd,t(a,s)&&n.ref===e.ref)return li(n,e,r)}return e.flags|=1,n=ga(i,s),n.ref=e.ref,n.return=e,e.child=n}function pS(n,e,t,s,r){if(n!==null){var i=n.memoizedProps;if(Cd(i,s)&&n.ref===e.ref)if(xs=!1,e.pendingProps=s=i,(n.lanes&r)!==0)n.flags&131072&&(xs=!0);else return e.lanes=n.lanes,li(n,e,r)}return ux(n,e,t,s,r)}function mS(n,e,t){var s=e.pendingProps,r=s.children,i=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(Wl,Fs),Fs|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Re(Wl,Fs),Fs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:t,Re(Wl,Fs),Fs|=s}else i!==null?(s=i.baseLanes|t,e.memoizedState=null):s=t,Re(Wl,Fs),Fs|=s;return ts(n,e,r,t),e.child}function gS(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function ux(n,e,t,s,r){var i=vs(t)?nl:qt.current;return i=cu(e,i),Zl(e,r),t=Rv(n,e,t,s,i,r),s=Lv(),n!==null&&!xs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,li(n,e,r)):(Be&&s&&wv(e),e.flags|=1,ts(n,e,t,r),e.child)}function xb(n,e,t,s,r){if(vs(t)){var i=!0;ym(e)}else i=!1;if(Zl(e,r),e.stateNode===null)kp(n,e),dS(e,t,s),lx(e,t,s,r),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,d=t.contextType;typeof d=="object"&&d!==null?d=hn(d):(d=vs(t)?nl:qt.current,d=cu(e,d));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||l!==d)&&db(e,a,s,d),gi=!1;var p=e.memoizedState;a.state=p,Sm(e,s,a,r),l=e.memoizedState,o!==s||p!==l||ys.current||gi?(typeof h=="function"&&(ox(e,t,h,s),l=e.memoizedState),(o=gi||ub(e,t,o,s,p,l,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),a.props=s,a.state=l,a.context=d,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,W_(n,e),o=e.memoizedProps,d=e.type===e.elementType?o:xn(e.type,o),a.props=d,f=e.pendingProps,p=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=hn(l):(l=vs(t)?nl:qt.current,l=cu(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==l)&&db(e,a,s,l),gi=!1,p=e.memoizedState,a.state=p,Sm(e,s,a,r);var y=e.memoizedState;o!==f||p!==y||ys.current||gi?(typeof m=="function"&&(ox(e,t,m,s),y=e.memoizedState),(d=gi||ub(e,t,d,s,p,y,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),a.props=s,a.state=y,a.context=l,s=d):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return dx(n,e,t,s,i,r)}function dx(n,e,t,s,r,i){gS(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return r&&sb(e,t,!1),li(n,e,i);s=e.stateNode,qN.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=du(e,n.child,null,i),e.child=du(e,null,o,i)):ts(n,e,o,i),e.memoizedState=s.state,r&&sb(e,t,!0),e.child}function xS(n){var e=n.stateNode;e.pendingContext?tb(n,e.pendingContext,e.pendingContext!==e.context):e.context&&tb(n,e.context,!1),jv(n,e.containerInfo)}function yb(n,e,t,s,r){return uu(),_v(r),e.flags|=256,ts(n,e,t,s),e.child}var hx={dehydrated:null,treeContext:null,retryLane:0};function fx(n){return{baseLanes:n,cachePool:null,transitions:null}}function yS(n,e,t){var s=e.pendingProps,r=He.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(r&2)!==0),o?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Re(He,r&1),n===null)return ix(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,i?(s=e.mode,i=e.child,a={mode:"hidden",children:a},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=_g(a,s,0,null),n=tl(n,s,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=fx(t),e.memoizedState=hx,n):Dv(e,a));if(r=n.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return GN(n,e,a,s,o,r,t);if(i){i=s.fallback,a=e.mode,r=n.child,o=r.sibling;var l={mode:"hidden",children:s.children};return!(a&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=ga(r,l),s.subtreeFlags=r.subtreeFlags&14680064),o!==null?i=ga(o,i):(i=tl(i,a,t,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,a=n.child.memoizedState,a=a===null?fx(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=n.childLanes&~t,e.memoizedState=hx,s}return i=n.child,n=i.sibling,s=ga(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Dv(n,e){return e=_g({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function sp(n,e,t,s){return s!==null&&_v(s),du(e,n.child,null,t),n=Dv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function GN(n,e,t,s,r,i,a){if(t)return e.flags&256?(e.flags&=-257,s=h0(Error(z(422))),sp(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=_g({mode:"visible",children:s.children},r,0,null),i=tl(i,r,a,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&du(e,n.child,null,a),e.child.memoizedState=fx(a),e.memoizedState=hx,i);if(!(e.mode&1))return sp(n,e,a,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var o=s.dgst;return s=o,i=Error(z(419)),s=h0(i,s,void 0),sp(n,e,a,s)}if(o=(a&n.childLanes)!==0,xs||o){if(s=bt,s!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|a)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,oi(n,r),Mn(s,n,r,-1))}return zv(),s=h0(Error(z(421))),sp(n,e,a,s)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=aj.bind(null,n),r._reactRetry=e,null):(n=i.treeContext,Us=ha(r.nextSibling),Hs=e,Be=!0,Rn=null,n!==null&&(nn[rn++]=Zr,nn[rn++]=ei,nn[rn++]=rl,Zr=n.id,ei=n.overflow,rl=e),e=Dv(e,s.children),e.flags|=4096,e)}function vb(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),ax(n.return,e,t)}function f0(n,e,t,s,r){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=t,i.tailMode=r)}function vS(n,e,t){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(ts(n,e,s.children,t),s=He.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&vb(n,t,e);else if(n.tag===19)vb(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Re(He,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Am(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),f0(e,!1,r,t,i);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Am(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}f0(e,!0,t,null,i);break;case"together":f0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function kp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function li(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),al|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(z(153));if(e.child!==null){for(n=e.child,t=ga(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ga(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function XN(n,e,t){switch(e.tag){case 3:xS(e),uu();break;case 5:V_(e);break;case 1:vs(e.type)&&ym(e);break;case 4:jv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Re(bm,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Re(He,He.current&1),e.flags|=128,null):t&e.child.childLanes?yS(n,e,t):(Re(He,He.current&1),n=li(n,e,t),n!==null?n.sibling:null);Re(He,He.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return vS(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Re(He,He.current),s)break;return null;case 22:case 23:return e.lanes=0,mS(n,e,t)}return li(n,e,t)}var wS,px,bS,_S;wS=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};px=function(){};bS=function(n,e,t,s){var r=n.memoizedProps;if(r!==s){n=e.stateNode,Wa(ur.current);var i=null;switch(t){case"input":r=D0(n,r),s=D0(n,s),i=[];break;case"select":r=Ve({},r,{value:void 0}),s=Ve({},s,{value:void 0}),i=[];break;case"textarea":r=$0(n,r),s=$0(n,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=gm)}U0(t,s);var a;t=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var o=r[d];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(_d.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var l=s[d];if(o=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&l!==o&&(l!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(i||(i=[]),i.push(d,t)),t=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(_d.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Ie("scroll",n),i||o===l||(i=[])):(i=i||[]).push(d,l))}t&&(i=i||[]).push("style",t);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};_S=function(n,e,t,s){t!==s&&(e.flags|=4)};function Tu(n,e){if(!Be)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Mt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function KN(n,e,t){var s=e.pendingProps;switch(bv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(e),null;case 1:return vs(e.type)&&xm(),Mt(e),null;case 3:return s=e.stateNode,hu(),Me(ys),Me(qt),Tv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(ep(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rn!==null&&(_x(Rn),Rn=null))),px(n,e),Mt(e),null;case 5:Cv(e);var r=Wa(Id.current);if(t=e.type,n!==null&&e.stateNode!=null)bS(n,e,t,s,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(z(166));return Mt(e),null}if(n=Wa(ur.current),ep(e)){s=e.stateNode,t=e.type;var i=e.memoizedProps;switch(s[or]=e,s[Rd]=i,n=(e.mode&1)!==0,t){case"dialog":Ie("cancel",s),Ie("close",s);break;case"iframe":case"object":case"embed":Ie("load",s);break;case"video":case"audio":for(r=0;r<zu.length;r++)Ie(zu[r],s);break;case"source":Ie("error",s);break;case"img":case"image":case"link":Ie("error",s),Ie("load",s);break;case"details":Ie("toggle",s);break;case"input":jw(s,i),Ie("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",s);break;case"textarea":Tw(s,i),Ie("invalid",s)}U0(t,i),r=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?s.textContent!==o&&(i.suppressHydrationWarning!==!0&&Zf(s.textContent,o,n),r=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Zf(s.textContent,o,n),r=["children",""+o]):_d.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ie("scroll",s)}switch(t){case"input":Vf(s),Cw(s,i,!0);break;case"textarea":Vf(s),Pw(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=gm)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Y1(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[or]=e,n[Rd]=s,wS(n,e,!1,!1),e.stateNode=n;e:{switch(a=z0(t,s),t){case"dialog":Ie("cancel",n),Ie("close",n),r=s;break;case"iframe":case"object":case"embed":Ie("load",n),r=s;break;case"video":case"audio":for(r=0;r<zu.length;r++)Ie(zu[r],n);r=s;break;case"source":Ie("error",n),r=s;break;case"img":case"image":case"link":Ie("error",n),Ie("load",n),r=s;break;case"details":Ie("toggle",n),r=s;break;case"input":jw(n,s),r=D0(n,s),Ie("invalid",n);break;case"option":r=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},r=Ve({},s,{value:void 0}),Ie("invalid",n);break;case"textarea":Tw(n,s),r=$0(n,s),Ie("invalid",n);break;default:r=s}U0(t,r),o=r;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?Z1(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Q1(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Sd(n,l):typeof l=="number"&&Sd(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_d.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ie("scroll",n):l!=null&&av(n,i,l,a))}switch(t){case"input":Vf(n),Cw(n,s,!1);break;case"textarea":Vf(n),Pw(n);break;case"option":s.value!=null&&n.setAttribute("value",""+ya(s.value));break;case"select":n.multiple=!!s.multiple,i=s.value,i!=null?Kl(n,!!s.multiple,i,!1):s.defaultValue!=null&&Kl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=gm)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mt(e),null;case 6:if(n&&e.stateNode!=null)_S(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(z(166));if(t=Wa(Id.current),Wa(ur.current),ep(e)){if(s=e.stateNode,t=e.memoizedProps,s[or]=e,(i=s.nodeValue!==t)&&(n=Hs,n!==null))switch(n.tag){case 3:Zf(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zf(s.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[or]=e,e.stateNode=s}return Mt(e),null;case 13:if(Me(He),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Be&&Us!==null&&e.mode&1&&!(e.flags&128))B_(),uu(),e.flags|=98560,i=!1;else if(i=ep(e),s!==null&&s.dehydrated!==null){if(n===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[or]=e}else uu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mt(e),i=!1}else Rn!==null&&(_x(Rn),Rn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||He.current&1?ut===0&&(ut=3):zv())),e.updateQueue!==null&&(e.flags|=4),Mt(e),null);case 4:return hu(),px(n,e),n===null&&Td(e.stateNode.containerInfo),Mt(e),null;case 10:return Ev(e.type._context),Mt(e),null;case 17:return vs(e.type)&&xm(),Mt(e),null;case 19:if(Me(He),i=e.memoizedState,i===null)return Mt(e),null;if(s=(e.flags&128)!==0,a=i.rendering,a===null)if(s)Tu(i,!1);else{if(ut!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Am(n),a!==null){for(e.flags|=128,Tu(i,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)i=t,n=s,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,n=a.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Re(He,He.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ye()>pu&&(e.flags|=128,s=!0,Tu(i,!1),e.lanes=4194304)}else{if(!s)if(n=Am(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Tu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Be)return Mt(e),null}else 2*Ye()-i.renderingStartTime>pu&&t!==1073741824&&(e.flags|=128,s=!0,Tu(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(t=i.last,t!==null?t.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ye(),e.sibling=null,t=He.current,Re(He,s?t&1|2:t&1),e):(Mt(e),null);case 22:case 23:return Uv(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Fs&1073741824&&(Mt(e),e.subtreeFlags&6&&(e.flags|=8192)):Mt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function YN(n,e){switch(bv(e),e.tag){case 1:return vs(e.type)&&xm(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return hu(),Me(ys),Me(qt),Tv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Cv(e),null;case 13:if(Me(He),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(z(340));uu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Me(He),null;case 4:return hu(),null;case 10:return Ev(e.type._context),null;case 22:case 23:return Uv(),null;case 24:return null;default:return null}}var np=!1,zt=!1,QN=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Hl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){Ge(n,e,s)}else t.current=null}function mx(n,e,t){try{t()}catch(s){Ge(n,e,s)}}var wb=!1;function JN(n,e){if(J0=fm,n=N_(),vv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,d=0,h=0,f=n,p=null;t:for(;;){for(var m;f!==t||r!==0&&f.nodeType!==3||(o=a+r),f!==i||s!==0&&f.nodeType!==3||(l=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++d===r&&(o=a),p===i&&++h===s&&(l=a),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Z0={focusedElem:n,selectionRange:t},fm=!1,Q=e;Q!==null;)if(e=Q,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Q=n;else for(;Q!==null;){e=Q;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,_=y.memoizedState,g=e.stateNode,w=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:xn(e.type,x),_);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(k){Ge(e,e.return,k)}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}return y=wb,wb=!1,y}function md(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&n)===n){var i=r.destroy;r.destroy=void 0,i!==void 0&&mx(e,t,i)}r=r.next}while(r!==s)}}function wg(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function gx(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function SS(n){var e=n.alternate;e!==null&&(n.alternate=null,SS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[or],delete e[Rd],delete e[sx],delete e[IN],delete e[MN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function AS(n){return n.tag===5||n.tag===3||n.tag===4}function bb(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||AS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function xx(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=gm));else if(s!==4&&(n=n.child,n!==null))for(xx(n,e,t),n=n.sibling;n!==null;)xx(n,e,t),n=n.sibling}function yx(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(yx(n,e,t),n=n.sibling;n!==null;)yx(n,e,t),n=n.sibling}var Nt=null,Tn=!1;function hi(n,e,t){for(t=t.child;t!==null;)ES(n,e,t),t=t.sibling}function ES(n,e,t){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount(hg,t)}catch{}switch(t.tag){case 5:zt||Hl(t,e);case 6:var s=Nt,r=Tn;Nt=null,hi(n,e,t),Nt=s,Tn=r,Nt!==null&&(Tn?(n=Nt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Nt.removeChild(t.stateNode));break;case 18:Nt!==null&&(Tn?(n=Nt,t=t.stateNode,n.nodeType===8?a0(n.parentNode,t):n.nodeType===1&&a0(n,t),Nd(n)):a0(Nt,t.stateNode));break;case 4:s=Nt,r=Tn,Nt=t.stateNode.containerInfo,Tn=!0,hi(n,e,t),Nt=s,Tn=r;break;case 0:case 11:case 14:case 15:if(!zt&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&mx(t,e,a),r=r.next}while(r!==s)}hi(n,e,t);break;case 1:if(!zt&&(Hl(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){Ge(t,e,o)}hi(n,e,t);break;case 21:hi(n,e,t);break;case 22:t.mode&1?(zt=(s=zt)||t.memoizedState!==null,hi(n,e,t),zt=s):hi(n,e,t);break;default:hi(n,e,t)}}function _b(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new QN),e.forEach(function(s){var r=oj.bind(null,n,s);t.has(s)||(t.add(s),s.then(r,r))})}}function pn(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];try{var i=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Nt=o.stateNode,Tn=!1;break e;case 3:Nt=o.stateNode.containerInfo,Tn=!0;break e;case 4:Nt=o.stateNode.containerInfo,Tn=!0;break e}o=o.return}if(Nt===null)throw Error(z(160));ES(i,a,r),Nt=null,Tn=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(d){Ge(r,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)kS(e,n),e=e.sibling}function kS(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(pn(e,n),$n(n),s&4){try{md(3,n,n.return),wg(3,n)}catch(x){Ge(n,n.return,x)}try{md(5,n,n.return)}catch(x){Ge(n,n.return,x)}}break;case 1:pn(e,n),$n(n),s&512&&t!==null&&Hl(t,t.return);break;case 5:if(pn(e,n),$n(n),s&512&&t!==null&&Hl(t,t.return),n.flags&32){var r=n.stateNode;try{Sd(r,"")}catch(x){Ge(n,n.return,x)}}if(s&4&&(r=n.stateNode,r!=null)){var i=n.memoizedProps,a=t!==null?t.memoizedProps:i,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&X1(r,i),z0(o,a);var d=z0(o,i);for(a=0;a<l.length;a+=2){var h=l[a],f=l[a+1];h==="style"?Z1(r,f):h==="dangerouslySetInnerHTML"?Q1(r,f):h==="children"?Sd(r,f):av(r,h,f,d)}switch(o){case"input":O0(r,i);break;case"textarea":K1(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Kl(r,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Kl(r,!!i.multiple,i.defaultValue,!0):Kl(r,!!i.multiple,i.multiple?[]:"",!1))}r[Rd]=i}catch(x){Ge(n,n.return,x)}}break;case 6:if(pn(e,n),$n(n),s&4){if(n.stateNode===null)throw Error(z(162));r=n.stateNode,i=n.memoizedProps;try{r.nodeValue=i}catch(x){Ge(n,n.return,x)}}break;case 3:if(pn(e,n),$n(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Nd(e.containerInfo)}catch(x){Ge(n,n.return,x)}break;case 4:pn(e,n),$n(n);break;case 13:pn(e,n),$n(n),r=n.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||($v=Ye())),s&4&&_b(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(zt=(d=zt)||h,pn(e,n),zt=d):pn(e,n),$n(n),s&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!h&&n.mode&1)for(Q=n,h=n.child;h!==null;){for(f=Q=h;Q!==null;){switch(p=Q,m=p.child,p.tag){case 0:case 11:case 14:case 15:md(4,p,p.return);break;case 1:Hl(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Ge(s,t,x)}}break;case 5:Hl(p,p.return);break;case 22:if(p.memoizedState!==null){Ab(f);continue}}m!==null?(m.return=p,Q=m):Ab(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{r=f.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=J1("display",a))}catch(x){Ge(n,n.return,x)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){Ge(n,n.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:pn(e,n),$n(n),s&4&&_b(n);break;case 21:break;default:pn(e,n),$n(n)}}function $n(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(AS(t)){var s=t;break e}t=t.return}throw Error(z(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Sd(r,""),s.flags&=-33);var i=bb(n);yx(n,i,r);break;case 3:case 4:var a=s.stateNode.containerInfo,o=bb(n);xx(n,o,a);break;default:throw Error(z(161))}}catch(l){Ge(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function ZN(n,e,t){Q=n,NS(n)}function NS(n,e,t){for(var s=(n.mode&1)!==0;Q!==null;){var r=Q,i=r.child;if(r.tag===22&&s){var a=r.memoizedState!==null||np;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||zt;o=np;var d=zt;if(np=a,(zt=l)&&!d)for(Q=r;Q!==null;)a=Q,l=a.child,a.tag===22&&a.memoizedState!==null?Eb(r):l!==null?(l.return=a,Q=l):Eb(r);for(;i!==null;)Q=i,NS(i),i=i.sibling;Q=r,np=o,zt=d}Sb(n)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Q=i):Sb(n)}}function Sb(n){for(;Q!==null;){var e=Q;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:zt||wg(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!zt)if(t===null)s.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:xn(e.type,t.memoizedProps);s.componentDidUpdate(r,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ob(e,i,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}ob(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Nd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}zt||e.flags&512&&gx(e)}catch(p){Ge(e,e.return,p)}}if(e===n){Q=null;break}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Ab(n){for(;Q!==null;){var e=Q;if(e===n){Q=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Eb(n){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{wg(4,e)}catch(l){Ge(e,t,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Ge(e,r,l)}}var i=e.return;try{gx(e)}catch(l){Ge(e,i,l)}break;case 5:var a=e.return;try{gx(e)}catch(l){Ge(e,a,l)}}}catch(l){Ge(e,e.return,l)}if(e===n){Q=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Q=o;break}Q=e.return}}var ej=Math.ceil,Nm=ui.ReactCurrentDispatcher,Ov=ui.ReactCurrentOwner,ln=ui.ReactCurrentBatchConfig,ye=0,bt=null,tt=null,Tt=0,Fs=0,Wl=ka(0),ut=0,Fd=null,al=0,bg=0,Fv=0,gd=null,ms=null,$v=0,pu=1/0,xr=null,jm=!1,vx=null,pa=null,rp=!1,oa=null,Cm=0,xd=0,wx=null,Np=-1,jp=0;function rs(){return ye&6?Ye():Np!==-1?Np:Np=Ye()}function ma(n){return n.mode&1?ye&2&&Tt!==0?Tt&-Tt:ON.transition!==null?(jp===0&&(jp=d_()),jp):(n=Ee,n!==0||(n=window.event,n=n===void 0?16:y_(n.type)),n):1}function Mn(n,e,t,s){if(50<xd)throw xd=0,wx=null,Error(z(185));Nf(n,t,s),(!(ye&2)||n!==bt)&&(n===bt&&(!(ye&2)&&(bg|=t),ut===4&&vi(n,Tt)),ws(n,s),t===1&&ye===0&&!(e.mode&1)&&(pu=Ye()+500,xg&&Na()))}function ws(n,e){var t=n.callbackNode;Ok(n,e);var s=hm(n,n===bt?Tt:0);if(s===0)t!==null&&Iw(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Iw(t),e===1)n.tag===0?DN(kb.bind(null,n)):O_(kb.bind(null,n)),RN(function(){!(ye&6)&&Na()}),t=null;else{switch(h_(s)){case 1:t=dv;break;case 4:t=c_;break;case 16:t=dm;break;case 536870912:t=u_;break;default:t=dm}t=MS(t,jS.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function jS(n,e){if(Np=-1,jp=0,ye&6)throw Error(z(327));var t=n.callbackNode;if(ec()&&n.callbackNode!==t)return null;var s=hm(n,n===bt?Tt:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Tm(n,s);else{e=s;var r=ye;ye|=2;var i=TS();(bt!==n||Tt!==e)&&(xr=null,pu=Ye()+500,el(n,e));do try{nj();break}catch(o){CS(n,o)}while(!0);Av(),Nm.current=i,ye=r,tt!==null?e=0:(bt=null,Tt=0,e=ut)}if(e!==0){if(e===2&&(r=G0(n),r!==0&&(s=r,e=bx(n,r))),e===1)throw t=Fd,el(n,0),vi(n,s),ws(n,Ye()),t;if(e===6)vi(n,s);else{if(r=n.current.alternate,!(s&30)&&!tj(r)&&(e=Tm(n,s),e===2&&(i=G0(n),i!==0&&(s=i,e=bx(n,i))),e===1))throw t=Fd,el(n,0),vi(n,s),ws(n,Ye()),t;switch(n.finishedWork=r,n.finishedLanes=s,e){case 0:case 1:throw Error(z(345));case 2:Ia(n,ms,xr);break;case 3:if(vi(n,s),(s&130023424)===s&&(e=$v+500-Ye(),10<e)){if(hm(n,0)!==0)break;if(r=n.suspendedLanes,(r&s)!==s){rs(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=tx(Ia.bind(null,n,ms,xr),e);break}Ia(n,ms,xr);break;case 4:if(vi(n,s),(s&4194240)===s)break;for(e=n.eventTimes,r=-1;0<s;){var a=31-In(s);i=1<<a,a=e[a],a>r&&(r=a),s&=~i}if(s=r,s=Ye()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*ej(s/1960))-s,10<s){n.timeoutHandle=tx(Ia.bind(null,n,ms,xr),s);break}Ia(n,ms,xr);break;case 5:Ia(n,ms,xr);break;default:throw Error(z(329))}}}return ws(n,Ye()),n.callbackNode===t?jS.bind(null,n):null}function bx(n,e){var t=gd;return n.current.memoizedState.isDehydrated&&(el(n,e).flags|=256),n=Tm(n,e),n!==2&&(e=ms,ms=t,e!==null&&_x(e)),n}function _x(n){ms===null?ms=n:ms.push.apply(ms,n)}function tj(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var r=t[s],i=r.getSnapshot;r=r.value;try{if(!Dn(i(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vi(n,e){for(e&=~Fv,e&=~bg,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-In(e),s=1<<t;n[t]=-1,e&=~s}}function kb(n){if(ye&6)throw Error(z(327));ec();var e=hm(n,0);if(!(e&1))return ws(n,Ye()),null;var t=Tm(n,e);if(n.tag!==0&&t===2){var s=G0(n);s!==0&&(e=s,t=bx(n,s))}if(t===1)throw t=Fd,el(n,0),vi(n,e),ws(n,Ye()),t;if(t===6)throw Error(z(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ia(n,ms,xr),ws(n,Ye()),null}function Bv(n,e){var t=ye;ye|=1;try{return n(e)}finally{ye=t,ye===0&&(pu=Ye()+500,xg&&Na())}}function ol(n){oa!==null&&oa.tag===0&&!(ye&6)&&ec();var e=ye;ye|=1;var t=ln.transition,s=Ee;try{if(ln.transition=null,Ee=1,n)return n()}finally{Ee=s,ln.transition=t,ye=e,!(ye&6)&&Na()}}function Uv(){Fs=Wl.current,Me(Wl)}function el(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,PN(t)),tt!==null)for(t=tt.return;t!==null;){var s=t;switch(bv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&xm();break;case 3:hu(),Me(ys),Me(qt),Tv();break;case 5:Cv(s);break;case 4:hu();break;case 13:Me(He);break;case 19:Me(He);break;case 10:Ev(s.type._context);break;case 22:case 23:Uv()}t=t.return}if(bt=n,tt=n=ga(n.current,null),Tt=Fs=e,ut=0,Fd=null,Fv=bg=al=0,ms=gd=null,Ha!==null){for(e=0;e<Ha.length;e++)if(t=Ha[e],s=t.interleaved,s!==null){t.interleaved=null;var r=s.next,i=t.pending;if(i!==null){var a=i.next;i.next=r,s.next=a}t.pending=s}Ha=null}return n}function CS(n,e){do{var t=tt;try{if(Av(),Ap.current=km,Em){for(var s=We.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Em=!1}if(il=0,wt=ct=We=null,pd=!1,Md=0,Ov.current=null,t===null||t.return===null){ut=1,Fd=e,tt=null;break}e:{var i=n,a=t.return,o=t,l=e;if(e=Tt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=o,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=fb(a);if(m!==null){m.flags&=-257,pb(m,a,o,i,e),m.mode&1&&hb(i,d,e),e=m,l=d;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){hb(i,d,e),zv();break e}l=Error(z(426))}}else if(Be&&o.mode&1){var _=fb(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),pb(_,a,o,i,e),_v(fu(l,o));break e}}i=l=fu(l,o),ut!==4&&(ut=2),gd===null?gd=[i]:gd.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=hS(i,l,e);ab(i,g);break e;case 1:o=l;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(pa===null||!pa.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=fS(i,o,e);ab(i,k);break e}}i=i.return}while(i!==null)}RS(t)}catch(E){e=E,tt===t&&t!==null&&(tt=t=t.return);continue}break}while(!0)}function TS(){var n=Nm.current;return Nm.current=km,n===null?km:n}function zv(){(ut===0||ut===3||ut===2)&&(ut=4),bt===null||!(al&268435455)&&!(bg&268435455)||vi(bt,Tt)}function Tm(n,e){var t=ye;ye|=2;var s=TS();(bt!==n||Tt!==e)&&(xr=null,el(n,e));do try{sj();break}catch(r){CS(n,r)}while(!0);if(Av(),ye=t,Nm.current=s,tt!==null)throw Error(z(261));return bt=null,Tt=0,ut}function sj(){for(;tt!==null;)PS(tt)}function nj(){for(;tt!==null&&!jk();)PS(tt)}function PS(n){var e=IS(n.alternate,n,Fs);n.memoizedProps=n.pendingProps,e===null?RS(n):tt=e,Ov.current=null}function RS(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=YN(t,e),t!==null){t.flags&=32767,tt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ut=6,tt=null;return}}else if(t=KN(t,e,Fs),t!==null){tt=t;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=n}while(e!==null);ut===0&&(ut=5)}function Ia(n,e,t){var s=Ee,r=ln.transition;try{ln.transition=null,Ee=1,rj(n,e,t,s)}finally{ln.transition=r,Ee=s}return null}function rj(n,e,t,s){do ec();while(oa!==null);if(ye&6)throw Error(z(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(z(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(Fk(n,i),n===bt&&(tt=bt=null,Tt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||rp||(rp=!0,MS(dm,function(){return ec(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=ln.transition,ln.transition=null;var a=Ee;Ee=1;var o=ye;ye|=4,Ov.current=null,JN(n,t),kS(t,n),AN(Z0),fm=!!J0,Z0=J0=null,n.current=t,ZN(t),Ck(),ye=o,Ee=a,ln.transition=i}else n.current=t;if(rp&&(rp=!1,oa=n,Cm=r),i=n.pendingLanes,i===0&&(pa=null),Rk(t.stateNode),ws(n,Ye()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],s(r.value,{componentStack:r.stack,digest:r.digest});if(jm)throw jm=!1,n=vx,vx=null,n;return Cm&1&&n.tag!==0&&ec(),i=n.pendingLanes,i&1?n===wx?xd++:(xd=0,wx=n):xd=0,Na(),null}function ec(){if(oa!==null){var n=h_(Cm),e=ln.transition,t=Ee;try{if(ln.transition=null,Ee=16>n?16:n,oa===null)var s=!1;else{if(n=oa,oa=null,Cm=0,ye&6)throw Error(z(331));var r=ye;for(ye|=4,Q=n.current;Q!==null;){var i=Q,a=i.child;if(Q.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var d=o[l];for(Q=d;Q!==null;){var h=Q;switch(h.tag){case 0:case 11:case 15:md(8,h,i)}var f=h.child;if(f!==null)f.return=h,Q=f;else for(;Q!==null;){h=Q;var p=h.sibling,m=h.return;if(SS(h),h===d){Q=null;break}if(p!==null){p.return=m,Q=p;break}Q=m}}}var y=i.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}Q=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Q=a;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:md(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Q=g;break e}Q=i.return}}var w=n.current;for(Q=w;Q!==null;){a=Q;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Q=b;else e:for(a=w;Q!==null;){if(o=Q,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wg(9,o)}}catch(E){Ge(o,o.return,E)}if(o===a){Q=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Q=k;break e}Q=o.return}}if(ye=r,Na(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot(hg,n)}catch{}s=!0}return s}finally{Ee=t,ln.transition=e}}return!1}function Nb(n,e,t){e=fu(t,e),e=hS(n,e,1),n=fa(n,e,1),e=rs(),n!==null&&(Nf(n,1,e),ws(n,e))}function Ge(n,e,t){if(n.tag===3)Nb(n,n,t);else for(;e!==null;){if(e.tag===3){Nb(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(pa===null||!pa.has(s))){n=fu(t,n),n=fS(e,n,1),e=fa(e,n,1),n=rs(),e!==null&&(Nf(e,1,n),ws(e,n));break}}e=e.return}}function ij(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=rs(),n.pingedLanes|=n.suspendedLanes&t,bt===n&&(Tt&t)===t&&(ut===4||ut===3&&(Tt&130023424)===Tt&&500>Ye()-$v?el(n,0):Fv|=t),ws(n,e)}function LS(n,e){e===0&&(n.mode&1?(e=Xf,Xf<<=1,!(Xf&130023424)&&(Xf=4194304)):e=1);var t=rs();n=oi(n,e),n!==null&&(Nf(n,e,t),ws(n,t))}function aj(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),LS(n,t)}function oj(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(z(314))}s!==null&&s.delete(e),LS(n,t)}var IS;IS=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ys.current)xs=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return xs=!1,XN(n,e,t);xs=!!(n.flags&131072)}else xs=!1,Be&&e.flags&1048576&&F_(e,wm,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;kp(n,e),n=e.pendingProps;var r=cu(e,qt.current);Zl(e,t),r=Rv(null,e,s,n,r,t);var i=Lv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vs(s)?(i=!0,ym(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Nv(e),r.updater=vg,e.stateNode=r,r._reactInternals=e,lx(e,s,n,t),e=dx(null,e,s,!0,i,t)):(e.tag=0,Be&&i&&wv(e),ts(null,e,r,t),e=e.child),e;case 16:s=e.elementType;e:{switch(kp(n,e),n=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=cj(s),n=xn(s,n),r){case 0:e=ux(null,e,s,n,t);break e;case 1:e=xb(null,e,s,n,t);break e;case 11:e=mb(null,e,s,n,t);break e;case 14:e=gb(null,e,s,xn(s.type,n),t);break e}throw Error(z(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:xn(s,r),ux(n,e,s,r,t);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:xn(s,r),xb(n,e,s,r,t);case 3:e:{if(xS(e),n===null)throw Error(z(387));s=e.pendingProps,i=e.memoizedState,r=i.element,W_(n,e),Sm(e,s,null,t);var a=e.memoizedState;if(s=a.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=fu(Error(z(423)),e),e=yb(n,e,s,t,r);break e}else if(s!==r){r=fu(Error(z(424)),e),e=yb(n,e,s,t,r);break e}else for(Us=ha(e.stateNode.containerInfo.firstChild),Hs=e,Be=!0,Rn=null,t=z_(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(uu(),s===r){e=li(n,e,t);break e}ts(n,e,s,t)}e=e.child}return e;case 5:return V_(e),n===null&&ix(e),s=e.type,r=e.pendingProps,i=n!==null?n.memoizedProps:null,a=r.children,ex(s,r)?a=null:i!==null&&ex(s,i)&&(e.flags|=32),gS(n,e),ts(n,e,a,t),e.child;case 6:return n===null&&ix(e),null;case 13:return yS(n,e,t);case 4:return jv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=du(e,null,s,t):ts(n,e,s,t),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:xn(s,r),mb(n,e,s,r,t);case 7:return ts(n,e,e.pendingProps,t),e.child;case 8:return ts(n,e,e.pendingProps.children,t),e.child;case 12:return ts(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,a=r.value,Re(bm,s._currentValue),s._currentValue=a,i!==null)if(Dn(i.value,a)){if(i.children===r.children&&!ys.current){e=li(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=ti(-1,t&-t),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),ax(i.return,t,e),o.lanes|=t;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(z(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),ax(a,t,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}ts(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Zl(e,t),r=hn(r),s=s(r),e.flags|=1,ts(n,e,s,t),e.child;case 14:return s=e.type,r=xn(s,e.pendingProps),r=xn(s.type,r),gb(n,e,s,r,t);case 15:return pS(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:xn(s,r),kp(n,e),e.tag=1,vs(s)?(n=!0,ym(e)):n=!1,Zl(e,t),dS(e,s,r),lx(e,s,r,t),dx(null,e,s,!0,n,t);case 19:return vS(n,e,t);case 22:return mS(n,e,t)}throw Error(z(156,e.tag))};function MS(n,e){return l_(n,e)}function lj(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(n,e,t,s){return new lj(n,e,t,s)}function Hv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function cj(n){if(typeof n=="function")return Hv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===lv)return 11;if(n===cv)return 14}return 2}function ga(n,e){var t=n.alternate;return t===null?(t=on(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Cp(n,e,t,s,r,i){var a=2;if(s=n,typeof n=="function")Hv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Il:return tl(t.children,r,i,e);case ov:a=8,r|=8;break;case R0:return n=on(12,t,e,r|2),n.elementType=R0,n.lanes=i,n;case L0:return n=on(13,t,e,r),n.elementType=L0,n.lanes=i,n;case I0:return n=on(19,t,e,r),n.elementType=I0,n.lanes=i,n;case V1:return _g(t,r,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case H1:a=10;break e;case W1:a=9;break e;case lv:a=11;break e;case cv:a=14;break e;case mi:a=16,s=null;break e}throw Error(z(130,n==null?n:typeof n,""))}return e=on(a,t,e,r),e.elementType=n,e.type=s,e.lanes=i,e}function tl(n,e,t,s){return n=on(7,n,s,e),n.lanes=t,n}function _g(n,e,t,s){return n=on(22,n,s,e),n.elementType=V1,n.lanes=t,n.stateNode={isHidden:!1},n}function p0(n,e,t){return n=on(6,n,null,e),n.lanes=t,n}function m0(n,e,t){return e=on(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function uj(n,e,t,s,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kg(0),this.expirationTimes=Kg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kg(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Wv(n,e,t,s,r,i,a,o,l){return n=new uj(n,e,t,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=on(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nv(i),n}function dj(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function DS(n){if(!n)return va;n=n._reactInternals;e:{if(hl(n)!==n||n.tag!==1)throw Error(z(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(n.tag===1){var t=n.type;if(vs(t))return D_(n,t,e)}return e}function OS(n,e,t,s,r,i,a,o,l){return n=Wv(t,s,!0,n,r,i,a,o,l),n.context=DS(null),t=n.current,s=rs(),r=ma(t),i=ti(s,r),i.callback=e??null,fa(t,i,r),n.current.lanes=r,Nf(n,r,s),ws(n,s),n}function Sg(n,e,t,s){var r=e.current,i=rs(),a=ma(r);return t=DS(t),e.context===null?e.context=t:e.pendingContext=t,e=ti(i,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=fa(r,e,a),n!==null&&(Mn(n,r,a,i),Sp(n,r,a)),a}function Pm(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function jb(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Vv(n,e){jb(n,e),(n=n.alternate)&&jb(n,e)}function hj(){return null}var FS=typeof reportError=="function"?reportError:function(n){console.error(n)};function qv(n){this._internalRoot=n}Ag.prototype.render=qv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(z(409));Sg(n,e,null,null)};Ag.prototype.unmount=qv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ol(function(){Sg(null,n,null,null)}),e[ai]=null}};function Ag(n){this._internalRoot=n}Ag.prototype.unstable_scheduleHydration=function(n){if(n){var e=m_();n={blockedOn:null,target:n,priority:e};for(var t=0;t<yi.length&&e!==0&&e<yi[t].priority;t++);yi.splice(t,0,n),t===0&&x_(n)}};function Gv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Eg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Cb(){}function fj(n,e,t,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var d=Pm(a);i.call(d)}}var a=OS(e,s,n,0,null,!1,!1,"",Cb);return n._reactRootContainer=a,n[ai]=a.current,Td(n.nodeType===8?n.parentNode:n),ol(),a}for(;r=n.lastChild;)n.removeChild(r);if(typeof s=="function"){var o=s;s=function(){var d=Pm(l);o.call(d)}}var l=Wv(n,0,!1,null,null,!1,!1,"",Cb);return n._reactRootContainer=l,n[ai]=l.current,Td(n.nodeType===8?n.parentNode:n),ol(function(){Sg(e,l,t,s)}),l}function kg(n,e,t,s,r){var i=t._reactRootContainer;if(i){var a=i;if(typeof r=="function"){var o=r;r=function(){var l=Pm(a);o.call(l)}}Sg(e,a,n,r)}else a=fj(t,e,n,r,s);return Pm(a)}f_=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Uu(e.pendingLanes);t!==0&&(hv(e,t|1),ws(e,Ye()),!(ye&6)&&(pu=Ye()+500,Na()))}break;case 13:ol(function(){var s=oi(n,1);if(s!==null){var r=rs();Mn(s,n,1,r)}}),Vv(n,1)}};fv=function(n){if(n.tag===13){var e=oi(n,134217728);if(e!==null){var t=rs();Mn(e,n,134217728,t)}Vv(n,134217728)}};p_=function(n){if(n.tag===13){var e=ma(n),t=oi(n,e);if(t!==null){var s=rs();Mn(t,n,e,s)}Vv(n,e)}};m_=function(){return Ee};g_=function(n,e){var t=Ee;try{return Ee=n,e()}finally{Ee=t}};W0=function(n,e,t){switch(e){case"input":if(O0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var r=gg(s);if(!r)throw Error(z(90));G1(s),O0(s,r)}}}break;case"textarea":K1(n,t);break;case"select":e=t.value,e!=null&&Kl(n,!!t.multiple,e,!1)}};s_=Bv;n_=ol;var pj={usingClientEntryPoint:!1,Events:[Cf,Fl,gg,e_,t_,Bv]},Pu={findFiberByHostInstance:za,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mj={bundleType:Pu.bundleType,version:Pu.version,rendererPackageName:Pu.rendererPackageName,rendererConfig:Pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ui.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=a_(n),n===null?null:n.stateNode},findFiberByHostInstance:Pu.findFiberByHostInstance||hj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ip=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ip.isDisabled&&ip.supportsFiber)try{hg=ip.inject(mj),cr=ip}catch{}}qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pj;qs.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gv(e))throw Error(z(200));return dj(n,e,null,t)};qs.createRoot=function(n,e){if(!Gv(n))throw Error(z(299));var t=!1,s="",r=FS;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Wv(n,1,!1,null,null,t,!1,s,r),n[ai]=e.current,Td(n.nodeType===8?n.parentNode:n),new qv(e)};qs.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(z(188)):(n=Object.keys(n).join(","),Error(z(268,n)));return n=a_(e),n=n===null?null:n.stateNode,n};qs.flushSync=function(n){return ol(n)};qs.hydrate=function(n,e,t){if(!Eg(e))throw Error(z(200));return kg(null,n,e,!0,t)};qs.hydrateRoot=function(n,e,t){if(!Gv(n))throw Error(z(405));var s=t!=null&&t.hydratedSources||null,r=!1,i="",a=FS;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=OS(e,null,n,1,t??null,r,!1,i,a),n[ai]=e.current,Td(n),s)for(n=0;n<s.length;n++)t=s[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new Ag(e)};qs.render=function(n,e,t){if(!Eg(e))throw Error(z(200));return kg(null,n,e,!1,t)};qs.unmountComponentAtNode=function(n){if(!Eg(n))throw Error(z(40));return n._reactRootContainer?(ol(function(){kg(null,null,n,!1,function(){n._reactRootContainer=null,n[ai]=null})}),!0):!1};qs.unstable_batchedUpdates=Bv;qs.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!Eg(t))throw Error(z(200));if(n==null||n._reactInternals===void 0)throw Error(z(38));return kg(n,e,t,!1,s)};qs.version="18.3.1-next-f1338f8080-20240426";function $S(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($S)}catch(n){console.error(n)}}$S(),$1.exports=qs;var gj=$1.exports,BS,Tb=gj;BS=Tb.createRoot,Tb.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $d(){return $d=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$d.apply(this,arguments)}var la;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(la||(la={}));const Pb="popstate";function xj(n){n===void 0&&(n={});function e(s,r){let{pathname:i,search:a,hash:o}=s.location;return Sx("",{pathname:i,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:Rm(r)}return vj(e,t,null,n)}function nt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function US(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yj(){return Math.random().toString(36).substr(2,8)}function Rb(n,e){return{usr:n.state,key:n.key,idx:e}}function Sx(n,e,t,s){return t===void 0&&(t=null),$d({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?wu(e):e,{state:t,key:e&&e.key||s||yj()})}function Rm(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function wu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function vj(n,e,t,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,o=la.Pop,l=null,d=h();d==null&&(d=0,a.replaceState($d({},a.state,{idx:d}),""));function h(){return(a.state||{idx:null}).idx}function f(){o=la.Pop;let _=h(),g=_==null?null:_-d;d=_,l&&l({action:o,location:x.location,delta:g})}function p(_,g){o=la.Push;let w=Sx(x.location,_,g);d=h()+1;let b=Rb(w,d),k=x.createHref(w);try{a.pushState(b,"",k)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;r.location.assign(k)}i&&l&&l({action:o,location:x.location,delta:1})}function m(_,g){o=la.Replace;let w=Sx(x.location,_,g);d=h();let b=Rb(w,d),k=x.createHref(w);a.replaceState(b,"",k),i&&l&&l({action:o,location:x.location,delta:0})}function y(_){let g=r.location.origin!=="null"?r.location.origin:r.location.href,w=typeof _=="string"?_:Rm(_);return w=w.replace(/ $/,"%20"),nt(g,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,g)}let x={get action(){return o},get location(){return n(r,a)},listen(_){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Pb,f),l=_,()=>{r.removeEventListener(Pb,f),l=null}},createHref(_){return e(r,_)},createURL:y,encodeLocation(_){let g=y(_);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:p,replace:m,go(_){return a.go(_)}};return x}var Lb;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Lb||(Lb={}));function wj(n,e,t){return t===void 0&&(t="/"),bj(n,e,t,!1)}function bj(n,e,t,s){let r=typeof e=="string"?wu(e):e,i=Xv(r.pathname||"/",t);if(i==null)return null;let a=zS(n);_j(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let d=Lj(i);o=Pj(a[l],d,s)}return o}function zS(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let r=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(nt(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let d=xa([s,l.relativePath]),h=t.concat(l);i.children&&i.children.length>0&&(nt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),zS(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Cj(d,i.index),routesMeta:h})};return n.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))r(i,a);else for(let l of HS(i.path))r(i,a,l)}),e}function HS(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let a=HS(s.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),r&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function _j(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Tj(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const Sj=/^:[\w-]+$/,Aj=3,Ej=2,kj=1,Nj=10,jj=-2,Ib=n=>n==="*";function Cj(n,e){let t=n.split("/"),s=t.length;return t.some(Ib)&&(s+=jj),e&&(s+=Ej),t.filter(r=>!Ib(r)).reduce((r,i)=>r+(Sj.test(i)?Aj:i===""?kj:Nj),s)}function Tj(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function Pj(n,e,t){let{routesMeta:s}=n,r={},i="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],d=o===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Mb({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),p=l.route;if(!f&&d&&t&&!s[s.length-1].route.index&&(f=Mb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(r,f.params),a.push({params:r,pathname:xa([i,f.pathname]),pathnameBase:Oj(xa([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=xa([i,f.pathnameBase]))}return a}function Mb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=Rj(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((d,h,f)=>{let{paramName:p,isOptional:m}=h;if(p==="*"){let x=o[f]||"";a=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const y=o[f];return m&&!y?d[p]=void 0:d[p]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:n}}function Rj(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),US(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function Lj(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return US(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Xv(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function Ij(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?wu(n):n;return{pathname:t?t.startsWith("/")?t:Mj(t,e):e,search:Fj(s),hash:$j(r)}}function Mj(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function g0(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Dj(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function WS(n,e){let t=Dj(n);return e?t.map((s,r)=>r===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function VS(n,e,t,s){s===void 0&&(s=!1);let r;typeof n=="string"?r=wu(n):(r=$d({},n),nt(!r.pathname||!r.pathname.includes("?"),g0("?","pathname","search",r)),nt(!r.pathname||!r.pathname.includes("#"),g0("#","pathname","hash",r)),nt(!r.search||!r.search.includes("#"),g0("#","search","hash",r)));let i=n===""||r.pathname==="",a=i?"/":r.pathname,o;if(a==null)o=t;else{let f=e.length-1;if(!s&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;r.pathname=p.join("/")}o=f>=0?e[f]:"/"}let l=Ij(r,o),d=a&&a!=="/"&&a.endsWith("/"),h=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}const xa=n=>n.join("/").replace(/\/\/+/g,"/"),Oj=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Fj=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,$j=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Bj(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const qS=["post","put","patch","delete"];new Set(qS);const Uj=["get",...qS];new Set(Uj);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bd(){return Bd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Bd.apply(this,arguments)}const Kv=C.createContext(null),zj=C.createContext(null),fl=C.createContext(null),Ng=C.createContext(null),ja=C.createContext({outlet:null,matches:[],isDataRoute:!1}),GS=C.createContext(null);function Hj(n,e){let{relative:t}=e===void 0?{}:e;Pf()||nt(!1);let{basename:s,navigator:r}=C.useContext(fl),{hash:i,pathname:a,search:o}=KS(n,{relative:t}),l=a;return s!=="/"&&(l=a==="/"?s:xa([s,a])),r.createHref({pathname:l,search:o,hash:i})}function Pf(){return C.useContext(Ng)!=null}function Rf(){return Pf()||nt(!1),C.useContext(Ng).location}function XS(n){C.useContext(fl).static||C.useLayoutEffect(n)}function Ca(){let{isDataRoute:n}=C.useContext(ja);return n?sC():Wj()}function Wj(){Pf()||nt(!1);let n=C.useContext(Kv),{basename:e,future:t,navigator:s}=C.useContext(fl),{matches:r}=C.useContext(ja),{pathname:i}=Rf(),a=JSON.stringify(WS(r,t.v7_relativeSplatPath)),o=C.useRef(!1);return XS(()=>{o.current=!0}),C.useCallback(function(d,h){if(h===void 0&&(h={}),!o.current)return;if(typeof d=="number"){s.go(d);return}let f=VS(d,JSON.parse(a),i,h.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:xa([e,f.pathname])),(h.replace?s.replace:s.push)(f,h.state,h)},[e,s,a,i,n])}function Yv(){let{matches:n}=C.useContext(ja),e=n[n.length-1];return e?e.params:{}}function KS(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=C.useContext(fl),{matches:r}=C.useContext(ja),{pathname:i}=Rf(),a=JSON.stringify(WS(r,s.v7_relativeSplatPath));return C.useMemo(()=>VS(n,JSON.parse(a),i,t==="path"),[n,a,i,t])}function Vj(n,e){return qj(n,e)}function qj(n,e,t,s){Pf()||nt(!1);let{navigator:r}=C.useContext(fl),{matches:i}=C.useContext(ja),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let d=Rf(),h;if(e){var f;let _=typeof e=="string"?wu(e):e;l==="/"||(f=_.pathname)!=null&&f.startsWith(l)||nt(!1),h=_}else h=d;let p=h.pathname||"/",m=p;if(l!=="/"){let _=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let y=wj(n,{pathname:m}),x=Qj(y&&y.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:xa([l,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:xa([l,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,t,s);return e&&x?C.createElement(Ng.Provider,{value:{location:Bd({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:la.Pop}},x):x}function Gj(){let n=tC(),e=Bj(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),t?C.createElement("pre",{style:r},t):null,null)}const Xj=C.createElement(Gj,null);class Kj extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(ja.Provider,{value:this.props.routeContext},C.createElement(GS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Yj(n){let{routeContext:e,match:t,children:s}=n,r=C.useContext(Kv);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(ja.Provider,{value:e},s)}function Qj(n,e,t,s){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(r=t)==null?void 0:r.errors;if(o!=null){let h=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);h>=0||nt(!1),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,d=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:p,errors:m}=t,y=f.route.loader&&p[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||y){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((h,f,p)=>{let m,y=!1,x=null,_=null;t&&(m=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||Xj,l&&(d<0&&p===0?(y=!0,_=null):d===p&&(y=!0,_=f.route.hydrateFallbackElement||null)));let g=e.concat(a.slice(0,p+1)),w=()=>{let b;return m?b=x:y?b=_:f.route.Component?b=C.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=h,C.createElement(Yj,{match:f,routeContext:{outlet:h,matches:g,isDataRoute:t!=null},children:b})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?C.createElement(Kj,{location:t.location,revalidation:t.revalidation,component:x,error:m,children:w(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):w()},null)}var YS=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(YS||{}),Lm=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Lm||{});function Jj(n){let e=C.useContext(Kv);return e||nt(!1),e}function Zj(n){let e=C.useContext(zj);return e||nt(!1),e}function eC(n){let e=C.useContext(ja);return e||nt(!1),e}function QS(n){let e=eC(),t=e.matches[e.matches.length-1];return t.route.id||nt(!1),t.route.id}function tC(){var n;let e=C.useContext(GS),t=Zj(Lm.UseRouteError),s=QS(Lm.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function sC(){let{router:n}=Jj(YS.UseNavigateStable),e=QS(Lm.UseNavigateStable),t=C.useRef(!1);return XS(()=>{t.current=!0}),C.useCallback(function(r,i){i===void 0&&(i={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,Bd({fromRouteId:e},i)))},[n,e])}function nC(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Ks(n){nt(!1)}function rC(n){let{basename:e="/",children:t=null,location:s,navigationType:r=la.Pop,navigator:i,static:a=!1,future:o}=n;Pf()&&nt(!1);let l=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:l,navigator:i,static:a,future:Bd({v7_relativeSplatPath:!1},o)}),[l,o,i,a]);typeof s=="string"&&(s=wu(s));let{pathname:h="/",search:f="",hash:p="",state:m=null,key:y="default"}=s,x=C.useMemo(()=>{let _=Xv(h,l);return _==null?null:{location:{pathname:_,search:f,hash:p,state:m,key:y},navigationType:r}},[l,h,f,p,m,y,r]);return x==null?null:C.createElement(fl.Provider,{value:d},C.createElement(Ng.Provider,{children:t,value:x}))}function iC(n){let{children:e,location:t}=n;return Vj(Ax(e),t)}new Promise(()=>{});function Ax(n,e){e===void 0&&(e=[]);let t=[];return C.Children.forEach(n,(s,r)=>{if(!C.isValidElement(s))return;let i=[...e,r];if(s.type===C.Fragment){t.push.apply(t,Ax(s.props.children,i));return}s.type!==Ks&&nt(!1),!s.props.index||!s.props.children||nt(!1);let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Ax(s.props.children,i)),t.push(a)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ex(){return Ex=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Ex.apply(this,arguments)}function aC(n,e){if(n==null)return{};var t={},s=Object.keys(n),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function oC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function lC(n,e){return n.button===0&&(!e||e==="_self")&&!oC(n)}const cC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],uC="6";try{window.__reactRouterVersion=uC}catch{}const dC="startTransition",Db=ik[dC];function hC(n){let{basename:e,children:t,future:s,window:r}=n,i=C.useRef();i.current==null&&(i.current=xj({window:r,v5Compat:!0}));let a=i.current,[o,l]=C.useState({action:a.action,location:a.location}),{v7_startTransition:d}=s||{},h=C.useCallback(f=>{d&&Db?Db(()=>l(f)):l(f)},[l,d]);return C.useLayoutEffect(()=>a.listen(h),[a,h]),C.useEffect(()=>nC(s),[s]),C.createElement(rC,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:s})}const fC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=C.forwardRef(function(e,t){let{onClick:s,relative:r,reloadDocument:i,replace:a,state:o,target:l,to:d,preventScrollReset:h,viewTransition:f}=e,p=aC(e,cC),{basename:m}=C.useContext(fl),y,x=!1;if(typeof d=="string"&&pC.test(d)&&(y=d,fC))try{let b=new URL(window.location.href),k=d.startsWith("//")?new URL(b.protocol+d):new URL(d),E=Xv(k.pathname,m);k.origin===b.origin&&E!=null?d=E+k.search+k.hash:x=!0}catch{}let _=Hj(d,{relative:r}),g=mC(d,{replace:a,state:o,target:l,preventScrollReset:h,relative:r,viewTransition:f});function w(b){s&&s(b),b.defaultPrevented||g(b)}return C.createElement("a",Ex({},p,{href:y||_,onClick:x||i?s:w,ref:t,target:l}))});var Ob;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Ob||(Ob={}));var Fb;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Fb||(Fb={}));function mC(n,e){let{target:t,replace:s,state:r,preventScrollReset:i,relative:a,viewTransition:o}=e===void 0?{}:e,l=Ca(),d=Rf(),h=KS(n,{relative:a});return C.useCallback(f=>{if(lC(f,t)){f.preventDefault();let p=s!==void 0?s:Rm(d)===Rm(h);l(n,{replace:p,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[d,l,h,s,r,t,n,i,a,o])}const gC="modulepreload",xC=function(n){return"/abtraining.ca/"+n},$b={},Lf=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(t.map(l=>{if(l=xC(l),l in $b)return;$b[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":gC,d||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},yC=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lf(async()=>{const{default:s}=await Promise.resolve().then(()=>bu);return{default:s}},[]).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Qv extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class vC extends Qv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class wC extends Qv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bC extends Qv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var kx;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(kx||(kx={}));var _C=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,e||[])).next())})};class SC{constructor(e,{headers:t={},customFetch:s,region:r=kx.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=yC(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return _C(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let d;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(o["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(o["Content-Type"]="application/json",d=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:d}).catch(y=>{throw new vC(y)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new wC(h);if(!h.ok)throw new bC(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return p==="application/json"?m=yield h.json():p==="application/octet-stream"?m=yield h.blob():p==="text/event-stream"?m=h:p==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null}}catch(r){return{data:null,error:r}}})}}var gs={},Jv={},jg={},If={},Cg={},Tg={},AC=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},mu=AC();const EC=mu.fetch,JS=mu.fetch.bind(mu),ZS=mu.Headers,kC=mu.Request,NC=mu.Response,bu=Object.freeze(Object.defineProperty({__proto__:null,Headers:ZS,Request:kC,Response:NC,default:JS,fetch:EC},Symbol.toStringTag,{value:"Module"})),jC=HE(bu);var Pg={};Object.defineProperty(Pg,"__esModule",{value:!0});let CC=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Pg.default=CC;var eA=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Tg,"__esModule",{value:!0});const TC=eA(jC),PC=eA(Pg);let RC=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=TC.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l;let d=null,h=null,f=null,p=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const g=await i.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=g:h=JSON.parse(g))}const x=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),_=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");x&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,p=406,m="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const x=await i.text();try{d=JSON.parse(x),Array.isArray(d)&&i.status===404&&(h=[],d=null,p=200,m="OK")}catch{i.status===404&&x===""?(p=204,m="No Content"):d={message:x}}if(d&&this.isMaybeSingle&&(!((l=d==null?void 0:d.details)===null||l===void 0)&&l.includes("0 rows"))&&(d=null,p=200,m="OK"),d&&this.shouldThrowOnError)throw new PC.default(d)}return{error:d,data:h,count:f,status:p,statusText:m}});return this.shouldThrowOnError||(r=r.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};Tg.default=RC;var LC=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Cg,"__esModule",{value:!0});const IC=LC(Tg);let MC=class extends IC.default{select(e){let t=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${d}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Cg.default=MC;var DC=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(If,"__esModule",{value:!0});const OC=DC(Cg);let FC=class extends OC.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};If.default=FC;var $C=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(jg,"__esModule",{value:!0});const Ru=$C(If);let BC=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new Ru.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ru.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(l.length>0){const d=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new Ru.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new Ru.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Ru.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};jg.default=BC;var Rg={},Lg={};Object.defineProperty(Lg,"__esModule",{value:!0});Lg.version=void 0;Lg.version="0.0.0-automated";Object.defineProperty(Rg,"__esModule",{value:!0});Rg.DEFAULT_HEADERS=void 0;const UC=Lg;Rg.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${UC.version}`};var tA=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Jv,"__esModule",{value:!0});const zC=tA(jg),HC=tA(If),WC=Rg;let VC=class sA{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},WC.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new zC.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new sA(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;s||r?(a=s?"HEAD":"GET",Object.entries(t).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{o.searchParams.append(h,f)})):(a="POST",l=t);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new HC.default({method:a,url:o,headers:d,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Jv.default=VC;var _u=dn&&dn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(gs,"__esModule",{value:!0});gs.PostgrestError=gs.PostgrestBuilder=gs.PostgrestTransformBuilder=gs.PostgrestFilterBuilder=gs.PostgrestQueryBuilder=gs.PostgrestClient=void 0;const nA=_u(Jv);gs.PostgrestClient=nA.default;const rA=_u(jg);gs.PostgrestQueryBuilder=rA.default;const iA=_u(If);gs.PostgrestFilterBuilder=iA.default;const aA=_u(Cg);gs.PostgrestTransformBuilder=aA.default;const oA=_u(Tg);gs.PostgrestBuilder=oA.default;const lA=_u(Pg);gs.PostgrestError=lA.default;var qC=gs.default={PostgrestClient:nA.default,PostgrestQueryBuilder:rA.default,PostgrestFilterBuilder:iA.default,PostgrestTransformBuilder:aA.default,PostgrestBuilder:oA.default,PostgrestError:lA.default};const{PostgrestClient:GC,PostgrestQueryBuilder:mI,PostgrestFilterBuilder:gI,PostgrestTransformBuilder:xI,PostgrestBuilder:yI,PostgrestError:vI}=qC;function XC(){if(typeof WebSocket<"u")return WebSocket;if(typeof globalThis.WebSocket<"u")return globalThis.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const KC=XC(),YC="2.11.15",QC=`realtime-js/${YC}`,JC="1.0.0",cA=1e4,ZC=1e3;var yd;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(yd||(yd={}));var Ft;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ft||(Ft={}));var Pn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Pn||(Pn={}));var Nx;(function(n){n.websocket="websocket"})(Nx||(Nx={}));var $a;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})($a||($a={}));class eT{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+r));a=a+r;const l=s.decode(e.slice(a,a+i));a=a+i;const d=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:d}}}class uA{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Te;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Te||(Te={}));const Bb=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=tT(a,n,e,r),i),{})},tT=(n,e,t,s)=>{const r=e.find(o=>o.name===n),i=r==null?void 0:r.type,a=t[n];return i&&!s.includes(i)?dA(i,a):jx(a)},dA=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return iT(e,t)}switch(n){case Te.bool:return sT(e);case Te.float4:case Te.float8:case Te.int2:case Te.int4:case Te.int8:case Te.numeric:case Te.oid:return nT(e);case Te.json:case Te.jsonb:return rT(e);case Te.timestamp:return aT(e);case Te.abstime:case Te.date:case Te.daterange:case Te.int4range:case Te.int8range:case Te.money:case Te.reltime:case Te.text:case Te.time:case Te.timestamptz:case Te.timetz:case Te.tsrange:case Te.tstzrange:return jx(e);default:return jx(e)}},jx=n=>n,sT=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},nT=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},rT=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},iT=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>dA(e,o))}return n},aT=n=>typeof n=="string"?n.replace(" ","T"):n,hA=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class x0{constructor(e,t,s={},r=cA){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ub;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ub||(Ub={}));class vd{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vd.syncState(this.state,r,i,a),this.pendingDiffs.forEach(l=>{this.state=vd.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=vd.syncDiff(this.state,r,i,a),o())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(d,h)=>{a[d]||(l[d]=h)}),this.map(a,(d,h)=>{const f=i[d];if(f){const p=h.map(_=>_.presence_ref),m=f.map(_=>_.presence_ref),y=h.filter(_=>m.indexOf(_.presence_ref)<0),x=f.filter(_=>p.indexOf(_.presence_ref)<0);y.length>0&&(o[d]=y),x.length>0&&(l[d]=x)}else o[d]=h}),this.syncDiff(i,{joins:o,leaves:l},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(o,l)=>{var d;const h=(d=e[o])!==null&&d!==void 0?d:[];if(e[o]=this.cloneDeep(l),h.length>0){const f=e[o].map(m=>m.presence_ref),p=h.filter(m=>f.indexOf(m.presence_ref)<0);e[o].unshift(...p)}s(o,h,l)}),this.map(a,(o,l)=>{let d=e[o];if(!d)return;const h=l.map(f=>f.presence_ref);d=d.filter(f=>h.indexOf(f.presence_ref)<0),e[o]=d,r(o,d,l),d.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zb;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(zb||(zb={}));var Hb;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Hb||(Hb={}));var yr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(yr||(yr={}));class Zv{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new x0(this,Pn.join,this.params,this.timeout),this.rejoinTimer=new uA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ft.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pn.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new vd(this),this.broadcastEndpointURL=hA(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==Ft.closed){const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(h=>e==null?void 0:e(yr.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(yr.CLOSED));const l={},d={broadcast:i,presence:a,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(h=>h.filter))!==null&&r!==void 0?r:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var f;if(this.socket.setAuth(),h===void 0){e==null||e(yr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,m=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,y=[];for(let x=0;x<m;x++){const _=p[x],{filter:{event:g,schema:w,table:b,filter:k}}=_,E=h&&h[x];if(E&&E.event===g&&E.schema===w&&E.table===b&&E.filter===k)y.push(Object.assign(Object.assign({},_),{id:E.id}));else{this.unsubscribe(),this.state=Ft.errored,e==null||e(yr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(yr.SUBSCRIBED);return}}).receive("error",h=>{this.state=Ft.errored,e==null||e(yr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(yr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=d.body)===null||r===void 0?void 0:r.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ft.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new x0(this,Pn.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new x0(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:d,join:h}=Pn;if(s&&[o,l,d,h].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(m=>{var y,x,_;return((y=m.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(x=m.filter)===null||x===void 0?void 0:x.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(m=>m.callback(p,s)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var y,x,_,g,w,b;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const k=m.id,E=(y=m.filter)===null||y===void 0?void 0:y.event;return k&&((x=t.ids)===null||x===void 0?void 0:x.includes(k))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const k=(w=(g=m==null?void 0:m.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return k==="*"||k===((b=t==null?void 0:t.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:x,table:_,commit_timestamp:g,type:w,errors:b}=y;p=Object.assign(Object.assign({},{schema:x,table:_,commit_timestamp:g,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(y))}m.callback(p,s)})}_isClosed(){return this.state===Ft.closed}_isJoined(){return this.state===Ft.joined}_isJoining(){return this.state===Ft.joining}_isLeaving(){return this.state===Ft.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Zv.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Pn.close,{},e)}_onError(e){this._on(Pn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ft.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Bb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Bb(e.columns,e.old_record)),t}}const Wb=()=>{},oT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class lT{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cA,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wb,this.ref=0,this.logger=Wb,this.conn=null,this.sendBuffer=[],this.serializer=new eT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Lf(async()=>{const{default:l}=await Promise.resolve().then(()=>bu);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Nx.websocket}`,this.httpEndpoint=hA(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new uA(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=KC),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:JC}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case yd.connecting:return $a.Connecting;case yd.open:return $a.Open;case yd.closing:return $a.Closing;default:return $a.Closed}}isConnected(){return this.connectionState()===$a.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new Zv(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:r,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const r={access_token:t,version:QC};t&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(Pn.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(ZC,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:i,ref:a}=t;s==="phoenix"&&r==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${r} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(s)).forEach(o=>o._trigger(r,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Pn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([oT],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class ew extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function vt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class cT extends ew{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Cx extends ew{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var uT=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,e||[])).next())})};const fA=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lf(async()=>{const{default:s}=await Promise.resolve().then(()=>bu);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},dT=()=>uT(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Lf(()=>Promise.resolve().then(()=>bu),void 0)).Response:Response}),Tx=n=>{if(Array.isArray(n))return n.map(t=>Tx(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=Tx(s)}),e};var pl=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,e||[])).next())})};const y0=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),hT=(n,e,t)=>pl(void 0,void 0,void 0,function*(){const s=yield dT();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{e(new cT(y0(r),n.status||500))}).catch(r=>{e(new Cx(y0(r),r))}):e(new Cx(y0(n),n))}),fT=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(r.body=JSON.stringify(s)),Object.assign(Object.assign({},r),t))};function Mf(n,e,t,s,r,i){return pl(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,fT(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>hT(l,o,s))})})}function Im(n,e,t,s){return pl(this,void 0,void 0,function*(){return Mf(n,"GET",e,t,s)})}function xi(n,e,t,s,r){return pl(this,void 0,void 0,function*(){return Mf(n,"POST",e,s,r,t)})}function pT(n,e,t,s,r){return pl(this,void 0,void 0,function*(){return Mf(n,"PUT",e,s,r,t)})}function mT(n,e,t,s){return pl(this,void 0,void 0,function*(){return Mf(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function pA(n,e,t,s,r){return pl(this,void 0,void 0,function*(){return Mf(n,"DELETE",e,s,r,t)})}var ls=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,e||[])).next())})};const gT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xT{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=fA(r)}uploadOrUpdate(e,t,s,r){return ls(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Vb),r);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),f=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),p=yield f.json();return f.ok?{data:{path:d,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}upload(e,t,s){return ls(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return ls(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const d=Object.assign({upsert:Vb.upsert},r),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",d.cacheControl)):(l=s,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:h}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(vt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ls(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const i=yield xi(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new ew("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(vt(s))return{data:null,error:s};throw s}})}update(e,t,s){return ls(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ls(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}copy(e,t,s){return ls(this,void 0,void 0,function*(){try{return{data:{path:(yield xi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return ls(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield xi(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return ls(this,void 0,void 0,function*(){try{const r=yield xi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}download(e,t){return ls(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Im(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(vt(o))return{data:null,error:o};throw o}})}info(e){return ls(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Im(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Tx(s),error:null}}catch(s){if(vt(s))return{data:null,error:s};throw s}})}exists(e){return ls(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield mT(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(vt(s)&&s instanceof Cx){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let d=r.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${d}`)}}}remove(e){return ls(this,void 0,void 0,function*(){try{return{data:yield pA(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}list(e,t,s){return ls(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},gT),t),{prefix:e||""});return{data:yield xi(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const yT="2.7.1",vT={"X-Client-Info":`storage-js/${yT}`};var bl=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,[])).next())})};class wT{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},vT),t),this.fetch=fA(s)}listBuckets(){return bl(this,void 0,void 0,function*(){try{return{data:yield Im(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(vt(e))return{data:null,error:e};throw e}})}getBucket(e){return bl(this,void 0,void 0,function*(){try{return{data:yield Im(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return bl(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(vt(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return bl(this,void 0,void 0,function*(){try{return{data:yield pT(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(vt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return bl(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bl(this,void 0,void 0,function*(){try{return{data:yield pA(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}}class bT extends wT{constructor(e,t={},s){super(e,t,s)}from(e){return new xT(this.url,this.headers,e,this.fetch)}}const _T="2.50.2";let Hu="";typeof Deno<"u"?Hu="deno":typeof document<"u"?Hu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hu="react-native":Hu="node";const ST={"X-Client-Info":`supabase-js-${Hu}/${_T}`},AT={headers:ST},ET={schema:"public"},kT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},NT={};var jT=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,e||[])).next())})};const CT=n=>{let e;return n?e=n:typeof fetch>"u"?e=JS:e=fetch,(...t)=>e(...t)},TT=()=>typeof Headers>"u"?ZS:Headers,PT=(n,e,t)=>{const s=CT(t),r=TT();return(i,a)=>jT(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let d=new r(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:d}))})};var RT=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,[])).next())})};function LT(n){return n.endsWith("/")?n:n+"/"}function IT(n,e){var t,s;const{db:r,auth:i,realtime:a,global:o}=n,{db:l,auth:d,realtime:h,global:f}=e,p={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},h),a),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>RT(this,void 0,void 0,function*(){return""})};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}const mA="2.70.0",El=30*1e3,Px=3,v0=Px*El,MT="http://localhost:9999",DT="supabase.auth.token",OT={"X-Client-Info":`gotrue-js/${mA}`},Rx="X-Supabase-Api-Version",gA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},FT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$T=6e5;class tw extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function ce(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class BT extends tw{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function UT(n){return ce(n)&&n.name==="AuthApiError"}class xA extends tw{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ta extends tw{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class fi extends Ta{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zT(n){return ce(n)&&n.name==="AuthSessionMissingError"}class ap extends Ta{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class op extends Ta{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lp extends Ta{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function HT(n){return ce(n)&&n.name==="AuthImplicitGrantRedirectError"}class qb extends Ta{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Lx extends Ta{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function w0(n){return ce(n)&&n.name==="AuthRetryableFetchError"}class Gb extends Ta{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class wd extends Ta{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Mm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xb=` 	
\r=`.split(""),WT=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Xb.length;e+=1)n[Xb[e].charCodeAt(0)]=-2;for(let e=0;e<Mm.length;e+=1)n[Mm[e].charCodeAt(0)]=e;return n})();function Kb(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Mm[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Mm[s]),e.queuedBits-=6}}function yA(n,e,t){const s=WT[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Yb(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=a=>{GT(a,s,t)};for(let a=0;a<n.length;a+=1)yA(n.charCodeAt(a),r,i);return e.join("")}function VT(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function qT(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}VT(s,e)}}function GT(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function XT(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)yA(n.charCodeAt(r),t,s);return new Uint8Array(e)}function KT(n){const e=[];return qT(n,t=>e.push(t)),new Uint8Array(e)}function YT(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};return n.forEach(r=>Kb(r,t,s)),Kb(null,t,s),e.join("")}function QT(n){return Math.round(Date.now()/1e3)+n}function JT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const mn=()=>typeof window<"u"&&typeof document<"u",Ra={tested:!1,writable:!1},bd=()=>{if(!mn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ra.tested)return Ra.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ra.tested=!0,Ra.writable=!0}catch{Ra.tested=!0,Ra.writable=!1}return Ra.writable};function ZT(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const vA=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lf(async()=>{const{default:s}=await Promise.resolve().then(()=>bu);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},eP=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",wA=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},cp=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},up=async(n,e)=>{await n.removeItem(e)};class Ig{constructor(){this.promise=new Ig.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ig.promiseConstructor=Promise;function b0(n){const e=n.split(".");if(e.length!==3)throw new wd("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!FT.test(e[s]))throw new wd("JWT not in base64url format");return{header:JSON.parse(Yb(e[0])),payload:JSON.parse(Yb(e[1])),signature:XT(e[2]),raw:{header:e[0],payload:e[1]}}}async function tP(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function sP(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function nP(n){return("0"+n.toString(16)).substr(-2)}function rP(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,nP).join("")}async function iP(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function aP(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await iP(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _l(n,e,t=!1){const s=rP();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await wA(n,`${e}-code-verifier`,r);const i=await aP(s);return[i,s===i?"plain":"s256"]}const oP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function lP(n){const e=n.headers.get(Rx);if(!e||!e.match(oP))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function cP(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function uP(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const dP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Sl(n){if(!dP.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var hP=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const Ma=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),fP=[502,503,504];async function Qb(n){var e;if(!eP(n))throw new Lx(Ma(n),0);if(fP.includes(n.status))throw new Lx(Ma(n),n.status);let t;try{t=await n.json()}catch(i){throw new xA(Ma(i),i)}let s;const r=lP(n);if(r&&r.getTime()>=gA["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Gb(Ma(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new fi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Gb(Ma(t),n.status,t.weak_password.reasons);throw new BT(Ma(t),n.status||500,s)}const pP=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function pe(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[Rx]||(i[Rx]=gA["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await mP(n,e,t+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function mP(n,e,t,s,r,i){const a=pP(e,s,r,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new Lx(Ma(l),0)}if(o.ok||await Qb(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Qb(l)}}function fr(n){var e;let t=null;vP(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=QT(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function Jb(n){const e=fr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function wi(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function gP(n){return{data:n,error:null}}function xP(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,a=hP(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function yP(n){return n}function vP(n){return n.access_token&&n.refresh_token&&n.expires_in}const _0=["global","local","others"];var wP=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class bP{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=vA(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=_0[0]){if(_0.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${_0.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:wi})}catch(s){if(ce(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=wP(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:xP,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ce(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:wi})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,a,o,l;try{const d={nextPage:null,lastPage:0,total:0},h=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:yP});if(h.error)throw h.error;const f=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(y=>{const x=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);d[`${_}Page`]=x}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(ce(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Sl(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:wi})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Sl(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:wi})}catch(s){if(ce(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Sl(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:wi})}catch(s){if(ce(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Sl(e.userId);try{const{data:t,error:s}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Sl(e.userId),Sl(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}}const _P={getItem:n=>bd()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{bd()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{bd()&&globalThis.localStorage.removeItem(n)}};function Zb(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function SP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Al={debug:!!(globalThis&&bd()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bA extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class AP extends bA{}async function EP(n,e,t){Al.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Al.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Al.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Al.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Al.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new AP(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Al.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}SP();const kP={url:MT,storageKey:DT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:OT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function e1(n,e,t){return await t()}class Ud{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ud.nextInstanceID,Ud.nextInstanceID+=1,this.instanceID>0&&mn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},kP),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new bP({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=vA(r.fetch),this.lock=r.lock||e1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:mn()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=EP:this.lock=e1,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:bd()?this.storage=_P:(this.memoryStorage={},this.storage=Zb(this.memoryStorage)):(this.memoryStorage={},this.storage=Zb(this.memoryStorage)),mn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${mA}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ZT(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),mn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),HT(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ce(t)?{error:t}:{error:new xA("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:fr}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(ce(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:h,password:f,options:p}=e;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await _l(this.storage,this.storageKey)),i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:h,password:f,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:y},xform:fr})}else if("phone"in e){const{phone:h,password:f,options:p}=e;i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:fr})}else throw new op("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(ce(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Jb})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Jb})}else throw new op("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new ap}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(ce(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,i,a,o,l,d,h,f,p,m;let y,x;if("message"in e)y=e.message,x=e.signature;else{const{chain:_,wallet:g,statement:w,options:b}=e;let k;if(mn())if(typeof g=="object")k=g;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))k=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const E=new URL((t=b==null?void 0:b.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in k&&k.signIn){const N=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),w?{statement:w}:null));let j;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")j=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)j=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)y=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),x=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${E.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(r=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(h=b==null?void 0:b.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const N=await k.signMessage(new TextEncoder().encode(y),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=N}}try{const{data:_,error:g}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:YT(x)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:fr});if(g)throw g;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new ap}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:g})}catch(_){if(ce(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await cp(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/");try{const{data:i,error:a}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:fr});if(await up(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ap}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:a})}catch(i){if(ce(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:a}=e,o=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:fr}),{data:l,error:d}=o;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ap}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(t){if(ce(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,a;try{if("email"in e){const{email:o,options:l}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await _l(this.storage,this.storageKey));const{error:f}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:d,error:h}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h}}throw new op("You must provide either an email or phone number.")}catch(o){if(ce(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:fr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,d=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(r){if(ce(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await _l(this.storage,this.storageKey)),await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:gP})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new fi;const{error:r}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(ce(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:o}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new op("You must provide either an email or phone number and a type")}catch(t){if(ce(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await cp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<v0:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,d,h)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,h))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:wi}):await this._useSession(async t=>{var s,r,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fi}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:wi})})}catch(t){if(ce(t))return zT(t)&&(await this._removeSession(),await up(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new fi;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await _l(this.storage,this.storageKey));const{data:d,error:h}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:wi});if(h)throw h;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(ce(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new fi;const t=Date.now()/1e3;let s=t,r=!0,i=null;const{payload:a}=b0(e.access_token);if(a.exp&&(s=a.exp,r=s<=t),r){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(ce(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new fi;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ce(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!mn())throw new lp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new qb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new lp("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new qb("No code detected.");const{data:w,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:d}=e;if(!i||!o||!a||!d)throw new lp("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(o);let p=h+f;l&&(p=parseInt(l));const m=p-h;m*1e3<=El&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const y=p-f;h-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,h):h-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,h);const{data:x,error:_}=await this._getUser(i);if(_)throw _;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:f,expires_at:p,refresh_token:a,token_type:d,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(ce(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await cp(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(UT(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await up(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=JT(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await _l(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async i=>{var a,o,l,d,h;const{data:f,error:p}=i;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(r)throw r;return mn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(ce(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)throw a;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await sP(async r=>(r>0&&await tP(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fr})),(r,i)=>{const a=200*Math.pow(2,r);return i&&w0(i)&&Date.now()+a-s<El})}catch(s){if(this._debug(t,"error",s),ce(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),mn()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await cp(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<v0;if(this._debug(t,`session has${r?"":" not"} expired with margin of ${v0}s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),w0(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new fi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ig;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new fi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(r,"error",i),ce(i)){const a={session:null,error:i};return w0(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await wA(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await up(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&mn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),El);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/El);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${El}ms, refresh threshold is ${Px} ticks`),r<=Px&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bA)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await _l(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:d}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(ce(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ce(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=b0(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(a=>a.kid===e);if(s||(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+$T>Date.now()))return s;const{data:r,error:i}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!r.keys||r.keys.length===0)throw new wd("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),s=r.keys.find(a=>a.kid===e),!s)throw new wd("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:m,error:y}=await this.getSession();if(y||!m.session)return{data:null,error:y};s=m.session.access_token}const{header:r,payload:i,signature:a,raw:{header:o,payload:l}}=b0(s);if(cP(i.exp),!r.kid||r.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:i,header:r,signature:a},error:null}}const d=uP(r.alg),h=await this.fetchJwk(r.kid,t),f=await crypto.subtle.importKey("jwk",h,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,a,KT(`${o}.${l}`)))throw new wd("Invalid JWT signature");return{data:{claims:i,header:r,signature:a},error:null}}catch(s){if(ce(s))return{data:null,error:s};throw s}}}Ud.nextInstanceID=0;const NP=Ud;class jP extends NP{constructor(e){super(e)}}var CP=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function l(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?i(h.value):r(h.value).then(o,l)}d((s=s.apply(n,[])).next())})};class TP{constructor(e,t,s){var r,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=LT(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const d=`sb-${l.hostname.split(".")[0]}-auth-token`,h={db:ET,realtime:NT,auth:Object.assign(Object.assign({},kT),{storageKey:d}),global:AT},f=IT(s??{},h);this.storageKey=(r=f.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=PT(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new GC(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new SC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new bT(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return CP(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:a,lock:o,debug:l},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jP({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:a,lock:o,debug:l,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new lT(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const PP=(n,e,t)=>new TP(n,e,t),RP="https://nnhgbtrkxepkeotpdnxw.supabase.co",LP="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5uaGdidHJreGVwa2VvdHBkbnh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA4MDAwNDcsImV4cCI6MjA2NjM3NjA0N30.AOn6Gzs9jt90YYwvjGF1ZyBB-YZ_G_sdoGSX8QJZKVo",se=PP(RP,LP,{auth:{persistSession:!0,storage:localStorage,autoRefreshToken:!0,detectSessionInUrl:!0}}),zs=async()=>{try{const{data:{session:n},error:e}=await se.auth.getSession();if(e)return console.error("Error getting session:",e),await tc(),null;if(!n)return console.warn("No valid session found"),null;const t=Math.floor(Date.now()/1e3);return(n.expires_at||0)-t<300?(console.log("Session expiring soon, attempting refresh..."),await IP()):n}catch(n){return console.error("Unexpected error verifying session:",n),await tc(),null}},IP=async()=>{try{const{data:{session:n},error:e}=await se.auth.refreshSession();return e?(console.error("Error refreshing session:",e),await tc(),null):n?(console.log("Session refreshed successfully"),n):(console.warn("No session returned after refresh"),await tc(),null)}catch(n){return console.error("Unexpected error refreshing session:",n),await tc(),null}},tc=async()=>{try{console.log("Handling auth error: clearing session and redirecting to login"),await se.auth.signOut(),localStorage.clear(),window.location.pathname!=="/login"&&(window.location.href="/login")}catch(n){console.error("Error during auth error handling:",n),localStorage.clear(),window.location.pathname!=="/login"&&(window.location.href="/login")}},Ht=async()=>{try{console.log("Logging out user..."),await se.auth.signOut(),localStorage.clear(),sessionStorage.clear(),window.location.href="/login"}catch(n){console.error("Error during logout:",n),localStorage.clear(),sessionStorage.clear(),window.location.href="/login"}},_A=C.createContext(void 0),ml=()=>{const n=C.useContext(_A);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},MP=({children:n})=>{const[e,t]=C.useState(null),[s,r]=C.useState(null),[i,a]=C.useState(!0),[o,l]=C.useState(!1);C.useEffect(()=>{(async()=>{try{console.log("Getting initial session...");const x=await zs();r(x),t((x==null?void 0:x.user)??null),x?console.log("Initial session found for user:",x.user.email):console.log("No initial session found")}catch(x){console.error("Error getting initial session:",x),r(null),t(null)}finally{a(!1),l(!0)}})();const{data:{subscription:y}}=se.auth.onAuthStateChange(async(x,_)=>{var g;console.log("Auth state changed:",x,((g=_==null?void 0:_.user)==null?void 0:g.email)||"no user");try{x==="SIGNED_OUT"||x==="TOKEN_REFRESHED"?x==="SIGNED_OUT"?(console.log("User signed out"),r(null),t(null)):x==="TOKEN_REFRESHED"&&_&&(console.log("Token refreshed successfully"),r(_),t(_.user)):x==="SIGNED_IN"&&_?(console.log("User signed in:",_.user.email),r(_),t(_.user)):x==="USER_UPDATED"&&_&&(console.log("User updated"),r(_),t(_.user))}catch(w){console.error("Error handling auth state change:",w),await tc()}finally{a(!1)}});return()=>y.unsubscribe()},[]);const p={user:e,session:s,loading:i,signIn:async(m,y)=>{try{console.log("Attempting to sign in user:",m),a(!0);const{error:x}=await se.auth.signInWithPassword({email:m,password:y});return x?(console.error("Sign in error:",x),{error:x}):(console.log("Sign in successful"),{error:null})}catch(x){return console.error("Unexpected sign in error:",x),{error:x}}finally{a(!1)}},signOut:async()=>{await Ht()},refreshSession:async()=>{try{console.log("Manually refreshing session...");const m=await zs();return m&&(r(m),t(m.user)),m}catch(m){return console.error("Error manually refreshing session:",m),null}}};return o?u.jsx(_A.Provider,{value:p,children:n}):u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Initializing..."})]})})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),re=(n,e)=>{const t=C.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:l,...d},h)=>C.createElement("svg",{ref:h,...DP,width:r,height:r,stroke:s,strokeWidth:a?Number(i)*24/Number(r):i,className:["lucide",`lucide-${OP(n)}`,o].join(" "),...d},[...e.map(([f,p])=>C.createElement(f,p)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=re("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=re("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=re("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=re("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=re("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hd=re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=re("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=re("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=re("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=re("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=re("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=re("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=re("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=re("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=re("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=re("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=re("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=re("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=re("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=re("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=re("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=re("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=re("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=re("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=re("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=re("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=re("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=re("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=re("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=re("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=re("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=re("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=re("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=re("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=re("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),rR=()=>{const[n,e]=C.useState(!1),[t,s]=C.useState(!0),[r,i]=C.useState(0),[a,o]=C.useState(null),l=Rf(),d=[{name:"Home",href:"/"},{name:"Training",href:"/training"},{name:"Indigenous Relations",href:"/indigenous-relations"}],h=f=>l.pathname===f;return C.useEffect(()=>{(async()=>{try{const{data:p,error:m}=await se.from("header_logo").select("*").eq("is_active",!0).order("order_index",{ascending:!0}).limit(1).single();m?(console.error("Error fetching header logo:",m),o({id:"fallback",logo_url:"/ATS.png",alt_text:"Aboriginal Training Services",order_index:0,is_active:!0})):o(p)}catch(p){console.error("Header logo fetch error:",p),o({id:"fallback",logo_url:"/ATS.png",alt_text:"Aboriginal Training Services",order_index:0,is_active:!0})}})()},[]),C.useEffect(()=>{const f=()=>{typeof window<"u"&&(window.scrollY>r&&window.scrollY>100?s(!1):s(!0),i(window.scrollY))};if(typeof window<"u")return window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[r]),u.jsxs("header",{className:`bg-white shadow-lg fixed top-0 left-0 right-0 z-50 transition-transform duration-500 ease-in-out ${t?"transform translate-y-0":"transform -translate-y-full"}`,children:[u.jsx("div",{className:"bg-blue-900 text-white py-1 sm:py-2",children:u.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center text-xs sm:text-sm",children:[u.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-6",children:[u.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[u.jsx(Vd,{className:"h-3 w-3 sm:h-4 sm:w-4"}),u.jsx("span",{className:"",children:"+1 (587) 524-0275"})]}),u.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[u.jsx(Mg,{className:"h-3 w-3 sm:h-4 sm:w-4"}),u.jsx("span",{className:"",children:"darcy@abtraining.ca"})]})]}),u.jsx("div",{className:"hidden md:block",children:u.jsx("span",{className:"text-blue-200 text-xs lg:text-sm",children:"Keepers of the land, keepers of the data, and keepers of the environment"})})]})})}),u.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-2 sm:py-4",children:[u.jsx("div",{className:"flex items-center",children:u.jsx(_e,{to:"/",className:"flex items-center",children:a?u.jsx("img",{src:a.logo_url,alt:a.alt_text,className:"h-12 sm:h-14 md:h-16 w-auto transition-transform duration-300 hover:scale-105",onError:f=>{f.currentTarget.src="/ATS.png",f.currentTarget.alt="Aboriginal Training Services"}}):u.jsx("div",{className:"h-12 sm:h-14 md:h-16 flex items-center",children:u.jsx("span",{className:"text-xl font-bold text-blue-700",children:"ATS"})})})}),u.jsx("nav",{className:"hidden lg:flex space-x-4 xl:space-x-8",children:d.map(f=>u.jsx(_e,{to:f.href,className:`px-3 xl:px-4 py-2 rounded-md text-sm font-medium transition-all duration-300 transform hover:scale-105 ${h(f.href)?"text-blue-700 bg-blue-50 shadow-md":"text-gray-700 hover:text-blue-700 hover:bg-gray-100 hover:shadow-sm"}`,children:f.name},f.name))}),u.jsx("div",{className:"hidden lg:flex items-center space-x-4",children:u.jsx(_e,{to:"/login",className:"bg-blue-700 hover:bg-blue-800 text-white px-4 xl:px-6 py-2 rounded-md text-sm font-medium transition-all duration-300 transform hover:scale-105 hover:shadow-lg",children:"Student Portal"})}),u.jsx("div",{className:"lg:hidden",children:u.jsx("button",{onClick:()=>e(!n),className:"bg-gray-100 p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all duration-300 transform hover:scale-105",children:n?u.jsx(NA,{className:"h-5 w-5 sm:h-6 sm:w-6"}):u.jsx(GP,{className:"h-5 w-5 sm:h-6 sm:w-6"})})})]})}),n&&u.jsx("div",{className:"lg:hidden transition-all duration-300 ease-in-out",children:u.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-gray-50 border-t",children:[d.map(f=>u.jsx(_e,{to:f.href,className:`block px-3 py-3 rounded-md text-base font-medium transition-all duration-300 transform hover:scale-105 ${h(f.href)?"text-blue-700 bg-blue-50":"text-gray-700 hover:text-blue-700 hover:bg-gray-100"}`,onClick:()=>e(!1),children:f.name},f.name)),u.jsx(_e,{to:"/login",className:"block px-3 py-3 rounded-md text-base font-medium bg-blue-700 text-white hover:bg-blue-800 transition-all duration-300 transform hover:scale-105 mt-2",onClick:()=>e(!1),children:"Student Portal"})]})})]})},iR=()=>u.jsx("footer",{className:"bg-gray-900 text-white transform transition-all duration-500 relative z-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8",children:[u.jsxs("div",{className:"space-y-4 transform transition-all duration-500 hover:scale-105 sm:col-span-2 lg:col-span-1",children:[u.jsx("h3",{className:"text-lg font-semibold text-blue-400",children:"Aboriginal Training Services"}),u.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:"Keepers of the land, keepers of the data, and keepers of the environment. Professional RPAS training with Indigenous excellence and land and environmental stewardship."}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Dm,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-300",children:"Professional RPAS Training"})]})]}),u.jsxs("div",{className:"space-y-4 transform transition-all duration-500 hover:scale-105",children:[u.jsx("h3",{className:"text-lg font-semibold text-blue-400",children:"Quick Links"}),u.jsxs("ul",{className:"space-y-2",children:[u.jsx("li",{children:u.jsx(_e,{to:"/training",className:"text-gray-300 hover:text-white text-sm transition-colors duration-200 block py-1",children:"Training Courses"})}),u.jsx("li",{children:u.jsx(_e,{to:"/indigenous-relations",className:"text-gray-300 hover:text-white text-sm transition-colors duration-200 block py-1",children:"Indigenous Relations"})}),u.jsx("li",{children:u.jsx(_e,{to:"/dashboard",className:"text-gray-300 hover:text-white text-sm transition-colors duration-200 block py-1",children:"Student Portal"})}),u.jsx("li",{children:u.jsx("a",{href:"/#contact",className:"text-gray-300 hover:text-white text-sm transition-colors duration-200 block py-1",children:"Contact Us"})})]})]}),u.jsxs("div",{className:"space-y-4 transform transition-all duration-500 hover:scale-105",children:[u.jsx("h3",{className:"text-lg font-semibold text-blue-400",children:"Our Focus"}),u.jsxs("ul",{className:"space-y-2",children:[u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(Wt,{className:"h-4 w-4 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"RPAS Certification"})]}),u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(qd,{className:"h-4 w-4 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"Environmental Protection"})]}),u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(Dm,{className:"h-4 w-4 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"Land Stewardship"})]}),u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(Wt,{className:"h-4 w-4 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"Professional RPAS Regulations and Applications Training"})]}),u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(qd,{className:"h-4 w-4 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"Customized Training"})]})]})]}),u.jsxs("div",{className:"space-y-4 transform transition-all duration-500 hover:scale-105",children:[u.jsx("h3",{className:"text-lg font-semibold text-blue-400",children:"Contact Information"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Vd,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300 text-sm",children:"+1 (587) 524-0275"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Mg,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300 text-sm break-all",children:"darcy@abtraining.ca"})]}),u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Vl,{className:"h-5 w-5 text-blue-400 flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"text-gray-300 text-sm",children:[u.jsxs("div",{className:"flex items-start mb-1",children:[u.jsx(Vl,{className:"h-3 w-3 mr-1 flex-shrink-0 mt-0.5"}),u.jsx("span",{children:"Edmonton, Alberta, Canada"})]}),u.jsxs("div",{className:"flex items-start mb-1",children:[u.jsx(Vl,{className:"h-3 w-3 mr-1 flex-shrink-0 mt-0.5"}),u.jsx("span",{children:"Chicago, Illinois, USA"})]}),u.jsxs("div",{className:"flex items-start",children:[u.jsx(Vl,{className:"h-3 w-3 mr-1 flex-shrink-0 mt-0.5"}),u.jsx("span",{children:"Karachi, Sindh, Pakistan"})]})]})]})]})]})]}),u.jsx("div",{className:"border-t border-gray-800 mt-8 sm:mt-12 pt-6 sm:pt-8",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0",children:[u.jsx("div",{className:"text-gray-400 text-sm text-center sm:text-left",children:" 2025 Aboriginal Training Services. All rights reserved."}),u.jsx("div",{className:"text-gray-400 text-sm text-center sm:text-right",children:"Mapping the lands and protecting the environment"})]})})]})}),Lu=({children:n})=>u.jsxs("div",{className:"min-h-screen flex flex-col relative overflow-hidden bg-transparent",children:[u.jsx(rR,{}),u.jsxs("main",{className:"flex-grow pt-[120px] sm:pt-[130px] md:pt-[140px]",children:[" ",n]}),u.jsx(iR,{})]}),Iu=({children:n})=>{const{user:e,loading:t,refreshSession:s}=ml(),r=Ca();return C.useEffect(()=>{(async()=>{if(!t){if(!e){console.log("No user found, redirecting to login"),r("/login",{replace:!0});return}try{await zs()||(console.log("Session verification failed, redirecting to login"),r("/login",{replace:!0}))}catch(a){console.error("Error verifying session in ProtectedRoute:",a),r("/login",{replace:!0})}}})()},[e,t,r]),C.useEffect(()=>{if(!e||t)return;const i=setInterval(async()=>{try{console.log("Periodic session check..."),await s()||(console.log("Periodic session check failed, redirecting to login"),r("/login",{replace:!0}))}catch(a){console.error("Error during periodic session check:",a),r("/login",{replace:!0})}},5*60*1e3);return()=>clearInterval(i)},[e,t,r,s]),C.useEffect(()=>{const i=async()=>{if(document.visibilityState==="visible"&&e&&!t)try{console.log("Page became visible, checking session..."),await zs()||(console.log("Session invalid after page became visible, redirecting to login"),r("/login",{replace:!0}))}catch(a){console.error("Error checking session on visibility change:",a),r("/login",{replace:!0})}};return document.addEventListener("visibilitychange",i),()=>document.removeEventListener("visibilitychange",i)},[e,t,r]),C.useEffect(()=>{const i=a=>{a.key==="supabase.auth.token"&&!a.newValue&&(console.log("Auth token removed from storage, redirecting to login"),r("/login",{replace:!0}))};return window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)},[r]),t?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Verifying authentication..."})]})}):e?u.jsx(u.Fragment,{children:n}):u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-gray-600",children:"Redirecting to login..."})})})},aR=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(null),[a,o]=C.useState(0),[l,d]=C.useState(!0),[h,f]=C.useState(3);C.useEffect(()=>{(async()=>{try{s(!0),i(null);const{data:w,error:b}=await se.from("google_reviews").select("*").eq("is_new",!1).order("review_date",{ascending:!1});if(b){console.error("Error fetching reviews:",b),i("Failed to load reviews");return}e(w||[])}catch(w){console.error("Reviews fetch error:",w),i("An unexpected error occurred")}finally{s(!1)}})()},[]),C.useEffect(()=>{const g=()=>{window.innerWidth>=1024?f(3):window.innerWidth>=768?f(2):f(1)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),C.useEffect(()=>{if(!l||n.length===0)return;const g=setInterval(()=>{o(w=>{const b=Math.max(0,n.length-h);return w>=b?0:w+1})},6e3);return()=>clearInterval(g)},[l,n.length,h]);const p=()=>{d(!1),o(g=>{const w=Math.max(0,n.length-h);return g<=0?w:g-1}),setTimeout(()=>d(!0),1e4)},m=()=>{d(!1),o(g=>{const w=Math.max(0,n.length-h);return g>=w?0:g+1}),setTimeout(()=>d(!0),1e4)},y=g=>{const w=new Date(g),k=new Date().getTime()-w.getTime(),E=Math.floor(k/(1e3*60*60*24)),N=Math.floor(E/30),j=Math.floor(E/365);return j>0?`${j} year${j>1?"s":""} ago`:N>0?`${N} month${N>1?"s":""} ago`:E>0?`${E} day${E>1?"s":""} ago`:"Today"},x=g=>Array.from({length:5},(w,b)=>u.jsx(Tp,{className:`h-4 w-4 ${b<g?"text-yellow-400 fill-current":"text-gray-300"}`},b)),_=g=>{const w=g.split(" ").map(b=>b.charAt(0)).join("").toUpperCase().slice(0,2);return u.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:w})};return t?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading Google Reviews..."})]}):r?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(si,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Reviews"}),u.jsx("p",{className:"text-gray-600",children:r})]}):n.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(Tp,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Reviews Available"}),u.jsx("p",{className:"text-gray-600",children:"Reviews will appear here once they are published."})]}):u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsxs("div",{className:"flex justify-center items-center mb-4",children:[u.jsx("div",{className:"flex",children:[...Array(5)].map((g,w)=>u.jsx(Tp,{className:"h-8 w-8 text-yellow-400 fill-current"},w))}),u.jsx("span",{className:"ml-3 text-2xl font-bold text-gray-900",children:"5.0"})]}),u.jsx("p",{className:"text-gray-600",children:"Based on Google Reviews"})]}),u.jsxs("div",{className:"relative overflow-hidden",children:[n.length>h&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:p,className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-white shadow-lg rounded-full p-3 hover:bg-gray-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Previous reviews",children:u.jsx(zd,{className:"h-6 w-6 text-gray-600"})}),u.jsx("button",{onClick:m,className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-white shadow-lg rounded-full p-3 hover:bg-gray-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Next reviews",children:u.jsx(Hd,{className:"h-6 w-6 text-gray-600"})})]}),u.jsx("div",{className:"px-12",children:u.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${a*(100/h)}%)`},children:n.map(g=>u.jsx("div",{className:"flex-shrink-0 px-3",style:{width:`${100/h}%`},children:u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 h-full hover:shadow-lg transition-shadow duration-200 border border-gray-100",children:[u.jsxs("div",{className:"flex items-start mb-4",children:[u.jsx("div",{className:"flex-shrink-0 mr-3",children:g.image_url?u.jsx("img",{src:g.image_url,alt:`${g.name}'s avatar`,className:"w-10 h-10 rounded-full object-cover",onError:w=>{const k=w.currentTarget.parentElement;k&&(k.innerHTML="",k.appendChild(_(g.name).props.children))}}):_(g.name)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:g.name}),g.review_count>1&&u.jsxs("p",{className:"text-sm text-gray-500",children:[g.review_count," reviews"]})]})]}),u.jsx("div",{className:"flex items-center mb-2",children:x(g.rating)}),u.jsx("p",{className:"text-sm text-gray-500 mb-3",children:y(g.review_date)}),u.jsx("p",{className:"text-gray-700 leading-relaxed mb-4 line-clamp-4",children:g.text}),u.jsxs("p",{className:"text-xs text-gray-500 border-t pt-3",children:["Review for ",g.company||"Aboriginal Training Services"]})]})},g.id))})})]}),n.length>h&&u.jsx("div",{className:"flex justify-center mt-6 space-x-2",children:Array.from({length:Math.ceil(n.length/h)},(g,w)=>u.jsx("button",{onClick:()=>{o(w),d(!1),setTimeout(()=>d(!0),1e4)},className:`w-3 h-3 rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${Math.floor(a/h)===w?"bg-blue-600":"bg-gray-300 hover:bg-gray-400"}`,"aria-label":`Go to slide ${w+1}`},w))}),u.jsx("style",{jsx:!0,children:`
        .line-clamp-4 {
          display: -webkit-box;
          -webkit-line-clamp: 4;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }
      `})]})},oR={Award:Wt,Shield:qd,Users:Gd,Plane:Dm,Triangle:eR,Cpu:BP,CheckCircle:Vt,Eye:nw,Target:rw,Leaf:VP,Zap:tR,Recycle:QP,Rocket:ZP,Globe:WP,Heart:Gd,Mountain:XP,Lightbulb:qP},lR=()=>{const[n,e]=C.useState(null),[t,s]=C.useState([]),[r,i]=C.useState([]),[a,o]=C.useState([]),[l,d]=C.useState([]),[h,f]=C.useState([]),[p,m]=C.useState([]),[y,x]=C.useState(null),[_,g]=C.useState([]),[w,b]=C.useState([]),[k,E]=C.useState({name:"",email:"",phone:"",message:"",newsletter:!1}),[N,j]=C.useState(""),[T,M]=C.useState(!1),[F,R]=C.useState(!1),[V,$]=C.useState(!1),[D,Z]=C.useState(!1),[B,I]=C.useState(new Set);C.useEffect(()=>{},[]),C.useEffect(()=>{(async()=>{try{const{data:X}=await se.from("home_page_title_section").select("*").single();X&&e(X);const{data:he}=await se.from("home_numbers").select("*").order("order_index",{ascending:!0});if(he){const FE=he.map(zg=>({number:zg.number,label:zg.description||zg.label}));s(FE)}const{data:le}=await se.from("choose_ats").select("*").order("order_index",{ascending:!0});le&&i(le);const{data:Lt}=await se.from("drone_solutions").select("*").order("order_index",{ascending:!0});Lt&&o(Lt);const{data:yl}=await se.from("principles").select("*").order("order_index",{ascending:!0});yl&&d(yl);const{data:Pa}=await se.from("heading").select("*").order("order_index",{ascending:!0});Pa&&f(Pa);const{data:di}=await se.from("ventures").select("*").order("order_index",{ascending:!0});di&&di.length>0?(console.log("Ventures data loaded:",di),m(di)):console.log("No ventures data found");const{data:vl}=await se.from("contact_information").select("*").single();vl&&x(vl);const{data:Su}=await se.from("contact_locations").select("*").order("order_index",{ascending:!0});Su&&g(Su);const{data:zf}=await se.from("student_success_stories").select("*").order("order_index",{ascending:!0});zf&&b(zf)}catch(X){console.error("Error fetching content:",X)}})()},[]);const P=(U,X="h-8 w-8")=>{const he=oR[U]||Wt;return u.jsx(he,{className:X})},O=U=>{const X=new Set(B);X.has(U)?X.delete(U):X.add(U),I(X)},L=U=>{const{name:X,value:he,type:le}=U.target;E(Lt=>({...Lt,[X]:le==="checkbox"?U.target.checked:he}))},H=async U=>{U.preventDefault(),$(!0);try{const{error:X}=await se.from("contact_messages").insert([{name:k.name,email:k.email,phone_number:k.phone||null,subscribe_to_newsletter:k.newsletter,message:k.message}]);if(X)throw X;Z(!0),setTimeout(()=>{Z(!1),E({name:"",email:"",phone:"",message:"",newsletter:!1})},3e3)}catch(X){console.error("Error saving contact message:",X),Z(!0),setTimeout(()=>{Z(!1),E({name:"",email:"",phone:"",message:"",newsletter:!1})},3e3)}finally{$(!1)}},G=async U=>{U.preventDefault(),M(!0);try{const{error:X}=await se.from("newsletter").insert([{email:N}]);X&&console.error("Error saving newsletter subscription:",X),R(!0),setTimeout(()=>{R(!1),j("")},3e3)}catch(X){console.error("Newsletter subscription error:",X),R(!0),setTimeout(()=>{R(!1),j("")},3e3)}finally{M(!1)}},ie=U=>Array.from({length:5},(X,he)=>u.jsx(Tp,{className:`h-4 w-4 ${he<U?"text-yellow-400 fill-current":"text-gray-300"}`},he));return u.jsxs("div",{className:"bg-white overflow-hidden",style:{scrollBehavior:"smooth"},children:[u.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[u.jsx("div",{className:"absolute top-20 left-10 w-4 h-4 bg-blue-200 rounded-full opacity-30 animate-pulse"}),u.jsx("div",{className:"absolute top-40 right-20 w-6 h-6 bg-blue-300 rounded-full opacity-20 animate-bounce"}),u.jsx("div",{className:"absolute bottom-40 left-20 w-3 h-3 bg-blue-400 rounded-full opacity-25 animate-ping"}),u.jsx("div",{className:"absolute bottom-20 right-10 w-5 h-5 bg-blue-200 rounded-full opacity-30 animate-pulse"})]}),u.jsxs("section",{className:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 text-white overflow-hidden",children:[(n==null?void 0:n.video_url)&&u.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden",children:u.jsx("video",{className:"absolute inset-0 w-full h-full object-cover min-w-full min-h-full",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:U=>{const X=U.currentTarget;X.style.display="none"},children:u.jsx("source",{src:n.video_url,type:"video/mp4"})})}),u.jsx("div",{className:"absolute inset-0 bg-black opacity-40"}),u.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 transform transition-all duration-1000 hover:scale-[1.02] z-10",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight animate-fade-in",children:(n==null?void 0:n.name)||"Professional Drone Academy"}),u.jsx("p",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl mb-4 text-blue-100 font-semibold",children:(n==null?void 0:n.text)||"Advocate, Encourage, and Unite Indigenous Peoples & Communities to lead the Drone Industry."}),u.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl mb-8 text-blue-200 max-w-3xl mx-auto leading-relaxed",children:(n==null?void 0:n.slogan)||"Training for the Future"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[u.jsxs(_e,{to:"/training",className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-xl flex items-center justify-center",children:["View Training",u.jsx(Ix,{className:"ml-2 h-5 w-5"})]}),u.jsx(_e,{to:"/indigenous-relations",className:"bg-transparent border-2 border-white hover:bg-white hover:text-blue-900 text-white px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"Our Heritage"})]})]})})]}),u.jsx("section",{className:"py-16 bg-gray-50 transform transition-all duration-500",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:t.map((U,X)=>u.jsxs("div",{className:"text-center transform transition-all duration-500 hover:scale-110 hover:shadow-lg bg-white rounded-xl p-6",children:[u.jsx("div",{className:"text-3xl md:text-4xl font-bold text-blue-700 mb-2",children:U.number}),u.jsx("div",{className:"text-gray-600 font-medium",children:U.label})]},X))})})}),u.jsx("section",{className:"py-20 transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Why Choose Aboriginal Training Services?"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"We combine cutting-edge drone technology training with Indigenous values of respect, responsibility, and excellence in education."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((U,X)=>u.jsxs("div",{className:"text-center group transform transition-all duration-500 hover:scale-105",children:[u.jsx("div",{className:"bg-blue-50 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-6 group-hover:bg-blue-100 transition-all duration-300 group-hover:shadow-lg",children:P(U.symbol,"h-8 w-8 text-blue-600")}),u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:U.name}),u.jsx("p",{className:"text-gray-600 leading-relaxed",children:U.text})]},X))})]})}),u.jsx("section",{className:"py-20 bg-gray-50 transform transition-all duration-500",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[u.jsxs("div",{className:"transform transition-all duration-500 hover:scale-105",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:"Comprehensive Drone Solutions"}),u.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"From beginner training to advanced commercial and industrial operations, we provide complete drone solutions for individuals, businesses, government organizations, and Indigenous communities across Canada."}),u.jsx("ul",{className:"space-y-4 mb-8",children:a.map((U,X)=>u.jsxs("li",{className:"flex items-center transform transition-all duration-300 hover:translate-x-2",children:[P(U.symbol,"h-6 w-6 text-green-500 mr-3"),u.jsx("span",{className:"text-gray-700",children:U.text})]},X))}),u.jsxs(_e,{to:"/training",className:"bg-blue-700 hover:bg-blue-800 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg inline-flex items-center",children:["Explore Training",u.jsx(Ix,{className:"ml-2 h-5 w-5"})]})]}),u.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg transform transition-all duration-500 hover:scale-105 hover:shadow-2xl",children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Ready to Get Started?"}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(_e,{to:"/training",className:"block w-full bg-blue-600 hover:bg-blue-700 text-white text-center py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"Browse Training Courses"}),u.jsx(_e,{to:"/indigenous-relations",className:"block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 text-center py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"Learn Our Story"}),u.jsx("a",{href:"#contact",className:"block w-full border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white text-center py-3 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"Contact Us"})]})]})]})})}),u.jsx("section",{className:"py-20 bg-white transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Our Vision & Mission"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Guiding principles that drive our commitment to Indigenous excellence in drone technology, innovation and education."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:l.map((U,X)=>{const he=B.has(U.title),le=U.symbol||"Award";return u.jsx("div",{className:"relative h-80 perspective-1000",children:u.jsxs("div",{className:`relative w-full h-full transition-transform duration-700 transform-style-preserve-3d ${he?"rotate-y-180":""}`,children:[u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden cursor-pointer",onClick:()=>O(U.title),children:u.jsx("div",{className:"rounded-xl shadow-lg h-full flex items-center justify-center transform transition-all duration-500 hover:scale-105 hover:shadow-2xl",style:{background:U.color?`linear-gradient(135deg, ${U.color}, ${U.color}dd)`:"linear-gradient(135deg, #2563eb, #1d4ed8)"},children:u.jsxs("div",{className:"text-center text-white",children:[P(le,"h-16 w-16 mx-auto mb-4"),u.jsx("h3",{className:"text-3xl font-bold",children:U.title||"Principle"}),u.jsx("p",{className:"text-blue-100 mt-2",children:"Click to reveal"})]})})}),u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 cursor-pointer",onClick:()=>O(U.title),children:u.jsx("div",{className:"bg-white border-2 rounded-xl shadow-lg h-full flex items-center justify-center p-8 transform transition-all duration-500 hover:shadow-2xl",style:{borderColor:U.color||"#3b82f6"},children:u.jsxs("div",{className:"text-center",children:[u.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Our ",U.title||"Principle"]}),u.jsx("p",{className:"text-lg text-gray-700 leading-relaxed",children:U.text||"Description coming soon."})]})})})]})},X)})})]})}),u.jsx("section",{className:"py-20 bg-gray-50 transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Where We Are Heading"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Our commitment to building a sustainable future through Indigenous leadership in technology, land & environmental stewardship."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:h.map((U,X)=>u.jsx("div",{className:"relative bg-white rounded-xl shadow-lg overflow-hidden transform transition-all duration-500 hover:scale-105 hover:shadow-2xl",children:u.jsxs("div",{className:"relative h-48 sm:h-56 md:h-64 overflow-hidden",children:[U.video_url?u.jsx("video",{className:"absolute inset-0 w-full h-full object-cover",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:he=>{const le=he.currentTarget;le.style.display="none";const Lt=le.parentElement;Lt&&Lt.classList.add("bg-gradient-to-br","from-blue-600","to-blue-800")},children:u.jsx("source",{src:U.video_url,type:"video/mp4"})}):u.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 to-blue-800"}),u.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40"}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("div",{className:"text-center text-white p-4 sm:p-6",children:[u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 backdrop-blur-sm",children:P(U.symbol,"h-6 w-6 text-white")}),u.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-2 drop-shadow-lg",children:U.title}),u.jsx("p",{className:"text-xs sm:text-sm text-gray-100 drop-shadow-md leading-tight",children:U.text})]})})]})},X))})]})}),u.jsx("section",{className:"py-20 bg-white transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Group of Ventures"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Strategic partnerships with industry leaders to provide comprehensive drone solutions, advanced training programs, and innovative technology development."})]}),p.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading ventures..."})]}):u.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-12",children:p.map((U,X)=>u.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden transform transition-all duration-500 hover:scale-105 hover:shadow-2xl",children:u.jsxs("div",{className:"md:flex",children:[u.jsxs("div",{className:"md:w-1/3 p-8 bg-gradient-to-br from-blue-50 to-blue-100",children:[u.jsx("div",{className:"flex items-center justify-center h-32 mb-6",children:U.logo_url?u.jsx("img",{src:U.logo_url,alt:`${U.name} logo`,className:"max-h-20 max-w-full object-contain transform transition-all duration-300 hover:scale-110",onError:he=>{he.currentTarget.style.display="none"}}):u.jsx("div",{className:"w-20 h-20 bg-blue-200 rounded-lg flex items-center justify-center",children:u.jsx("span",{className:"text-blue-600 font-bold text-lg",children:U.name.charAt(0)})})}),u.jsxs("div",{className:"text-center",children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:U.name}),U.relationship&&u.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:U.relationship})]})]}),u.jsxs("div",{className:"md:w-2/3 p-8",children:[U.text&&u.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed",children:U.text}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:u.jsxs("a",{href:`https://${U.name.toLowerCase().replace(/\s+/g,"")}.com`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-700 hover:bg-blue-800 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 inline-flex items-center justify-center",children:["Visit Website",u.jsx(zP,{className:"ml-2 h-4 w-4"})]})})]})]})},X))})]})}),u.jsx("section",{id:"contact",className:"py-20 bg-gray-50 transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Contact Information"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Get in touch with our team for course information, training enrollment, or any questions about drone technology and certification."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-16",children:[y&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center transform transition-all duration-500 hover:scale-105 hover:shadow-xl",children:[u.jsx("div",{className:"bg-blue-50 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:u.jsx(Vd,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Phone"}),u.jsx("p",{className:"text-blue-700 font-medium mb-2",children:y.phone}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Call us for immediate assistance"})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center transform transition-all duration-500 hover:scale-105 hover:shadow-xl",children:[u.jsx("div",{className:"bg-blue-50 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:u.jsx(Mg,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Email"}),u.jsx("p",{className:"text-blue-700 font-medium mb-2",children:y.email}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Send us an email anytime"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center transform transition-all duration-500 hover:scale-105 hover:shadow-xl",children:[u.jsx("div",{className:"bg-blue-50 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:u.jsx(Vl,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Locations"}),u.jsx("div",{className:"text-blue-700 font-medium mb-2 space-y-1",children:_.map((U,X)=>u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx(Vl,{className:"h-4 w-4 mr-1"}),u.jsx("span",{children:U.location_name})]},X))}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Global training presence"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 transform transition-all duration-500 hover:shadow-2xl",children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Send Us a Message"}),D?u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Vt,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),u.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Message Sent Successfully!"}),u.jsx("p",{className:"text-gray-600",children:"Thank you for contacting us. We'll respond within 24 hours."})]}):u.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),u.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:k.name,onChange:L,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300",placeholder:"Enter your full name"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),u.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:k.email,onChange:L,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300",placeholder:"Enter your email"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),u.jsx("input",{type:"tel",id:"phone",name:"phone",value:k.phone,onChange:L,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300",placeholder:"Enter your phone number"})]}),u.jsx("div",{children:u.jsxs("label",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",name:"newsletter",checked:k.newsletter,onChange:L,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),u.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Subscribe to newsletter"})]})}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),u.jsx("textarea",{id:"message",name:"message",rows:4,required:!0,value:k.message,onChange:L,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300",placeholder:"Tell us about your inquiry or training needs..."})]}),u.jsx("div",{className:"md:col-span-2",children:u.jsx("button",{type:"submit",disabled:V,className:`w-full py-4 px-6 rounded-lg font-semibold text-lg transition-all duration-300 transform hover:scale-105 flex items-center justify-center ${V?"bg-gray-400 cursor-not-allowed":"bg-blue-700 hover:bg-blue-800 text-white hover:shadow-lg"}`,children:V?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Sending..."]}):u.jsxs(u.Fragment,{children:[u.jsx(EA,{className:"mr-2 h-5 w-5"}),"Send Message"]})})})]})]})]})}),u.jsx("section",{className:"py-20 bg-white",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"What Our Students Say on Google"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Read authentic reviews from our training program graduates and see why we maintain a 5-star rating on Google Reviews."})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8 transform transition-all duration-500 hover:shadow-2xl",children:u.jsx(aR,{})})]})}),u.jsx("section",{className:"py-20 bg-gray-50 transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Student Success Stories"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Real testimonials from graduates who have advanced their careers through professional RPAS training at Aboriginal Training Services."})]}),u.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:w.map((U,X)=>u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 transform transition-all duration-500 hover:scale-105 hover:shadow-2xl",children:[u.jsxs("div",{className:"flex items-center mb-6",children:[u.jsx("img",{src:U.photo_url,alt:U.name,className:"h-16 w-16 rounded-full object-cover mr-4"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:U.name}),u.jsx("p",{className:"text-blue-700 font-medium",children:U.position}),u.jsx("p",{className:"text-gray-600 text-sm",children:U.company})]})]}),u.jsx("div",{className:"flex mb-4",children:ie(U.rating)}),u.jsxs("div",{className:"relative",children:[u.jsx(YP,{className:"absolute top-0 left-0 h-8 w-8 text-blue-200 -mt-2 -ml-2"}),u.jsx("p",{className:"text-gray-700 italic leading-relaxed pl-6",children:U.text})]})]},X))})]})}),u.jsx("section",{className:"py-20 bg-blue-900 text-white transform transition-all duration-500",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6",children:"Start Your RPAS Career Today"}),u.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-3xl mx-auto",children:"Join hundreds of successful graduates who have launched their careers in the rapidly growing RPAS industry."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[u.jsx("a",{href:"https://calendar.google.com/calendar/appointments/schedules/AcZssZ2bz2nYWBjGWvZBrsOogdaD5_c4M5O0tPpz_Rt9nhc8WM5TvyzpLQY2cdvQaUiQHHko4HW6gjON?gv=true",target:"_blank",rel:"noopener noreferrer",className:"bg-white text-blue-900 hover:bg-gray-100 px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"Book An Appointment"}),u.jsx(_e,{to:"/training",className:"border-2 border-white hover:bg-white hover:text-blue-900 px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-300 transform hover:scale-105",children:"View Course Catalog"})]})]})}),u.jsx("section",{className:"py-16 bg-gray-100",children:u.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Subscribe to Our Newsletter"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Stay updated with the latest RPAS technology news, training opportunities, and industry insights."}),F?u.jsxs("div",{className:"py-4",children:[u.jsx(Vt,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Successfully Subscribed!"}),u.jsx("p",{className:"text-gray-600",children:"Thank you for subscribing to our newsletter."})]}):u.jsxs("form",{onSubmit:G,className:"flex flex-col sm:flex-row gap-4 max-w-md mx-auto",children:[u.jsx("input",{type:"email",value:N,onChange:U=>j(U.target.value),placeholder:"Enter your email address",required:!0,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),u.jsx("button",{type:"submit",disabled:T,className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${T?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-700 hover:bg-blue-800 text-white transform hover:scale-105"}`,children:T?"Subscribing...":"Subscribe"})]})]})})}),u.jsx("style",{jsx:!0,children:`
        .perspective-1000 {
          perspective: 1000px;
        }
        .transform-style-preserve-3d {
          transform-style: preserve-3d;
        }
        .backface-hidden {
          backface-visibility: hidden;
        }
        .rotate-y-180 {
          transform: rotateY(180deg);
        }
      `})]})},cR=()=>{const[n,e]=C.useState([]),[t,s]=C.useState([]),[r,i]=C.useState(!0),[a,o]=C.useState(new Set),[l,d]=C.useState({}),[h,f]=C.useState(new Set),[p,m]=C.useState(new Set),[y,x]=C.useState(null),{user:_}=ml(),g=Ca();C.useEffect(()=>{w(),_&&b()},[_]);const w=async()=>{try{const{data:R,error:V}=await se.from("courses_ats").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(V)throw V;e(R||[])}catch(R){console.error("Error fetching courses:",R),x({type:"error",text:"Failed to load courses"})}finally{i(!1)}},b=async()=>{if(_)try{const{data:R,error:V}=await se.from("enrollments").select("*").eq("student_id",_.id);if(V)throw V;s(R||[])}catch(R){console.error("Error fetching enrollments:",R)}},k=async R=>{if(!l[R]){f(V=>new Set(V).add(R));try{const{data:V,error:$}=await se.from("courses_ats").select("*").eq("id",R).single();if($)throw $;d(D=>({...D,[R]:V}))}catch(V){console.error("Error fetching course details:",V),x({type:"error",text:"Failed to load course details"})}finally{f(V=>{const $=new Set(V);return $.delete(R),$})}}},E=async R=>{a.has(R)?o(V=>{const $=new Set(V);return $.delete(R),$}):(await k(R),o(V=>new Set(V).add(R)))},N=async R=>{if(!_){g("/login");return}if(t.some($=>$.course_id===R)){x({type:"error",text:"You are already registered for this course"});return}m($=>new Set($).add(R));try{const{error:$}=await se.from("enrollments").insert({student_id:_.id,course_id:R});if($)throw $;x({type:"success",text:"You have been registered for this course."}),await b()}catch($){console.error("Error registering for course:",$),x({type:"error",text:"Failed to register for course"})}finally{m($=>{const D=new Set($);return D.delete(R),D})}},j=R=>t.some(V=>V.course_id===R),T=R=>{if(!R)return null;try{if(typeof R=="string"){const V=JSON.parse(R);if(Array.isArray(V))return V}else if(Array.isArray(R))return R}catch(V){console.error("Error parsing whats_included:",V)}return null},M=(R,V)=>R?`${V||"USD"} $${R.toLocaleString()}`:"Contact for pricing",F=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"TBD";return r?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsx(bs,{className:"w-8 h-8 animate-spin text-blue-600"})}):u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Training Courses"}),u.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Advance your career with our comprehensive training programs designed for professionals in various industries."})]})})}),y&&u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:u.jsx("div",{className:`p-4 rounded-md ${y.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:y.text})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:n.map(R=>{const V=a.has(R.id),$=l[R.id],D=h.has(R.id),Z=p.has(R.id),B=j(R.id);return u.jsx("div",{className:"relative h-96 perspective-1000",children:u.jsxs("div",{className:`relative w-full h-full transition-transform duration-700 transform-style-preserve-3d ${V?"rotate-y-180":""}`,children:[u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden bg-white rounded-lg shadow-lg overflow-hidden",children:u.jsxs("div",{className:"p-6 h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${R.type==="regulation"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:R.type==="regulation"?"Regulation":"Application"}),B&&u.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[u.jsx(Wt,{className:"w-3 h-3 mr-1"}),"Enrolled"]})]}),u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:R.title}),u.jsxs("div",{className:"space-y-2 mb-6",children:[R.duration&&u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(gu,{className:"w-4 h-4 mr-2"}),R.duration]}),R.max_students&&u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(Gd,{className:"w-4 h-4 mr-2"}),"Max ",R.max_students," students"]}),R.start_date&&u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(sw,{className:"w-4 h-4 mr-2"}),F(R.start_date)]}),R.price&&u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(UP,{className:"w-4 h-4 mr-2"}),M(R.price,R.currency)]})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsxs("button",{onClick:()=>E(R.id),className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200 flex items-center justify-center","aria-label":`Learn more about ${R.title}`,children:[u.jsx(cn,{className:"w-4 h-4 mr-2"}),"Learn More"]}),u.jsx("button",{onClick:()=>N(R.id),disabled:B||Z,className:`flex-1 px-4 py-2 rounded-md transition-colors duration-200 flex items-center justify-center ${B?"bg-green-100 text-green-800 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,"aria-label":B?"Already registered":`Register for ${R.title}`,children:Z?u.jsx(bs,{className:"w-4 h-4 animate-spin"}):B?"Enrolled":u.jsxs(u.Fragment,{children:[u.jsx(Hd,{className:"w-4 h-4 mr-2"}),"Register Now"]})})]})]})}),u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 bg-white rounded-lg shadow-lg overflow-hidden",children:u.jsx("div",{className:"p-6 h-full overflow-y-auto",children:D?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx(bs,{className:"w-8 h-8 animate-spin text-blue-600"})}):$?u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:$.title}),$.description&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Description"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.description})]}),$.level&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Level"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.level})]}),$.age_requirement&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Age Requirement"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.age_requirement})]}),$.experience_requirement&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Experience Required"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.experience_requirement})]}),$.equipment_requirement&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Equipment Required"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.equipment_requirement})]}),$.document_requirement&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Documents Required"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.document_requirement})]}),$.suggested_preparation&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Suggested Preparation"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.suggested_preparation})]}),$.price&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Price"}),u.jsx("p",{className:"text-sm text-gray-600",children:M($.price,$.currency)})]}),$.duration&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Duration"}),u.jsx("p",{className:"text-sm text-gray-600",children:$.duration})]}),$.start_date&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Start Date"}),u.jsx("p",{className:"text-sm text-gray-600",children:F($.start_date)})]}),$.whats_included&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"What's Included"}),(()=>{const I=T($.whats_included);return I?u.jsx("ul",{className:"text-sm text-gray-600 list-disc list-inside space-y-1",children:I.map((P,O)=>u.jsx("li",{children:P},O))}):u.jsx("p",{className:"text-sm text-gray-600",children:"Information not available"})})()]}),u.jsx("button",{onClick:()=>E(R.id),className:"w-full mt-6 bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200","aria-label":"Back to course summary",children:"Back to Summary"})]}):u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("p",{className:"text-gray-500",children:"Failed to load course details"})})})})]})},R.id)})}),n.length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx(cn,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No courses available"}),u.jsx("p",{className:"text-gray-500",children:"Check back later for new training opportunities."})]})]})]})},uR=()=>{const[n,e]=C.useState(null),[t,s]=C.useState([]),[r,i]=C.useState([]),[a,o]=C.useState([]),[l,d]=C.useState([]),[h,f]=C.useState([]),[p,m]=C.useState(!0),[y,x]=C.useState(null),[_,g]=C.useState(0),[w,b]=C.useState(new Set);C.useEffect(()=>{const E=setInterval(()=>{g(N=>N+1)},3e4);return()=>clearInterval(E)},[]),C.useEffect(()=>{(async()=>{try{m(!0),x(null);const{data:N,error:j}=await se.from("indigenous_title_section").select("*").single();j&&j.code!=="PGRST116"?console.error("Error fetching title section:",j):N&&e(N);const{data:T,error:M}=await se.from("indigenous_values").select("*").order("order_index",{ascending:!0});M?console.error("Error fetching values:",M):s(T||[]);const{data:F,error:R}=await se.from("indigenous_technology").select("*").order("order_index",{ascending:!0});R?console.error("Error fetching technology:",R):i(F||[]);const{data:V,error:$}=await se.from("indigenous_heritage").select("*").order("order_index",{ascending:!0});$?console.error("Error fetching heritage:",$):o(V||[]);const{data:D,error:Z}=await se.from("indigenous_applications").select("*").order("order_index",{ascending:!0});Z?console.error("Error fetching applications:",Z):d(D||[]);const{data:B,error:I}=await se.from("indigenous_commitments").select("*").order("order_index",{ascending:!0});I?console.error("Error fetching commitments:",I):f(B||[])}catch(N){console.error("Error fetching content:",N),x("Failed to load page content. Please try again later.")}finally{m(!1)}})()},[]);const k=E=>{const N=new Set(w);N.has(E)?N.delete(E):N.add(E),b(N)};return p?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading Indigenous Relations content..."})]})}):y?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(FP,{className:"h-16 w-16 text-red-400 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Content"}),u.jsx("p",{className:"text-gray-600 mb-8",children:y}),u.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200",children:"Try Again"})]})}):u.jsxs("div",{className:"min-h-screen overflow-hidden relative",children:[u.jsxs("div",{className:"fixed inset-0 overflow-hidden",children:[u.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-700",children:[u.jsxs("div",{className:"absolute inset-0 opacity-30",children:[u.jsx("div",{className:"river-flow-1"}),u.jsx("div",{className:"river-flow-2"}),u.jsx("div",{className:"river-flow-3"})]}),u.jsxs("div",{className:"absolute inset-0 opacity-20",children:[u.jsx("div",{className:"ripple ripple-1"}),u.jsx("div",{className:"ripple ripple-2"}),u.jsx("div",{className:"ripple ripple-3"})]})]}),u.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[u.jsx("div",{className:"floating-symbol tipi-1",children:u.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 100 100",className:"text-amber-200 opacity-60",children:[u.jsx("path",{d:"M50 10 L20 80 L80 80 Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M50 10 L50 80",stroke:"currentColor",strokeWidth:"1"}),u.jsx("circle",{cx:"35",cy:"65",r:"3",fill:"currentColor"}),u.jsx("circle",{cx:"65",cy:"65",r:"3",fill:"currentColor"})]})}),u.jsx("div",{className:"floating-symbol tipi-2",children:u.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 100 100",className:"text-yellow-200 opacity-50",children:[u.jsx("path",{d:"M50 15 L25 75 L75 75 Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M50 15 L50 75",stroke:"currentColor",strokeWidth:"1"}),u.jsx("circle",{cx:"40",cy:"60",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"60",cy:"60",r:"2",fill:"currentColor"})]})}),u.jsx("div",{className:"floating-symbol tipi-3",children:u.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 100 100",className:"text-orange-200 opacity-40",children:[u.jsx("path",{d:"M50 20 L30 70 L70 70 Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M50 20 L50 70",stroke:"currentColor",strokeWidth:"1"})]})}),u.jsx("div",{className:"floating-symbol feather-1",children:u.jsxs("svg",{width:"25",height:"45",viewBox:"0 0 50 90",className:"text-white opacity-40",children:[u.jsx("path",{d:"M25 5 Q15 20 20 35 Q30 25 25 45 Q35 35 30 55 Q20 45 25 65 Q35 55 30 75 L25 85",fill:"none",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M25 15 Q20 20 15 25",fill:"none",stroke:"currentColor",strokeWidth:"1"}),u.jsx("path",{d:"M25 25 Q30 30 35 35",fill:"none",stroke:"currentColor",strokeWidth:"1"}),u.jsx("path",{d:"M25 35 Q20 40 15 45",fill:"none",stroke:"currentColor",strokeWidth:"1"}),u.jsx("path",{d:"M25 45 Q30 50 35 55",fill:"none",stroke:"currentColor",strokeWidth:"1"})]})}),u.jsx("div",{className:"floating-symbol feather-2",children:u.jsxs("svg",{width:"20",height:"35",viewBox:"0 0 50 90",className:"text-blue-200 opacity-30",children:[u.jsx("path",{d:"M25 10 Q18 25 22 40 Q28 30 25 50 Q32 40 28 60 Q22 50 25 70 L25 80",fill:"none",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M25 20 Q22 25 18 30",fill:"none",stroke:"currentColor",strokeWidth:"1"}),u.jsx("path",{d:"M25 40 Q28 45 32 50",fill:"none",stroke:"currentColor",strokeWidth:"1"})]})}),u.jsx("div",{className:"floating-symbol dreamcatcher-1",children:u.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 100 100",className:"text-purple-200 opacity-50",children:[u.jsx("circle",{cx:"50",cy:"50",r:"30",fill:"none",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M50 20 L50 80 M20 50 L80 50 M35 35 L65 65 M65 35 L35 65",stroke:"currentColor",strokeWidth:"1",opacity:"0.7"}),u.jsx("circle",{cx:"50",cy:"50",r:"8",fill:"none",stroke:"currentColor",strokeWidth:"1"}),u.jsx("path",{d:"M50 80 L45 90 L50 85 L55 90 Z",fill:"currentColor"}),u.jsx("path",{d:"M35 75 L30 85 L35 80 L40 85 Z",fill:"currentColor"})]})}),u.jsx("div",{className:"floating-symbol dreamcatcher-2",children:u.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 100 100",className:"text-pink-200 opacity-40",children:[u.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"none",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M50 25 L50 75 M25 50 L75 50",stroke:"currentColor",strokeWidth:"1",opacity:"0.6"}),u.jsx("circle",{cx:"50",cy:"50",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"1"})]})}),u.jsx("div",{className:"floating-symbol arrow-1",children:u.jsxs("svg",{width:"40",height:"15",viewBox:"0 0 100 40",className:"text-green-200 opacity-45",children:[u.jsx("path",{d:"M10 20 L80 20 M70 10 L80 20 L70 30",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),u.jsx("path",{d:"M15 15 L25 20 L15 25",fill:"none",stroke:"currentColor",strokeWidth:"2"})]})}),u.jsx("div",{className:"floating-symbol arrow-2",children:u.jsx("svg",{width:"30",height:"12",viewBox:"0 0 100 40",className:"text-teal-200 opacity-35",children:u.jsx("path",{d:"M15 20 L75 20 M65 12 L75 20 L65 28",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsx("div",{className:"floating-symbol sun-1",children:u.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 100 100",className:"text-yellow-300 opacity-60",children:[u.jsx("circle",{cx:"50",cy:"50",r:"20",fill:"currentColor"}),u.jsxs("g",{stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[u.jsx("path",{d:"M50 10 L50 20 M50 80 L50 90 M10 50 L20 50 M80 50 L90 50"}),u.jsx("path",{d:"M25 25 L32 32 M68 68 L75 75 M75 25 L68 32 M32 68 L25 75"})]})]})}),u.jsx("div",{className:"floating-symbol sun-2",children:u.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 100 100",className:"text-orange-300 opacity-45",children:[u.jsx("circle",{cx:"50",cy:"50",r:"15",fill:"currentColor"}),u.jsx("g",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:u.jsx("path",{d:"M50 15 L50 25 M50 75 L50 85 M15 50 L25 50 M75 50 L85 50"})})]})}),u.jsx("div",{className:"floating-symbol mountain-1",children:u.jsxs("svg",{width:"45",height:"25",viewBox:"0 0 100 50",className:"text-gray-300 opacity-50",children:[u.jsx("path",{d:"M10 40 L30 15 L50 25 L70 10 L90 40 Z",fill:"currentColor"}),u.jsx("path",{d:"M25 20 L35 30 M60 15 L75 35",stroke:"currentColor",strokeWidth:"1",opacity:"0.7"})]})}),u.jsx("div",{className:"floating-symbol mountain-2",children:u.jsx("svg",{width:"35",height:"20",viewBox:"0 0 100 50",className:"text-slate-300 opacity-40",children:u.jsx("path",{d:"M15 35 L35 20 L55 30 L75 15 L85 35 Z",fill:"currentColor"})})}),u.jsx("div",{className:"floating-symbol paw-1",children:u.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 100 100",className:"text-brown-200 opacity-45",children:[u.jsx("circle",{cx:"30",cy:"25",r:"8",fill:"currentColor"}),u.jsx("circle",{cx:"70",cy:"25",r:"8",fill:"currentColor"}),u.jsx("circle",{cx:"25",cy:"50",r:"6",fill:"currentColor"}),u.jsx("circle",{cx:"75",cy:"50",r:"6",fill:"currentColor"}),u.jsx("ellipse",{cx:"50",cy:"65",rx:"15",ry:"20",fill:"currentColor"})]})}),u.jsx("div",{className:"floating-symbol paw-2",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 100 100",className:"text-amber-300 opacity-35",children:[u.jsx("circle",{cx:"35",cy:"30",r:"6",fill:"currentColor"}),u.jsx("circle",{cx:"65",cy:"30",r:"6",fill:"currentColor"}),u.jsx("circle",{cx:"30",cy:"55",r:"5",fill:"currentColor"}),u.jsx("circle",{cx:"70",cy:"55",r:"5",fill:"currentColor"}),u.jsx("ellipse",{cx:"50",cy:"70",rx:"12",ry:"15",fill:"currentColor"})]})})]},_),u.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[0.5px]"})]}),u.jsxs("div",{className:"relative min-h-screen",style:{zIndex:10},children:[u.jsx("section",{className:"relative py-20 sm:py-24 md:py-32",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 transform transition-all duration-1000 hover:scale-[1.02] z-10",children:u.jsxs("div",{className:"text-center",children:[(n==null?void 0:n.video_url)&&u.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden rounded-xl",children:u.jsx("video",{className:"absolute inset-0 w-full h-full object-cover min-w-full min-h-full",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:E=>{const N=E.currentTarget;N.style.display="none"},children:u.jsx("source",{src:n.video_url,type:"video/mp4"})})}),u.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold mb-4 sm:mb-6 leading-tight text-white drop-shadow-2xl",children:[(n==null?void 0:n.name)||"Indigenous Relations",u.jsx("span",{className:"block text-green-300",children:"& Modern Technology"})]}),u.jsx("p",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl mb-3 sm:mb-4 text-blue-200 font-semibold drop-shadow-xl",children:(n==null?void 0:n.text)||"Keepers of the land, keepers of the data, and keepers of the environment"}),u.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl mb-6 sm:mb-8 text-white max-w-4xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 sm:p-6 shadow-2xl border border-white/20",children:(n==null?void 0:n.slogan)||"Honoring Indigenous values while advancing RPAS technology for environmental protection, community service, and cultural preservation."})]})})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 drop-shadow-2xl",children:"Our Core Values"}),u.jsx("p",{className:"text-lg sm:text-xl text-white max-w-3xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 shadow-2xl border border-white/20",children:"Indigenous principles that guide our approach to RPAS technology and environmental stewardship."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8",children:t.map((E,N)=>{const j=w.has(E.title);return u.jsx("div",{className:"relative h-80 perspective-1000",children:u.jsxs("div",{className:`relative w-full h-full transition-transform duration-700 transform-style-preserve-3d ${j?"rotate-y-180":""}`,children:[u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden cursor-pointer",onClick:()=>k(E.title),children:u.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl shadow-lg h-full flex flex-col items-center justify-center transform transition-all duration-500 hover:scale-105 hover:shadow-2xl text-white p-6",children:[E.logo_url&&u.jsx("div",{className:"mb-4 overflow-hidden rounded-lg",children:u.jsx("img",{src:E.logo_url,alt:E.title,className:"w-16 h-16 object-cover transform transition-all duration-300 hover:scale-110",onError:T=>{T.currentTarget.style.display="none"}})}),E.video_url&&u.jsx("div",{className:"mb-4 w-full max-w-xs",children:u.jsx("video",{className:"w-full h-32 object-cover rounded-lg",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:T=>{T.currentTarget.style.display="none"},children:u.jsx("source",{src:E.video_url,type:"video/mp4"})})}),u.jsx("h3",{className:"text-2xl font-bold mb-2 text-center",children:E.title}),u.jsx("p",{className:"text-blue-100 text-center",children:"Click to reveal"})]})}),u.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 cursor-pointer",onClick:()=>k(E.title),children:u.jsx("div",{className:"bg-white border-2 border-blue-200 rounded-xl shadow-lg h-full flex flex-col justify-center p-6 transform transition-all duration-500 hover:shadow-2xl",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:E.title}),E.text&&u.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:E.text}),E.saying&&u.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:u.jsxs("p",{className:"text-blue-800 italic font-medium text-sm",children:['"',E.saying,'"']})})]})})})]})},N)})})]})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 drop-shadow-2xl",children:"Cultural Integration in Technology"}),u.jsx("p",{className:"text-lg sm:text-xl text-white max-w-3xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 shadow-2xl border border-white/20",children:"How we blend traditional Indigenous knowledge with modern RPAS technology to create respectful and effective solutions."})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-8",children:r.map((E,N)=>u.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-xl shadow-2xl overflow-hidden transform transition-all duration-500 hover:scale-105 hover:shadow-3xl border-2 border-white/50",children:[u.jsx("div",{className:"relative h-32 sm:h-48 overflow-hidden",children:E.video_url?u.jsx("video",{className:"absolute inset-0 w-full h-full object-cover",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:j=>{j.currentTarget.style.display="none";const T=j.currentTarget.parentElement;if(T&&E.image_url){const M=document.createElement("img");M.src=E.image_url,M.alt=E.title,M.className="w-full h-full object-cover transform transition-all duration-500 hover:scale-110",T.appendChild(M)}},children:u.jsx("source",{src:E.video_url,type:"video/mp4"})}):E.image_url?u.jsx("img",{src:E.image_url,alt:E.title,className:"w-full h-full object-cover transform transition-all duration-500 hover:scale-110",onError:j=>{j.currentTarget.style.display="none"}}):u.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-600 to-blue-800"})}),u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-3 sm:mb-4",children:E.title}),E.text&&u.jsx("p",{className:"text-gray-600 leading-relaxed text-sm sm:text-base",children:E.text})]})]},N))})]})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 drop-shadow-2xl",children:"Indigenous Heritage Elements"}),u.jsx("p",{className:"text-lg sm:text-xl text-white max-w-3xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 shadow-2xl border border-white/20",children:"The foundational principles that guide our work and shape our approach to technology."})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:a.map((E,N)=>u.jsxs("div",{className:"bg-white/90 backdrop-blur-xl rounded-xl shadow-2xl p-4 sm:p-6 text-center transform transition-all duration-500 hover:scale-105 hover:shadow-3xl border-2 border-white/50",children:[E.logo_url&&u.jsx("div",{className:"mb-4",children:u.jsx("img",{src:E.logo_url,alt:E.title,className:"w-12 h-12 mx-auto rounded-lg object-cover transform transition-all duration-300 hover:scale-110",onError:j=>{j.currentTarget.style.display="none"}})}),E.video_url&&u.jsx("div",{className:"mb-4",children:u.jsx("video",{className:"w-full h-24 object-cover rounded-lg mx-auto",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:j=>{j.currentTarget.style.display="none"},children:u.jsx("source",{src:E.video_url,type:"video/mp4"})})}),u.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2 sm:mb-3",children:E.title}),E.text&&u.jsx("p",{className:"text-gray-700 text-xs sm:text-sm leading-relaxed",children:E.text})]},N))})]})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 drop-shadow-2xl",children:"Indigenous-Focused Applications"}),u.jsx("p",{className:"text-lg sm:text-xl text-white max-w-3xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 shadow-2xl border border-white/20",children:"Specific ways we apply RPAS technology to serve Indigenous communities and support cultural and environmental objectives."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8",children:l.map((E,N)=>u.jsxs("div",{className:"bg-white/95 backdrop-blur-xl border-2 border-white/50 rounded-xl shadow-2xl p-6 sm:p-8 transform transition-all duration-500 hover:scale-105 hover:shadow-3xl",children:[u.jsxs("div",{className:"flex items-center mb-4",children:[E.logo_url&&u.jsx("img",{src:E.logo_url,alt:E.title,className:"w-12 h-12 rounded-lg object-cover mr-4 transform transition-all duration-300 hover:scale-110",onError:j=>{j.currentTarget.style.display="none"}}),u.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900",children:E.title})]}),E.text&&u.jsx("p",{className:"text-gray-600 mb-4 sm:mb-6 leading-relaxed text-sm sm:text-base",children:E.text}),E.benefit_points&&E.benefit_points.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-gray-900 mb-2 sm:mb-3 text-sm sm:text-base",children:"Key Benefits:"}),u.jsx("ul",{className:"space-y-1 sm:space-y-2",children:E.benefit_points.map((j,T)=>u.jsxs("li",{className:"flex items-center text-xs sm:text-sm transform transition-all duration-300 hover:translate-x-2",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 sm:mr-3 flex-shrink-0"}),u.jsx("span",{className:"text-gray-700",children:j})]},T))})]})]},N))})]})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"text-center mb-8 sm:mb-12",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-4 sm:mb-6 text-white drop-shadow-2xl",children:"Our Commitment to Indigenous Communities"}),u.jsx("p",{className:"text-lg sm:text-xl text-white max-w-4xl mx-auto leading-relaxed bg-black/50 backdrop-blur-md rounded-lg p-4 shadow-2xl border border-white/20",children:"We pledge to operate with respect, transparency, and genuine partnership with Indigenous communities in all our technological endeavors."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8",children:h.map((E,N)=>u.jsxs("div",{className:"text-center transform transition-all duration-500 hover:scale-105 bg-white/95 backdrop-blur-xl rounded-xl p-6 sm:p-8 shadow-2xl border-2 border-white/50",children:[E.logo_url&&u.jsx("div",{className:"mb-4",children:u.jsx("img",{src:E.logo_url,alt:E.title,className:"w-16 h-16 mx-auto rounded-lg object-cover transform transition-all duration-300 hover:scale-110",onError:j=>{j.currentTarget.style.display="none"}})}),E.video_url&&u.jsx("div",{className:"mb-4",children:u.jsx("video",{className:"w-full h-32 object-cover rounded-lg mx-auto",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:j=>{j.currentTarget.style.display="none"},children:u.jsx("source",{src:E.video_url,type:"video/mp4"})})}),u.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 text-gray-900",children:E.title}),E.text&&u.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:E.text})]},N))})]})}),u.jsx("section",{className:"py-16 sm:py-20",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:u.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-3xl p-8 sm:p-12 border-2 border-white/50",children:[u.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 mb-4 sm:mb-6",children:"Join Us in Protecting Our Heritage"}),u.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-6 sm:mb-8 max-w-3xl mx-auto",children:"Learn how RPAS technology can serve your community while honoring Indigenous values and protecting the environment for future generations."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center",children:[u.jsxs("a",{href:"/#contact",className:"bg-blue-700 hover:bg-blue-800 text-white px-6 sm:px-8 py-3 sm:py-4 rounded-lg text-base sm:text-lg font-semibold transition-all duration-300 transform hover:scale-105 inline-flex items-center justify-center shadow-xl",children:["Start a Conversation",u.jsx(Ix,{className:"ml-2 h-4 sm:h-5 w-4 sm:w-5"})]}),u.jsx("a",{href:"/training",className:"border-2 border-blue-700 text-blue-700 hover:bg-blue-700 hover:text-white px-6 sm:px-8 py-3 sm:py-4 rounded-lg text-base sm:text-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-xl",children:"Explore Training"})]})]})})})]}),u.jsx("style",{jsx:!0,children:`
        /* River flowing animation */
        .river-flow-1, .river-flow-2, .river-flow-3 {
          position: absolute;
          width: 200%;
          height: 100%;
          background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(59, 130, 246, 0.3) 25%, 
            rgba(34, 197, 94, 0.2) 50%, 
            rgba(59, 130, 246, 0.3) 75%, 
            transparent 100%
          );
          animation: flow 20s linear infinite;
        }
        
        .river-flow-2 {
          animation-delay: -7s;
          animation-duration: 25s;
        }
        
        .river-flow-3 {
          animation-delay: -14s;
          animation-duration: 30s;
        }
        
        @keyframes flow {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(0%); }
        }
        
        /* Water ripples */
        .ripple {
          position: absolute;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
          animation: ripple 4s ease-out infinite;
        }
        
        .ripple-1 {
          width: 100px;
          height: 100px;
          top: 20%;
          left: 10%;
          animation-delay: 0s;
        }
        
        .ripple-2 {
          width: 150px;
          height: 150px;
          top: 60%;
          left: 70%;
          animation-delay: 2s;
        }
        
        .ripple-3 {
          width: 80px;
          height: 80px;
          top: 40%;
          left: 40%;
          animation-delay: 1s;
        }
        
        @keyframes ripple {
          0% {
            transform: scale(0);
            opacity: 1;
          }
          100% {
            transform: scale(4);
            opacity: 0;
          }
        }
        
        /* Floating symbols animations */
        .floating-symbol {
          position: absolute;
          animation: float 15s ease-in-out infinite;
        }
        
        /* Tipi positions and animations */
        .tipi-1 {
          top: 15%;
          left: -5%;
          animation: floatAcross 25s linear infinite;
          animation-delay: 0s;
        }
        
        .tipi-2 {
          top: 70%;
          left: -5%;
          animation: floatAcross 30s linear infinite;
          animation-delay: 8s;
        }
        
        .tipi-3 {
          top: 45%;
          left: -5%;
          animation: floatAcross 35s linear infinite;
          animation-delay: 15s;
        }
        
        /* Feather positions */
        .feather-1 {
          top: 25%;
          left: -3%;
          animation: floatAcross 28s linear infinite;
          animation-delay: 5s;
        }
        
        .feather-2 {
          top: 80%;
          left: -3%;
          animation: floatAcross 32s linear infinite;
          animation-delay: 12s;
        }
        
        /* Dreamcatcher positions */
        .dreamcatcher-1 {
          top: 35%;
          left: -4%;
          animation: floatAcross 26s linear infinite;
          animation-delay: 3s;
        }
        
        .dreamcatcher-2 {
          top: 60%;
          left: -4%;
          animation: floatAcross 29s linear infinite;
          animation-delay: 18s;
        }
        
        /* Arrow positions */
        .arrow-1 {
          top: 10%;
          left: -4%;
          animation: floatAcross 22s linear infinite;
          animation-delay: 7s;
        }
        
        .arrow-2 {
          top: 85%;
          left: -3%;
          animation: floatAcross 27s linear infinite;
          animation-delay: 14s;
        }
        
        /* Sun positions */
        .sun-1 {
          top: 5%;
          left: -4%;
          animation: floatAcross 24s linear infinite;
          animation-delay: 2s;
        }
        
        .sun-2 {
          top: 55%;
          left: -3%;
          animation: floatAcross 31s linear infinite;
          animation-delay: 16s;
        }
        
        /* Mountain positions */
        .mountain-1 {
          top: 20%;
          left: -5%;
          animation: floatAcross 33s linear infinite;
          animation-delay: 6s;
        }
        
        .mountain-2 {
          top: 75%;
          left: -4%;
          animation: floatAcross 28s linear infinite;
          animation-delay: 20s;
        }
        
        /* Bear paw positions */
        .paw-1 {
          top: 40%;
          left: -3%;
          animation: floatAcross 26s linear infinite;
          animation-delay: 9s;
        }
        
        .paw-2 {
          top: 65%;
          left: -3%;
          animation: floatAcross 29s linear infinite;
          animation-delay: 22s;
        }
        
        @keyframes floatAcross {
          0% {
            transform: translateX(0) translateY(0) rotate(0deg);
            opacity: 0;
          }
          10% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            transform: translateX(calc(100vw + 100px)) translateY(-20px) rotate(360deg);
            opacity: 0;
          }
        }
        
        @keyframes float {
          0%, 100% {
            transform: translateY(0px) rotate(0deg);
          }
          25% {
            transform: translateY(-10px) rotate(5deg);
          }
          50% {
            transform: translateY(-5px) rotate(-3deg);
          }
          75% {
            transform: translateY(-15px) rotate(7deg);
          }
        }
        
        /* Custom CSS for flip animations */
        .perspective-1000 {
          perspective: 1000px;
        }
        .transform-style-preserve-3d {
          transform-style: preserve-3d;
        }
        .backface-hidden {
          backface-visibility: hidden;
        }
        .rotate-y-180 {
          transform: rotateY(180deg);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
          .floating-symbol {
            transform: scale(0.8);
          }
          
          .river-flow-1, .river-flow-2, .river-flow-3 {
            animation-duration: 15s;
          }
        }
      `})]})},dR=()=>{const[n,e]=C.useState(!1),[t,s]=C.useState({email:"",password:""}),r={name:"John Smith",email:"john.smith@email.com",studentId:"ATS-2024-001",enrollmentDate:"January 15, 2024",totalCourses:3,completedCourses:1,certificates:1},i=[{id:1,title:"RPAS Basic Certification",status:"completed",progress:100,enrollDate:"January 15, 2024",completionDate:"January 17, 2024",instructor:"Mike Johnson",grade:"A+",certificateAvailable:!0},{id:2,title:"RPAS Advanced Certification",status:"in-progress",progress:65,enrollDate:"February 1, 2024",nextSession:"March 20, 2024",instructor:"Sarah Wilson",grade:null,certificateAvailable:!1},{id:3,title:"Commercial Drone Operations",status:"enrolled",progress:0,enrollDate:"February 15, 2024",nextSession:"April 5, 2024",instructor:"David Chen",grade:null,certificateAvailable:!1}],a=[{id:1,title:"RPAS Basic Certification",issueDate:"January 17, 2024",expiryDate:"January 17, 2026",certificateNumber:"ATS-BASIC-2024-001",status:"active"}],o=[{id:1,course:"RPAS Advanced Certification",date:"March 20, 2024",time:"9:00 AM - 5:00 PM",location:"Edmonton Training Center",type:"Practical Training"},{id:2,course:"Commercial RPAS Operations",date:"April 5, 2024",time:"9:00 AM - 12:00 PM",location:"Edmonton Training Center",type:"Theory Session"}],l=p=>{p.preventDefault(),t.email&&t.password&&e(!0)},d=p=>{const{name:m,value:y}=p.target;s(x=>({...x,[m]:y}))},h=p=>{switch(p){case"completed":return"text-green-600 bg-green-100";case"in-progress":return"text-blue-600 bg-blue-100";case"enrolled":return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},f=p=>{switch(p){case"completed":return u.jsx(Vt,{className:"h-4 sm:h-5 w-4 sm:w-5"});case"in-progress":return u.jsx(gu,{className:"h-4 sm:h-5 w-4 sm:w-5"});case"enrolled":return u.jsx(si,{className:"h-4 sm:h-5 w-4 sm:w-5"});default:return u.jsx(cn,{className:"h-4 sm:h-5 w-4 sm:w-5"})}};return n?u.jsx("div",{className:"bg-gray-50 min-h-screen py-8 sm:py-12",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsx("div",{className:"mb-6 sm:mb-8",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:["Welcome back, ",r.name]}),u.jsxs("p",{className:"text-gray-600 text-sm sm:text-base",children:["Student ID: ",r.studentId]})]}),u.jsx("button",{onClick:()=>e(!1),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 sm:px-4 py-2 rounded-lg font-medium transition-colors duration-200 text-sm sm:text-base",children:"Sign Out"})]})}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(cn,{className:"h-6 sm:h-8 w-6 sm:w-8 text-blue-600 mr-2 sm:mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:r.totalCourses}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Total Courses"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Vt,{className:"h-6 sm:h-8 w-6 sm:w-8 text-green-600 mr-2 sm:mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:r.completedCourses}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Completed"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Wt,{className:"h-6 sm:h-8 w-6 sm:w-8 text-yellow-600 mr-2 sm:mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:r.certificates}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Certificates"})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(bi,{className:"h-6 sm:h-8 w-6 sm:w-8 text-purple-600 mr-2 sm:mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:"Member Since"}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:r.enrollmentDate})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6 sm:space-y-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8",children:[u.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6",children:"My Courses"}),u.jsx("div",{className:"space-y-4 sm:space-y-6",children:i.map(p=>u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start mb-3 sm:mb-4 gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:p.title}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["Instructor: ",p.instructor]})]}),u.jsxs("div",{className:`flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium ${h(p.status)}`,children:[f(p.status),u.jsx("span",{className:"ml-1 sm:ml-2 capitalize",children:p.status.replace("-"," ")})]})]}),u.jsxs("div",{className:"mb-3 sm:mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[p.progress,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p.progress}%`}})})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Enrolled:"})," ",p.enrollDate]}),p.completionDate&&u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Completed:"})," ",p.completionDate]}),p.nextSession&&u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Next Session:"})," ",p.nextSession]}),p.grade&&u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Grade:"})," ",p.grade]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[p.certificateAvailable&&u.jsxs("button",{className:"bg-green-600 hover:bg-green-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors duration-200 flex items-center justify-center",children:[u.jsx(t1,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2"}),"Download Certificate"]}),u.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors duration-200 flex items-center justify-center",children:[u.jsx(n1,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2"}),"Course Materials"]})]})]},p.id))})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8",children:[u.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6",children:"My Certificates"}),u.jsx("div",{className:"space-y-4",children:a.map(p=>u.jsx("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:p.title}),u.jsxs("p",{className:"text-gray-600 text-xs sm:text-sm",children:["Certificate #",p.certificateNumber]}),u.jsxs("div",{className:"mt-2 text-xs sm:text-sm text-gray-600",children:[u.jsxs("p",{children:["Issued: ",p.issueDate]}),u.jsxs("p",{children:["Expires: ",p.expiryDate]})]})]}),u.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-auto",children:[u.jsx("span",{className:"bg-green-100 text-green-800 px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium text-center",children:"Active"}),u.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors duration-200 flex items-center justify-center",children:[u.jsx(t1,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2"}),"Download"]})]})]})},p.id))})]})]}),u.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[u.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-3 sm:mb-4",children:"Upcoming Sessions"}),u.jsx("div",{className:"space-y-3 sm:space-y-4",children:o.map(p=>u.jsxs("div",{className:"border-l-4 border-blue-500 pl-3 sm:pl-4",children:[u.jsx("h4",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:p.course}),u.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 space-y-1",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(sw,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2"}),p.date]}),u.jsxs("p",{className:"flex items-center",children:[u.jsx(gu,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1 sm:mr-2"}),p.time]}),u.jsx("p",{className:"text-blue-600 font-medium text-xs sm:text-sm",children:p.type})]})]},p.id))})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[u.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-3 sm:mb-4",children:"Quick Actions"}),u.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[u.jsxs("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium transition-colors duration-200 flex items-center text-sm sm:text-base",children:[u.jsx(cn,{className:"h-4 sm:h-5 w-4 sm:w-5 mr-2 sm:mr-3"}),"Browse New Courses"]}),u.jsxs("button",{className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium transition-colors duration-200 flex items-center text-sm sm:text-base",children:[u.jsx(Mx,{className:"h-4 sm:h-5 w-4 sm:w-5 mr-2 sm:mr-3"}),"View Transcripts"]}),u.jsxs("button",{className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium transition-colors duration-200 flex items-center text-sm sm:text-base",children:[u.jsx(bi,{className:"h-4 sm:h-5 w-4 sm:w-5 mr-2 sm:mr-3"}),"Update Profile"]})]})]}),u.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 sm:p-6",children:[u.jsx("h3",{className:"text-base sm:text-lg font-semibold text-blue-900 mb-2 sm:mb-3",children:"Need Help?"}),u.jsx("p",{className:"text-blue-800 text-xs sm:text-sm mb-3 sm:mb-4",children:"Our support team is here to help with any questions about your courses or certificates."}),u.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors duration-200",children:"Contact Support"})]})]})]}),u.jsxs("div",{className:"mt-8 sm:mt-12 bg-white rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[u.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-3 sm:mb-4",children:"Enhanced Features Coming Soon"}),u.jsx("p",{className:"text-base sm:text-lg text-gray-600 mb-4 sm:mb-6",children:"This student dashboard will be fully integrated with our learning management system, providing real-time progress tracking, interactive course materials, and seamless certificate management."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx(n1,{className:"h-6 sm:h-8 w-6 sm:w-8 text-blue-600 mx-auto mb-2 sm:mb-3"}),u.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Interactive Learning"}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Video lessons, quizzes, and hands-on simulations"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx(Wt,{className:"h-6 sm:h-8 w-6 sm:w-8 text-blue-600 mx-auto mb-2 sm:mb-3"}),u.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Digital Badges"}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Earn and display skill-based digital credentials"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx(bi,{className:"h-6 sm:h-8 w-6 sm:w-8 text-blue-600 mx-auto mb-2 sm:mb-3"}),u.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Community Features"}),u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Connect with fellow students and instructors"})]})]})]})]})}):u.jsx("div",{className:"bg-gray-50 min-h-screen py-8 sm:py-12",children:u.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8",children:[u.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[u.jsx(AA,{className:"h-12 sm:h-16 w-12 sm:w-16 text-blue-600 mx-auto mb-4"}),u.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:"Student Portal Login"}),u.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Access your courses, certificates, and learning progress"})]}),u.jsxs("form",{onSubmit:l,className:"space-y-4 sm:space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),u.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:t.email,onChange:d,className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base",placeholder:"Enter your email"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsx("input",{type:"password",id:"password",name:"password",required:!0,value:t.password,onChange:d,className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base",placeholder:"Enter your password"})]}),u.jsx("button",{type:"submit",className:"w-full bg-blue-700 hover:bg-blue-800 text-white py-2 sm:py-3 px-4 rounded-lg font-semibold transition-colors duration-200 text-sm sm:text-base",children:"Sign In"})]}),u.jsx("div",{className:"mt-4 sm:mt-6 text-center",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",u.jsx("a",{href:"/contact",className:"text-blue-700 hover:text-blue-800 font-medium",children:"Contact us to enroll"})]})}),u.jsxs("div",{className:"mt-6 sm:mt-8 p-3 sm:p-4 bg-blue-50 rounded-lg",children:[u.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm sm:text-base",children:"Demo Access"}),u.jsx("p",{className:"text-blue-800 text-xs sm:text-sm mb-2 sm:mb-3",children:"For demonstration purposes, enter any email and password to access the student dashboard."}),u.jsx("p",{className:"text-blue-700 text-xs",children:"In production, this will integrate with secure authentication and user management systems."})]})]})})})},hR=()=>{const[n,e]=C.useState(""),[t,s]=C.useState(""),[r,i]=C.useState(!1),[a,o]=C.useState(""),l=Ca(),{signIn:d,user:h}=ml();O1.useEffect(()=>{(async()=>{if(h){console.log("User already logged in, redirecting to portal"),l("/portal",{replace:!0});return}try{await zs()&&(console.log("Valid session found, redirecting to portal"),l("/portal",{replace:!0}))}catch{console.log("No valid session found, staying on login page")}})()},[h,l]);const f=async p=>{if(p.preventDefault(),!n||!t){o("Please enter both email and password");return}i(!0),o("");try{console.log("Attempting login for:",n);const{error:m}=await d(n,t);if(m){console.error("Login error:",m),m.message.includes("Invalid login credentials")?o("Invalid email or password. Please check your credentials and try again."):m.message.includes("Email not confirmed")?o("Please check your email and click the confirmation link before logging in."):m.message.includes("Too many requests")?o("Too many login attempts. Please wait a few minutes before trying again."):o(m.message||"An error occurred during login. Please try again.");return}console.log("Login successful, redirecting to portal"),setTimeout(()=>{l("/portal",{replace:!0})},100)}catch(m){console.error("Unexpected login error:",m),o("An unexpected error occurred. Please try again.")}finally{i(!1)}};return u.jsxs("div",{className:"min-h-screen flex",children:[u.jsx("div",{className:"flex-1 flex flex-col justify-center px-4 sm:px-6 lg:px-20 xl:px-24 bg-white",children:u.jsxs("div",{className:"mx-auto w-full max-w-sm lg:w-96",children:[u.jsx("div",{className:"mb-8",children:u.jsxs(_e,{to:"/",className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Home"]})}),u.jsxs("div",{className:"mb-8",children:[u.jsx("img",{src:"/ATS.png",alt:"Aboriginal Training Services",className:"h-12 w-auto mb-6",onError:p=>{p.currentTarget.style.display="none"}}),u.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Log in to your Account"}),u.jsx("p",{className:"mt-2 text-gray-600",children:"Welcome to the ATS Student Portal:"})]}),u.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),u.jsx("input",{id:"email",type:"email",required:!0,value:n,onChange:p=>e(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsx("input",{id:"password",type:"password",required:!0,value:t,onChange:p=>s(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your password"})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),u.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),u.jsx("div",{className:"text-sm",children:u.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot Password?"})})]}),u.jsx("button",{type:"submit",disabled:r,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:r?"Signing in...":"Log In"})]}),u.jsxs("div",{className:"mt-6 text-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Don't have an account?"}),u.jsx(_e,{to:"/sign-up",className:"mt-2 inline-block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 px-4 rounded-lg font-medium transition-colors duration-200 text-center",children:"Create an Account"})]})]})}),u.jsxs("div",{className:"hidden lg:block relative flex-1 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[u.jsxs("div",{className:"absolute inset-0 opacity-10",children:[u.jsx("div",{className:"absolute top-20 left-10 w-4 h-4 bg-white rounded-full animate-pulse"}),u.jsx("div",{className:"absolute top-40 right-20 w-6 h-6 bg-white rounded-full animate-bounce"}),u.jsx("div",{className:"absolute bottom-40 left-20 w-3 h-3 bg-white rounded-full animate-ping"}),u.jsx("div",{className:"absolute bottom-20 right-10 w-5 h-5 bg-white rounded-full animate-pulse"})]}),u.jsx("div",{className:"relative flex flex-col justify-center h-full px-12 xl:px-16",children:u.jsxs("div",{className:"text-center text-white",children:[u.jsxs("div",{className:"flex justify-center space-x-8 mb-12",children:[u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-4 backdrop-blur-sm",children:u.jsx(Dm,{className:"h-8 w-8 text-white"})}),u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-4 backdrop-blur-sm",children:u.jsx(qd,{className:"h-8 w-8 text-white"})}),u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-4 backdrop-blur-sm",children:u.jsx(Wt,{className:"h-8 w-8 text-white"})})]}),u.jsx("h1",{className:"text-4xl font-bold mb-6",children:"Access Your Training Portal"}),u.jsx("p",{className:"text-xl text-blue-100 mb-8 leading-relaxed",children:"Everything you need for professional RPAS certification and training in one easily accessible dashboard."}),u.jsxs("div",{className:"space-y-4 text-left max-w-md mx-auto",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-2 mr-4",children:u.jsx(Wt,{className:"h-5 w-5 text-white"})}),u.jsx("span",{className:"text-blue-100",children:"Track your certification progress"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-2 mr-4",children:u.jsx(Gd,{className:"h-5 w-5 text-white"})}),u.jsx("span",{className:"text-blue-100",children:"Connect with instructors and peers"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"bg-white bg-opacity-20 rounded-full p-2 mr-4",children:u.jsx(qd,{className:"h-5 w-5 text-white"})}),u.jsx("span",{className:"text-blue-100",children:"Access course materials securely"})]})]}),u.jsxs("div",{className:"flex justify-center space-x-2 mt-12",children:[u.jsx("div",{className:"w-2 h-2 bg-white rounded-full"}),u.jsx("div",{className:"w-2 h-2 bg-white bg-opacity-50 rounded-full"}),u.jsx("div",{className:"w-2 h-2 bg-white bg-opacity-50 rounded-full"})]})]})}),u.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white bg-opacity-5 rounded-full -translate-y-32 translate-x-32"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white bg-opacity-5 rounded-full translate-y-24 -translate-x-24"})]})]})},fR=()=>{const{user:n,loading:e}=ml(),t=Ca(),[s,r]=C.useState(null),[i,a]=C.useState([]),[o,l]=C.useState([]),[d,h]=C.useState([]),[f,p]=C.useState([]),[m,y]=C.useState("dashboard"),[x,_]=C.useState(!0),[g,w]=C.useState(null),[b,k]=C.useState(!1),[E,N]=C.useState({full_name:"",phone_number:""}),[j,T]=C.useState(!1),[M,F]=C.useState(null),[R,V]=C.useState(!1);C.useEffect(()=>{!e&&!n&&t("/login")},[n,e,t]),C.useEffect(()=>{(async()=>{if(n)try{_(!0),w(null);const{data:H,error:G}=await se.from("students").select("*").eq("id",n.id).single();if(G)throw G;r(H);const{data:ie,error:U}=await se.from("enrollments").select("*").eq("student_id",n.id);if(U)throw U;a(ie||[]);const{data:X,error:he}=await se.from("courses_ats").select("*").eq("is_active",!0);if(he)throw he;l(X||[]);const{data:le,error:Lt}=await se.from("certificates").select(`
            *,
            course:courses_ats(title, type)
          `).eq("student_id",n.id);if(Lt)throw Lt;h(le||[]);const{data:yl,error:Pa}=await se.from("header_logo").select("*").eq("is_active",!0).order("order_index");if(Pa)throw Pa;p(yl||[])}catch(H){console.error("Error fetching data:",H),w("Failed to load profile data")}finally{_(!1)}})()},[n]),C.useEffect(()=>{s&&N({full_name:s.full_name||"",phone_number:s.phone_number||""})},[s]);const $=async()=>{try{await Ht(),t("/login")}catch(L){console.error("Logout error:",L)}},D=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),Z=()=>{k(!0),F(null),V(!1)},B=()=>{k(!1),F(null),V(!1),s&&N({full_name:s.full_name||"",phone_number:s.phone_number||""})},I=L=>{const{name:H,value:G}=L.target;N(ie=>({...ie,[H]:G}))},P=async()=>{if(!n||!s)return;if(!await zs()){t("/login",{replace:!0});return}try{T(!0),F(null),console.log("Updating profile for user ID:",n.id),console.log("Current profile data:",s),console.log("New profile data:",E);const{error:H}=await se.from("students").update({full_name:E.full_name.trim(),phone_number:E.phone_number.trim()||null}).eq("id",n.id);if(H){if(console.error("Profile update error:",H),H.message.includes("JWT")){await Ht();return}throw H}console.log("Profile updated successfully in database"),r(G=>G?{...G,full_name:E.full_name.trim(),phone_number:E.phone_number.trim()||""}:null),k(!1),V(!0),setTimeout(()=>{V(!1)},3e3)}catch(H){console.error("Error updating profile:",H),F(`Failed to update profile: ${H instanceof Error?H.message:"Unknown error"}`)}finally{T(!1)}};if(e||x)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bs,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),u.jsx("p",{className:"text-gray-600",children:"Loading your portal..."})]})});if(g)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(si,{className:"w-8 h-8 mx-auto mb-4 text-red-600"}),u.jsx("p",{className:"text-red-600 mb-4",children:g}),u.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})});if(!s)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(si,{className:"w-8 h-8 mx-auto mb-4 text-yellow-600"}),u.jsx("p",{className:"text-gray-600",children:"Profile not found"})]})});const O=o.filter(L=>i.some(H=>H.course_id===L.id.toString()));return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("header",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center h-16",children:[u.jsxs("div",{className:"flex items-center",children:[f.length>0&&u.jsx("img",{src:f[0].logo_url,alt:f[0].alt_text||"Logo",className:"h-8 w-auto"}),u.jsxs("a",{href:"/",className:"hidden sm:inline-flex items-center space-x-1 px-3 py-2 text-sm text-gray-700 hover:text-blue-600 hover:bg-gray-100 rounded-lg transition-colors",children:[u.jsx(zd,{className:"w-4 h-4"}),u.jsx("span",{children:"Back to Website"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(bi,{className:"w-5 h-5 text-gray-500"}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.full_name})]}),u.jsxs("button",{onClick:$,className:"flex items-center space-x-1 px-3 py-2 text-sm text-gray-700 hover:text-red-600 hover:bg-gray-100 rounded-lg transition-colors",children:[u.jsx(Wd,{className:"w-4 h-4"}),u.jsx("span",{children:"Logout"})]})]})]})})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsx("div",{className:"mb-8",children:u.jsx("nav",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:bi},{id:"courses",label:"My Courses",icon:cn},{id:"certificates",label:"Certificates",icon:Wt},{id:"profile",label:"Profile",icon:s1}].map(({id:L,label:H,icon:G})=>u.jsxs("button",{onClick:()=>y(L),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ${m===L?"bg-blue-100 text-blue-700 border-b-2 border-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[u.jsx(G,{className:"w-5 h-5"}),u.jsx("span",{children:H})]},L))})}),m==="dashboard"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Welcome back, ",s.full_name,"!"]}),u.jsxs("p",{className:"text-gray-600",children:["Member since ",D(s.created_at)]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(cn,{className:"w-8 h-8 text-blue-600"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Enrolled Courses"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Wt,{className:"w-8 h-8 text-green-600"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Certificates"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.length})]})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(gu,{className:"w-8 h-8 text-orange-600"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"In Progress"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]})]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"})}),u.jsx("div",{className:"p-6",children:i.length>0?u.jsx("div",{className:"space-y-4",children:i.slice(0,3).map(L=>{const H=o.find(G=>G.id.toString()===L.course_id);return u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"}),u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Enrolled in ",(H==null?void 0:H.title)||"Unknown Course"]}),u.jsx("p",{className:"text-xs text-gray-500",children:D(L.enrolled_at)})]})]},L.id)})}):u.jsx("p",{className:"text-gray-500",children:"No recent activity"})})]})]}),m==="courses"&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"My Courses"})}),u.jsx("div",{className:"p-6",children:O.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map(L=>u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:L.title}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${L.type==="regulation"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:L.type})]}),u.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:L.description}),u.jsxs("div",{className:"flex items-center justify-between text-sm",children:[u.jsxs("span",{className:"text-gray-500",children:["Duration: ",L.duration]}),u.jsx("button",{onClick:()=>t(`/student/courses/${L.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Continue"})]})]},L.id))}):u.jsxs("div",{className:"text-center py-8",children:[u.jsx(cn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"No courses enrolled yet"}),u.jsx("button",{onClick:()=>t("/training"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Browse Courses"})]})})]})}),m==="certificates"&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"My Certificates"})}),u.jsx("div",{className:"p-6",children:d.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(L=>{var H,G;return u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:((H=L.course)==null?void 0:H.title)||"Certificate"}),u.jsx("p",{className:"text-sm text-gray-600",children:(G=L.course)==null?void 0:G.type})]}),u.jsx(Wt,{className:"w-6 h-6 text-yellow-500"})]}),u.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Issued: ",D(L.issued_at)]}),L.url&&u.jsxs("a",{href:L.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-600 hover:text-blue-800 text-sm font-medium",children:[u.jsx(nw,{className:"w-4 h-4"}),u.jsx("span",{children:"View Certificate"})]})]},L.id)})}):u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Wt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"No certificates earned yet"}),u.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Complete courses to earn certificates"})]})})]})}),m==="profile"&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Profile Information"}),b?u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:B,disabled:j,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50",children:"Cancel"}),u.jsxs("button",{onClick:P,disabled:j||!E.full_name.trim(),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[j?u.jsx(bs,{className:"w-4 h-4 animate-spin"}):u.jsx(Vt,{className:"w-4 h-4"}),u.jsx("span",{children:j?"Saving...":"Save Changes"})]})]}):u.jsxs("button",{onClick:Z,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[u.jsx(s1,{className:"w-4 h-4"}),u.jsx("span",{children:"Edit Profile"})]})]})}),u.jsxs("div",{className:"p-6",children:[R&&u.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Vt,{className:"w-5 h-5 text-green-600 mr-2"}),u.jsx("span",{className:"text-green-800 font-medium",children:"Profile updated successfully!"})]})}),M&&u.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(si,{className:"w-5 h-5 text-red-600 mr-2"}),u.jsx("span",{className:"text-red-800",children:M})]})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(bi,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-gray-900 font-mono bg-gray-50 px-3 py-2 rounded border",children:s.id}),u.jsx("span",{className:"text-xs text-gray-500",children:"(Read-only)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),b?u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(bi,{className:"w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",name:"full_name",value:E.full_name,onChange:I,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your full name",required:!0})]}):u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(bi,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-gray-900",children:s.full_name})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Mg,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-gray-900",children:n==null?void 0:n.email}),u.jsx("span",{className:"text-xs text-gray-500",children:"(Managed by account settings)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),b?u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Vd,{className:"w-5 h-5 text-gray-400"}),u.jsx("input",{type:"tel",name:"phone_number",value:E.phone_number,onChange:I,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your phone number (optional)"})]}):u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Vd,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-gray-900",children:s.phone_number||"Not provided"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member Since"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(sw,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-gray-900",children:D(s.created_at)})]})]})]})]})]})})]})]})},Zt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Dx=[.001,0,0,.001,0,0],S0=1.35,Os={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_i={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},jA="pdfjs_internal_editor_",ae={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},xe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},pR={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Dt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Pp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ze={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},kl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Dg={ERRORS:0,WARNINGS:1,INFOS:5},Om={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},dp={moveTo:0,lineTo:1,curveTo:2,closePath:3},mR={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Og=Dg.WARNINGS;function gR(n){Number.isInteger(n)&&(Og=n)}function xR(){return Og}function Fg(n){Og>=Dg.INFOS&&console.log(`Info: ${n}`)}function oe(n){Og>=Dg.WARNINGS&&console.log(`Warning: ${n}`)}function je(n){throw new Error(n)}function st(n,e){n||je(e)}function yR(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function CA(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const r=n.match(/\./g);(r==null?void 0:r.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=SR(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return yR(s)?s:null}function TA(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&CA(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ge(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const gl=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class r1 extends gl{constructor(e,t){super(e,"PasswordException"),this.code=t}}class A0 extends gl{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Ox extends gl{constructor(e){super(e,"InvalidPDFException")}}class Fm extends gl{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class vR extends gl{constructor(e){super(e,"FormatError")}}class wa extends gl{constructor(e){super(e,"AbortException")}}function PA(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&je("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),a=n.subarray(r,i);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Df(n){typeof n!="string"&&je("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function wR(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function bR(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function _R(){try{return new Function(""),!0}catch{return!1}}class Pt{static get isLittleEndian(){return ge(this,"isLittleEndian",bR())}static get isEvalSupported(){return ge(this,"isEvalSupported",_R())}static get isOffscreenCanvasSupported(){return ge(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ge(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ge(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ge(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const E0=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var ni,Rp,Fx;class te{static makeHexColor(e,t,s){return`#${E0[e]}${E0[t]}${E0[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const r=e[s],i=e[s+1];e[s]=r*t[0]+i*t[2]+t[4],e[s+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const r=t[0],i=t[1],a=t[2],o=t[3],l=t[4],d=t[5];for(let h=0;h<6;h+=2){const f=e[s+h],p=e[s+h+1];e[s+h]=f*r+p*a+l,e[s+h+1]=f*i+p*o+d}}static applyInverseTransform(e,t){const s=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const r=t[0],i=t[1],a=t[2],o=t[3],l=t[4],d=t[5],h=e[0],f=e[1],p=e[2],m=e[3];let y=r*h+l,x=y,_=r*p+l,g=_,w=o*f+d,b=w,k=o*m+d,E=k;if(i!==0||a!==0){const N=i*h,j=i*p,T=a*f,M=a*m;y+=T,g+=T,_+=M,x+=M,w+=N,E+=N,k+=j,b+=j}s[0]=Math.min(s[0],y,_,x,g),s[1]=Math.min(s[1],w,k,b,E),s[2]=Math.max(s[2],y,_,x,g),s[3]=Math.max(s[3],w,k,b,E)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],r=e[1],i=e[2],a=e[3],o=s**2+r**2,l=s*i+r*a,d=i**2+a**2,h=(o+d)/2,f=Math.sqrt(h**2-(o*d-l**2));t[0]=Math.sqrt(h+f||1),t[1]=Math.sqrt(h-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[s,i,r,a]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,r,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,r)}static bezierBoundingBox(e,t,s,r,i,a,o,l,d){d[0]=Math.min(d[0],e,o),d[1]=Math.min(d[1],t,l),d[2]=Math.max(d[2],e,o),d[3]=Math.max(d[3],t,l),A(this,ni,Fx).call(this,e,s,i,o,t,r,a,l,3*(-e+3*(s-i)+o),6*(e-2*s+i),3*(s-e),d),A(this,ni,Fx).call(this,e,s,i,o,t,r,a,l,3*(-t+3*(r-a)+l),6*(t-2*r+a),3*(r-t),d)}}ni=new WeakSet,Rp=function(e,t,s,r,i,a,o,l,d,h){if(d<=0||d>=1)return;const f=1-d,p=d*d,m=p*d,y=f*(f*(f*e+3*d*t)+3*p*s)+m*r,x=f*(f*(f*i+3*d*a)+3*p*o)+m*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],x),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],x)},Fx=function(e,t,s,r,i,a,o,l,d,h,f,p){if(Math.abs(d)<1e-12){Math.abs(h)>=1e-12&&A(this,ni,Rp).call(this,e,t,s,r,i,a,o,l,-f/h,p);return}const m=h**2-4*f*d;if(m<0)return;const y=Math.sqrt(m),x=2*d;A(this,ni,Rp).call(this,e,t,s,r,i,a,o,l,(-h+y)/x,p),A(this,ni,Rp).call(this,e,t,s,r,i,a,o,l,(-h-y)/x,p)},S(te,ni);function SR(n){return decodeURIComponent(escape(n))}let k0=null,i1=null;function AR(n){return k0||(k0=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,i1=new Map([["","t"]])),n.replaceAll(k0,(e,t,s)=>t?t.normalize("NFKC"):i1.get(s))}function RA(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),PA(n)}const iw="pdfjs_internal_id_";function ER(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,r,...i]=t;if(!n(s)&&!Number.isInteger(s)||!e(r))return!1;const a=i.length;let o=!0;switch(r.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of i)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function es(n,e,t){return Math.min(Math.max(n,e),t)}function LA(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(PA(n))}function kR(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Df(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const pr="http://www.w3.org/2000/svg",Ba=class Ba{};W(Ba,"CSS",96),W(Ba,"PDF",72),W(Ba,"PDF_TO_CSS_UNITS",Ba.CSS/Ba.PDF);let ba=Ba;async function Of(n,e="text"){if(Wu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class Ff{constructor({viewBox:e,userUnit:t,scale:s,rotation:r,offsetX:i=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=r,this.offsetX=i,this.offsetY=a,s*=t;const l=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let h,f,p,m;switch(r%=360,r<0&&(r+=360),r){case 180:h=-1,f=0,p=0,m=1;break;case 90:h=0,f=1,p=1,m=0;break;case 270:h=0,f=-1,p=-1,m=0;break;case 0:h=1,f=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let y,x,_,g;h===0?(y=Math.abs(d-e[1])*s+i,x=Math.abs(l-e[0])*s+a,_=(e[3]-e[1])*s,g=(e[2]-e[0])*s):(y=Math.abs(l-e[0])*s+i,x=Math.abs(d-e[1])*s+a,_=(e[2]-e[0])*s,g=(e[3]-e[1])*s),this.transform=[h*s,f*s,p*s,m*s,y-h*s*l-p*s*d,x-f*s*l-m*s*d],this.width=_,this.height=g}get rawDims(){const e=this.viewBox;return ge(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new Ff({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return te.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];te.applyTransform(t,this.transform);const s=[e[2],e[3]];return te.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return te.applyInverseTransform(s,this.transform),s}}class aw extends gl{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function $g(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function ow(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function NR(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function jR(n,e="document.pdf"){if(typeof n!="string")return e;if($g(n))return oe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const r=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},i=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(i.test(a))return r(a);if(s.searchParams.size>0){const o=Array.from(s.searchParams.values()).reverse();for(const d of o)if(i.test(d))return r(d);const l=Array.from(s.searchParams.keys()).reverse();for(const d of l)if(i.test(d))return r(d)}if(s.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(l)return r(l[0])}return e}class a1{constructor(){W(this,"started",Object.create(null));W(this,"times",[])}time(e){e in this.started&&oe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||oe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:r,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-r}ms
`);return e.join("")}}function Wu(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function On(n){n.preventDefault()}function et(n){n.preventDefault(),n.stopPropagation()}function CR(n){console.log("Deprecated API usage: "+n)}var Qd;class lw{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,Qd)||v(this,Qd,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Qd).exec(e);if(!t)return null;const s=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const d=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,d==="-"?(a+=h,o+=f):d==="+"&&(a-=h,o-=f),new Date(Date.UTC(s,r,i,a,o,l))}}Qd=new WeakMap,S(lw,Qd);function TR(n,{scale:e=1,rotation:t=0}){const{width:s,height:r}=n.attributes.style,i=[0,0,parseInt(s),parseInt(r)];return new Ff({viewBox:i,userUnit:1,scale:e,rotation:t})}function cw(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(oe(`Not a valid color format: "${n}"`),[0,0,0])}function PR(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,cw(s))}e.remove()}function ze(n){const{a:e,b:t,c:s,d:r,e:i,f:a}=n.getTransform();return[e,t,s,r,i,a]}function Bn(n){const{a:e,b:t,c:s,d:r,e:i,f:a}=n.getTransform().invertSelf();return[e,t,s,r,i,a]}function ll(n,e,t=!1,s=!0){if(e instanceof Ff){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:a}=n,o=Pt.isCSSRoundSupported,l=`var(--total-scale-factor) * ${r}px`,d=`var(--total-scale-factor) * ${i}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class dr{constructor(){const{pixelRatio:e}=dr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,r,i=-1){let a=1/0,o=1/0,l=1/0;s=dr.capPixels(s,i),s>0&&(a=Math.sqrt(s/(e*t))),r!==-1&&(o=r/e,l=r/t);const d=Math.min(a,o,l);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const $x=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Si,Va,Ys,Ai,Jd,nc,Zd,qm,IA,ss,MA,DA,Vu,Lp;const vr=class vr{constructor(e){S(this,ss);S(this,Si,null);S(this,Va,null);S(this,Ys);S(this,Ai,null);S(this,Jd,null);S(this,nc,null);v(this,Ys,e),c(vr,Zd)||v(vr,Zd,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=v(this,Si,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,Ys)._uiManager._signal;e.addEventListener("contextmenu",On,{signal:t}),e.addEventListener("pointerdown",A(vr,qm,IA),{signal:t});const s=v(this,Ai,document.createElement("div"));s.className="buttons",e.append(s);const r=c(this,Ys).toolbarPosition;if(r){const{style:i}=e,a=c(this,Ys)._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*a}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return c(this,Si)}hide(){var e;c(this,Si).classList.add("hidden"),(e=c(this,Va))==null||e.hideDropdown()}show(){var e;c(this,Si).classList.remove("hidden"),(e=c(this,Jd))==null||e.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=c(this,Ys),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",c(vr,Zd)[e]),A(this,ss,Vu).call(this,s),s.addEventListener("click",r=>{t.delete()},{signal:t._signal}),c(this,Ai).append(s)}async addAltText(e){const t=await e.render();A(this,ss,Vu).call(this,t),c(this,Ai).append(t,c(this,ss,Lp)),v(this,Jd,e)}addColorPicker(e){v(this,Va,e);const t=e.renderButton();A(this,ss,Vu).call(this,t),c(this,Ai).append(t,c(this,ss,Lp))}async addEditSignatureButton(e){const t=v(this,nc,await e.renderEditButton(c(this,Ys)));A(this,ss,Vu).call(this,t),c(this,Ai).append(t,c(this,ss,Lp))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){c(this,nc)&&(c(this,nc).title=e)}remove(){var e;c(this,Si).remove(),(e=c(this,Va))==null||e.destroy(),v(this,Va,null)}};Si=new WeakMap,Va=new WeakMap,Ys=new WeakMap,Ai=new WeakMap,Jd=new WeakMap,nc=new WeakMap,Zd=new WeakMap,qm=new WeakSet,IA=function(e){e.stopPropagation()},ss=new WeakSet,MA=function(e){c(this,Ys)._focusEventsAllowed=!1,et(e)},DA=function(e){c(this,Ys)._focusEventsAllowed=!0,et(e)},Vu=function(e){const t=c(this,Ys)._uiManager._signal;e.addEventListener("focusin",A(this,ss,MA).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,ss,DA).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",On,{signal:t})},Lp=function(){const e=document.createElement("div");return e.className="divider",e},S(vr,qm),S(vr,Zd,null);let Bx=vr;var eh,qa,Ga,_a,OA,FA,$A;class RR{constructor(e){S(this,_a);S(this,eh,null);S(this,qa,null);S(this,Ga);v(this,Ga,e)}show(e,t,s){const[r,i]=A(this,_a,FA).call(this,t,s),{style:a}=c(this,qa)||v(this,qa,A(this,_a,OA).call(this));e.append(c(this,qa)),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,qa).remove()}}eh=new WeakMap,qa=new WeakMap,Ga=new WeakMap,_a=new WeakSet,OA=function(){const e=v(this,qa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",On,{signal:c(this,Ga)._signal});const t=v(this,eh,document.createElement("div"));return t.className="buttons",e.append(t),A(this,_a,$A).call(this),e},FA=function(e,t){let s=0,r=0;for(const i of e){const a=i.y+i.height;if(a<s)continue;const o=i.x+(t?i.width:0);if(a>s){r=o,s=a;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,s]},$A=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=c(this,Ga)._signal;e.addEventListener("contextmenu",On,{signal:s}),e.addEventListener("click",()=>{c(this,Ga).highlightSelection("floating_button")},{signal:s}),c(this,eh).append(e)};function BA(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Gm;class LR{constructor(){S(this,Gm,0)}get id(){return`${jA}${Gt(this,Gm)._++}`}}Gm=new WeakMap;var rc,th,$t,ic,Ip;const gw=class gw{constructor(){S(this,ic);S(this,rc,RA());S(this,th,0);S(this,$t,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ge(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:s,size:r,type:i}=e;return A(this,ic,Ip).call(this,`${t}_${s}_${r}_${i}`,e)}async getFromUrl(e){return A(this,ic,Ip).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,ic,Ip).call(this,e,s)}async getFromId(e){c(this,$t)||v(this,$t,new Map);const t=c(this,$t).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,$t)||v(this,$t,new Map);let s=c(this,$t).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${c(this,rc)}_${Gt(this,th)._++}`,refCounter:1,isSvg:!1},c(this,$t).set(e,s),c(this,$t).set(s.id,s),s}getSvgUrl(e){const t=c(this,$t).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;c(this,$t)||v(this,$t,new Map);const t=c(this,$t).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}(r=s.close)==null||r.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,rc)}_`)}};rc=new WeakMap,th=new WeakMap,$t=new WeakMap,ic=new WeakSet,Ip=async function(e,t){c(this,$t)||v(this,$t,new Map);let s=c(this,$t).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${c(this,rc)}_${Gt(this,th)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(s.url=t,r=await Of(t,"blob")):t instanceof File?r=s.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=gw._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((d,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,d()},a.onload=async()=>{const f=s.svgUrl=a.result;o.src=await i?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(r),await l}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){oe(r),s=null}return c(this,$t).set(e,s),s&&c(this,$t).set(s.id,s),s};let Ux=gw;var Xe,Ei,sh,Ue;class IR{constructor(e=128){S(this,Xe,[]);S(this,Ei,!1);S(this,sh);S(this,Ue,-1);v(this,sh,e)}add({cmd:e,undo:t,post:s,mustExec:r,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),c(this,Ei))return;const l={cmd:e,undo:t,post:s,type:i};if(c(this,Ue)===-1){c(this,Xe).length>0&&(c(this,Xe).length=0),v(this,Ue,0),c(this,Xe).push(l);return}if(a&&c(this,Xe)[c(this,Ue)].type===i){o&&(l.undo=c(this,Xe)[c(this,Ue)].undo),c(this,Xe)[c(this,Ue)]=l;return}const d=c(this,Ue)+1;d===c(this,sh)?c(this,Xe).splice(0,1):(v(this,Ue,d),d<c(this,Xe).length&&c(this,Xe).splice(d)),c(this,Xe).push(l)}undo(){if(c(this,Ue)===-1)return;v(this,Ei,!0);const{undo:e,post:t}=c(this,Xe)[c(this,Ue)];e(),t==null||t(),v(this,Ei,!1),v(this,Ue,c(this,Ue)-1)}redo(){if(c(this,Ue)<c(this,Xe).length-1){v(this,Ue,c(this,Ue)+1),v(this,Ei,!0);const{cmd:e,post:t}=c(this,Xe)[c(this,Ue)];e(),t==null||t(),v(this,Ei,!1)}}hasSomethingToUndo(){return c(this,Ue)!==-1}hasSomethingToRedo(){return c(this,Ue)<c(this,Xe).length-1}cleanType(e){if(c(this,Ue)!==-1){for(let t=c(this,Ue);t>=0;t--)if(c(this,Xe)[t].type!==e){c(this,Xe).splice(t+1,c(this,Ue)-t),v(this,Ue,t);return}c(this,Xe).length=0,v(this,Ue,-1)}}destroy(){v(this,Xe,null)}}Xe=new WeakMap,Ei=new WeakMap,sh=new WeakMap,Ue=new WeakMap;var Xm,UA;class $f{constructor(e){S(this,Xm);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Pt.platform;for(const[s,r,i={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:r,options:i}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:r,options:i}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,Xm,UA).call(this,t));if(!s)return;const{callback:r,options:{bubbles:i=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(r.bind(e,...a,t)(),i||et(t))}}Xm=new WeakSet,UA=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Km=class Km{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return PR(e),ge(this,"_colors",e)}convert(e){const t=cw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,r]of this._colors)if(r.every((i,a)=>i===t[a]))return Km._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?te.makeHexColor(...t):e}};W(Km,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let zx=Km;var ac,Ss,ot,_t,oc,_r,lc,Qs,ki,Ni,cc,Xa,Wn,yn,Ka,nh,rh,uc,ih,Vn,ji,dc,Ci,qn,Ym,Ti,ah,Pi,Ya,Qa,Ri,oh,ht,Ae,Sr,Li,Ja,lh,ch,Ii,Gn,Ar,uh,dh,Js,q,Mp,Hx,zA,HA,Dp,WA,VA,qA,Wx,GA,Vx,qx,XA,Xt,mr,KA,YA,Gx,QA,qu,Xx;const Gl=class Gl{constructor(e,t,s,r,i,a,o,l,d,h,f,p,m,y,x){S(this,q);S(this,ac,new AbortController);S(this,Ss,null);S(this,ot,new Map);S(this,_t,new Map);S(this,oc,null);S(this,_r,null);S(this,lc,null);S(this,Qs,new IR);S(this,ki,null);S(this,Ni,null);S(this,cc,0);S(this,Xa,new Set);S(this,Wn,null);S(this,yn,null);S(this,Ka,new Set);W(this,"_editorUndoBar",null);S(this,nh,!1);S(this,rh,!1);S(this,uc,!1);S(this,ih,null);S(this,Vn,null);S(this,ji,null);S(this,dc,null);S(this,Ci,!1);S(this,qn,null);S(this,Ym,new LR);S(this,Ti,!1);S(this,ah,!1);S(this,Pi,null);S(this,Ya,null);S(this,Qa,null);S(this,Ri,null);S(this,oh,null);S(this,ht,ae.NONE);S(this,Ae,new Set);S(this,Sr,null);S(this,Li,null);S(this,Ja,null);S(this,lh,null);S(this,ch,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});S(this,Ii,[0,0]);S(this,Gn,null);S(this,Ar,null);S(this,uh,null);S(this,dh,null);S(this,Js,null);const _=this._signal=c(this,ac).signal;v(this,Ar,e),v(this,uh,t),v(this,dh,s),v(this,oc,r),v(this,Li,i),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:_}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),a._on("setpreference",this.onSetPreference.bind(this),{signal:_}),a._on("switchannotationeditorparams",g=>this.updateParams(g.type,g.value),{signal:_}),A(this,q,WA).call(this),A(this,q,XA).call(this),A(this,q,Wx).call(this),v(this,_r,o.annotationStorage),v(this,ih,o.filterFactory),v(this,Ja,l),v(this,dc,d||null),v(this,nh,h),v(this,rh,f),v(this,uc,p),v(this,oh,m||null),this.viewParameters={realScale:ba.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const e=Gl.prototype,t=a=>c(a,Ar).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return ge(this,"_keyboardManager",new $f([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Ar).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Ar).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,s,r,i,a,o,l;(e=c(this,Js))==null||e.resolve(),v(this,Js,null),(t=c(this,ac))==null||t.abort(),v(this,ac,null),this._signal=null;for(const d of c(this,_t).values())d.destroy();c(this,_t).clear(),c(this,ot).clear(),c(this,Ka).clear(),(s=c(this,Ri))==null||s.clear(),v(this,Ss,null),c(this,Ae).clear(),c(this,Qs).destroy(),(r=c(this,oc))==null||r.destroy(),(i=c(this,Li))==null||i.destroy(),(a=c(this,qn))==null||a.hide(),v(this,qn,null),(o=c(this,Qa))==null||o.destroy(),v(this,Qa,null),c(this,Vn)&&(clearTimeout(c(this,Vn)),v(this,Vn,null)),c(this,Gn)&&(clearTimeout(c(this,Gn)),v(this,Gn,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,oh)}get useNewAltTextFlow(){return c(this,rh)}get useNewAltTextWhenAddingImage(){return c(this,uc)}get hcmFilter(){return ge(this,"hcmFilter",c(this,Ja)?c(this,ih).addHCMFilter(c(this,Ja).foreground,c(this,Ja).background):"none")}get direction(){return ge(this,"direction",getComputedStyle(c(this,Ar)).direction)}get highlightColors(){return ge(this,"highlightColors",c(this,dc)?new Map(c(this,dc).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return ge(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),v(this,Ni,e)}setMainHighlightColorPicker(e){v(this,Qa,e)}editAltText(e,t=!1){var s;(s=c(this,oc))==null||s.editAltText(this,e,t)}getSignature(e){var t;(t=c(this,Li))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return c(this,Li)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":v(this,uc,t);break}}onPageChanging({pageNumber:e}){v(this,cc,e-1)}focusMainContainer(){c(this,Ar).focus()}findParent(e,t){for(const s of c(this,_t).values()){const{x:r,y:i,width:a,height:o}=s.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=i&&t<=i+o)return s}return null}disableUserSelect(e=!1){c(this,uh).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,Ka).add(e)}removeShouldRescale(e){c(this,Ka).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*ba.PDF_TO_CSS_UNITS;for(const s of c(this,Ka))s.onScaleChanging();(t=c(this,Ni))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:i,focusOffset:a}=t,o=t.toString(),d=A(this,q,Mp).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(d);if(!h)return;t.empty();const f=A(this,q,Hx).call(this,d),p=c(this,ht)===ae.NONE,m=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:r,focusNode:i,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(ae.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,_r)&&!c(this,_r).has(e.id)&&c(this,_r).setValue(e.id,e)}a11yAlert(e,t=null){const s=c(this,dh);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,c(this,Ci)&&(v(this,Ci,!1),A(this,q,Dp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,Ae))if(t.div.contains(e)){v(this,Ya,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,Ya))return;const[e,t]=c(this,Ya);v(this,Ya,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,q,Wx).call(this),A(this,q,Vx).call(this)}removeEditListeners(){A(this,q,GA).call(this),A(this,q,qx).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of c(this,yn))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of c(this,yn))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=c(this,Ss))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of c(this,Ae)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const a of c(this,yn))if(a.isHandlingMimeForPasting(i.type)){a.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){oe(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const l of s){const d=await r.deserialize(l);if(!d)return;i.push(d)}const a=()=>{for(const l of i)A(this,q,Gx).call(this,l);A(this,q,Xx).call(this,i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(i){oe(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,ht)!==ae.NONE&&!this.isEditorHandlingKeyboard&&Gl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,Ci)&&(v(this,Ci,!1),A(this,q,Dp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(A(this,q,VA).call(this),A(this,q,Vx).call(this),A(this,q,Xt).call(this,{isEditing:c(this,ht)!==ae.NONE,isEmpty:A(this,q,qu).call(this),hasSomethingToUndo:c(this,Qs).hasSomethingToUndo(),hasSomethingToRedo:c(this,Qs).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,q,qA).call(this),A(this,q,qx).call(this),A(this,q,Xt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,yn)){v(this,yn,e);for(const t of c(this,yn))A(this,q,mr).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,Ym).id}get currentLayer(){return c(this,_t).get(c(this,cc))}getLayer(e){return c(this,_t).get(e)}get currentPageIndex(){return c(this,cc)}addLayer(e){c(this,_t).set(e.pageIndex,e),c(this,Ti)?e.enable():e.disable()}removeLayer(e){c(this,_t).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,r=!1){var i,a,o;if(c(this,ht)!==e&&!(c(this,Js)&&(await c(this,Js).promise,!c(this,Js)))){if(v(this,Js,Promise.withResolvers()),(i=c(this,Ni))==null||i.commitOrRemove(),v(this,ht,e),e===ae.NONE){this.setEditingState(!1),A(this,q,YA).call(this),(a=this._editorUndoBar)==null||a.hide(),c(this,Js).resolve();return}e===ae.SIGNATURE&&await((o=c(this,Li))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await A(this,q,KA).call(this),this.unselectAll();for(const l of c(this,_t).values())l.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),c(this,Js).resolve();return}for(const l of c(this,ot).values())l.annotationElementId===t||l.id===t?(this.setSelected(l),r&&l.enterInEditMode()):l.unselect();c(this,Js).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==c(this,ht)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var s;if(c(this,yn)){switch(e){case xe.CREATE:this.currentLayer.addNewEditor(t);return;case xe.HIGHLIGHT_DEFAULT_COLOR:(s=c(this,Qa))==null||s.updateColor(t);break;case xe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,lh)||v(this,lh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const r of c(this,Ae))r.updateParams(e,t);for(const r of c(this,yn))r.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var i;for(const a of c(this,ot).values())a.editorType===e&&a.show(t);(((i=c(this,lh))==null?void 0:i.get(xe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,q,mr).call(this,[[xe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,ah)!==e){v(this,ah,e);for(const t of c(this,_t).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of c(this,ot).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return c(this,ot).get(e)}addEditor(e){c(this,ot).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(c(this,Vn)&&clearTimeout(c(this,Vn)),v(this,Vn,setTimeout(()=>{this.focusMainContainer(),v(this,Vn,null)},0))),c(this,ot).delete(e.id),e.annotationElementId&&((t=c(this,Ri))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!c(this,Xa).has(e.annotationElementId))&&((s=c(this,_r))==null||s.remove(e.id))}addDeletedAnnotationElement(e){c(this,Xa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,Xa).has(e)}removeDeletedAnnotationElement(e){c(this,Xa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,Ss)!==e&&(v(this,Ss,e),e&&A(this,q,mr).call(this,e.propertiesToUpdate))}updateUI(e){c(this,q,QA)===e&&A(this,q,mr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,q,mr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,Ae).has(e)){c(this,Ae).delete(e),e.unselect(),A(this,q,Xt).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,Ae).add(e),e.select(),A(this,q,mr).call(this,e.propertiesToUpdate),A(this,q,Xt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=c(this,Ni))==null||t.commitOrRemove();for(const s of c(this,Ae))s!==e&&s.unselect();c(this,Ae).clear(),c(this,Ae).add(e),e.select(),A(this,q,mr).call(this,e.propertiesToUpdate),A(this,q,Xt).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,Ae).has(e)}get firstSelectedEditor(){return c(this,Ae).values().next().value}unselect(e){e.unselect(),c(this,Ae).delete(e),A(this,q,Xt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,Ae).size!==0}get isEnterHandled(){return c(this,Ae).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,Qs).undo(),A(this,q,Xt).call(this,{hasSomethingToUndo:c(this,Qs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,q,qu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,Qs).redo(),A(this,q,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,Qs).hasSomethingToRedo(),isEmpty:A(this,q,qu).call(this)})}addCommands(e){c(this,Qs).add(e),A(this,q,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,q,qu).call(this)})}cleanUndoStack(e){c(this,Qs).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,Ae)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(r,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},r=()=>{for(const a of t)A(this,q,Gx).call(this,a)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=c(this,Ss))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,Ss)||this.hasSelection}selectAll(){for(const e of c(this,Ae))e.commit();A(this,q,Xx).call(this,c(this,ot).values())}unselectAll(){var e;if(!(c(this,Ss)&&(c(this,Ss).commitOrRemove(),c(this,ht)!==ae.NONE))&&!((e=c(this,Ni))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,Ae))t.unselect();c(this,Ae).clear(),A(this,q,Xt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;c(this,Ii)[0]+=e,c(this,Ii)[1]+=t;const[r,i]=c(this,Ii),a=[...c(this,Ae)],o=1e3;c(this,Gn)&&clearTimeout(c(this,Gn)),v(this,Gn,setTimeout(()=>{v(this,Gn,null),c(this,Ii)[0]=c(this,Ii)[1]=0,this.addCommands({cmd:()=>{for(const l of a)c(this,ot).has(l.id)&&(l.translateInPage(r,i),l.translationDone())},undo:()=>{for(const l of a)c(this,ot).has(l.id)&&(l.translateInPage(-r,-i),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,Wn,new Map);for(const e of c(this,Ae))c(this,Wn).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Wn))return!1;this.disableUserSelect(!1);const e=c(this,Wn);v(this,Wn,null);let t=!1;for(const[{x:r,y:i,pageIndex:a},o]of e)o.newX=r,o.newY=i,o.newPageIndex=a,t||(t=r!==o.savedX||i!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(r,i,a,o)=>{if(c(this,ot).has(r.id)){const l=c(this,_t).get(o);l?r._setParentAndPosition(l,i,a):(r.pageIndex=o,r.x=i,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:a,newPageIndex:o}]of e)s(r,i,a,o)},undo:()=>{for(const[r,{savedX:i,savedY:a,savedPageIndex:o}]of e)s(r,i,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Wn))for(const s of c(this,Wn).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,Ae).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,Ss)===e}getActive(){return c(this,Ss)}getMode(){return c(this,ht)}get imageManager(){return ge(this,"imageManager",new Ux)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,h=t.rangeCount;d<h;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:s,y:r,width:i,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(d,h,f,p)=>({x:(h-r)/a,y:1-(d+f-s)/i,width:p/a,height:f/i});break;case"180":o=(d,h,f,p)=>({x:1-(d+f-s)/i,y:1-(h+p-r)/a,width:f/i,height:p/a});break;case"270":o=(d,h,f,p)=>({x:1-(h+p-r)/a,y:(d-s)/i,width:p/a,height:f/i});break;default:o=(d,h,f,p)=>({x:(d-s)/i,y:(h-r)/a,width:f/i,height:p/a});break}const l=[];for(let d=0,h=t.rangeCount;d<h;d++){const f=t.getRangeAt(d);if(!f.collapsed)for(const{x:p,y:m,width:y,height:x}of f.getClientRects())y===0||x===0||l.push(o(p,m,y,x))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,lc)||v(this,lc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,lc))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=c(this,lc))==null?void 0:r.get(e.data.id);if(!t)return;const s=c(this,_r).getRawValue(t);s&&(c(this,ht)===ae.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var i;const r=(i=c(this,Ri))==null?void 0:i.get(e);r&&(r.setCanvas(t,s),c(this,Ri).delete(e))}addMissingCanvas(e,t){(c(this,Ri)||v(this,Ri,new Map)).set(e,t)}};ac=new WeakMap,Ss=new WeakMap,ot=new WeakMap,_t=new WeakMap,oc=new WeakMap,_r=new WeakMap,lc=new WeakMap,Qs=new WeakMap,ki=new WeakMap,Ni=new WeakMap,cc=new WeakMap,Xa=new WeakMap,Wn=new WeakMap,yn=new WeakMap,Ka=new WeakMap,nh=new WeakMap,rh=new WeakMap,uc=new WeakMap,ih=new WeakMap,Vn=new WeakMap,ji=new WeakMap,dc=new WeakMap,Ci=new WeakMap,qn=new WeakMap,Ym=new WeakMap,Ti=new WeakMap,ah=new WeakMap,Pi=new WeakMap,Ya=new WeakMap,Qa=new WeakMap,Ri=new WeakMap,oh=new WeakMap,ht=new WeakMap,Ae=new WeakMap,Sr=new WeakMap,Li=new WeakMap,Ja=new WeakMap,lh=new WeakMap,ch=new WeakMap,Ii=new WeakMap,Gn=new WeakMap,Ar=new WeakMap,uh=new WeakMap,dh=new WeakMap,Js=new WeakMap,q=new WeakSet,Mp=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Hx=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of c(this,_t).values())if(s.hasTextLayer(e))return s;return null},zA=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,q,Mp).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(c(this,qn)||v(this,qn,new RR(this)),c(this,qn).show(s,r,this.direction==="ltr"))},HA=function(){var i,a,o;const e=document.getSelection();if(!e||e.isCollapsed){c(this,Sr)&&((i=c(this,qn))==null||i.hide(),v(this,Sr,null),A(this,q,Xt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,Sr))return;const r=A(this,q,Mp).call(this,e).closest(".textLayer");if(!r){c(this,Sr)&&((a=c(this,qn))==null||a.hide(),v(this,Sr,null),A(this,q,Xt).call(this,{hasSelectedText:!1}));return}if((o=c(this,qn))==null||o.hide(),v(this,Sr,t),A(this,q,Xt).call(this,{hasSelectedText:!0}),!(c(this,ht)!==ae.HIGHLIGHT&&c(this,ht)!==ae.NONE)&&(c(this,ht)===ae.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,Ci,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,ht)===ae.HIGHLIGHT?A(this,q,Hx).call(this,r):null;l==null||l.toggleDrawing();const d=new AbortController,h=this.combinedSignal(d),f=p=>{p.type==="pointerup"&&p.button!==0||(d.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&A(this,q,Dp).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}},Dp=function(e=""){c(this,ht)===ae.HIGHLIGHT?this.highlightSelection(e):c(this,nh)&&A(this,q,zA).call(this)},WA=function(){document.addEventListener("selectionchange",A(this,q,HA).bind(this),{signal:this._signal})},VA=function(){if(c(this,ji))return;v(this,ji,new AbortController);const e=this.combinedSignal(c(this,ji));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},qA=function(){var e;(e=c(this,ji))==null||e.abort(),v(this,ji,null)},Wx=function(){if(c(this,Pi))return;v(this,Pi,new AbortController);const e=this.combinedSignal(c(this,Pi));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},GA=function(){var e;(e=c(this,Pi))==null||e.abort(),v(this,Pi,null)},Vx=function(){if(c(this,ki))return;v(this,ki,new AbortController);const e=this.combinedSignal(c(this,ki));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},qx=function(){var e;(e=c(this,ki))==null||e.abort(),v(this,ki,null)},XA=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Xt=function(e){Object.entries(e).some(([s,r])=>c(this,ch)[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,ch),e)}),c(this,ht)===ae.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,q,mr).call(this,[[xe.HIGHLIGHT_FREE,!0]]))},mr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},KA=async function(){if(!c(this,Ti)){v(this,Ti,!0);const e=[];for(const t of c(this,_t).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,ot).values())t.enable()}},YA=function(){if(this.unselectAll(),c(this,Ti)){v(this,Ti,!1);for(const e of c(this,_t).values())e.disable();for(const e of c(this,ot).values())e.disable()}},Gx=function(e){const t=c(this,_t).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},QA=function(){let e=null;for(e of c(this,Ae));return e},qu=function(){if(c(this,ot).size===0)return!0;if(c(this,ot).size===1)for(const e of c(this,ot).values())return e.isEmpty();return!1},Xx=function(e){for(const t of c(this,Ae))t.unselect();c(this,Ae).clear();for(const t of e)t.isEmpty()||(c(this,Ae).add(t),t.select());A(this,q,Xt).call(this,{hasSelectedEditor:this.hasSelection})},W(Gl,"TRANSLATE_SMALL",1),W(Gl,"TRANSLATE_BIG",10);let cl=Gl;var ft,Xn,vn,hc,Kn,As,fc,Yn,ds,Er,Za,Qn,Mi,Ln,Gu,Op;const Kt=class Kt{constructor(e){S(this,Ln);S(this,ft,null);S(this,Xn,!1);S(this,vn,null);S(this,hc,null);S(this,Kn,null);S(this,As,null);S(this,fc,!1);S(this,Yn,null);S(this,ds,null);S(this,Er,null);S(this,Za,null);S(this,Qn,!1);v(this,ds,e),v(this,Qn,e._uiManager.useNewAltTextFlow),c(Kt,Mi)||v(Kt,Mi,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Kt._l10n??(Kt._l10n=e)}async render(){const e=v(this,vn,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=v(this,hc,document.createElement("span"));e.append(t),c(this,Qn)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Kt,Mi).missing),t.setAttribute("data-l10n-id",c(Kt,Mi)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=c(this,ds)._uiManager._signal;e.addEventListener("contextmenu",On,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),c(this,ds)._uiManager.editAltText(c(this,ds)),c(this,Qn)&&c(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,Ln,Gu)}})};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(v(this,fc,!0),r(i))},{signal:s}),await A(this,Ln,Op).call(this),e}finish(){c(this,vn)&&(c(this,vn).focus({focusVisible:c(this,fc)}),v(this,fc,!1))}isEmpty(){return c(this,Qn)?c(this,ft)===null:!c(this,ft)&&!c(this,Xn)}hasData(){return c(this,Qn)?c(this,ft)!==null||!!c(this,Er):this.isEmpty()}get guessedText(){return c(this,Er)}async setGuessedText(e){c(this,ft)===null&&(v(this,Er,e),v(this,Za,await Kt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,Ln,Op).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Qn)||c(this,ft)){(t=c(this,Yn))==null||t.remove(),v(this,Yn,null);return}if(!c(this,Yn)){const s=v(this,Yn,document.createElement("div"));s.className="noAltTextBadge",c(this,ds).div.append(s)}c(this,Yn).classList.toggle("hidden",!e)}serialize(e){let t=c(this,ft);return!e&&c(this,Er)===t&&(t=c(this,Za)),{altText:t,decorative:c(this,Xn),guessedText:c(this,Er),textWithDisclaimer:c(this,Za)}}get data(){return{altText:c(this,ft),decorative:c(this,Xn)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:r,cancel:i=!1}){s&&(v(this,Er,s),v(this,Za,r)),!(c(this,ft)===e&&c(this,Xn)===t)&&(i||(v(this,ft,e),v(this,Xn,t)),A(this,Ln,Op).call(this))}toggle(e=!1){c(this,vn)&&(!e&&c(this,As)&&(clearTimeout(c(this,As)),v(this,As,null)),c(this,vn).disabled=!e)}shown(){c(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,Ln,Gu)}})}destroy(){var e,t;(e=c(this,vn))==null||e.remove(),v(this,vn,null),v(this,hc,null),v(this,Kn,null),(t=c(this,Yn))==null||t.remove(),v(this,Yn,null)}};ft=new WeakMap,Xn=new WeakMap,vn=new WeakMap,hc=new WeakMap,Kn=new WeakMap,As=new WeakMap,fc=new WeakMap,Yn=new WeakMap,ds=new WeakMap,Er=new WeakMap,Za=new WeakMap,Qn=new WeakMap,Mi=new WeakMap,Ln=new WeakSet,Gu=function(){return c(this,ft)&&"added"||c(this,ft)===null&&this.guessedText&&"review"||"missing"},Op=async function(){var r,i,a;const e=c(this,vn);if(!e)return;if(c(this,Qn)){if(e.classList.toggle("done",!!c(this,ft)),e.setAttribute("data-l10n-id",c(Kt,Mi)[c(this,Ln,Gu)]),(r=c(this,hc))==null||r.setAttribute("data-l10n-id",c(Kt,Mi)[`${c(this,Ln,Gu)}-label`]),!c(this,ft)){(i=c(this,Kn))==null||i.remove();return}}else{if(!c(this,ft)&&!c(this,Xn)){e.classList.remove("done"),(a=c(this,Kn))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Kn);if(!t){v(this,Kn,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,ds).id}`;const o=100,l=c(this,ds)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,As)),v(this,As,null)},{once:!0}),e.addEventListener("mouseenter",()=>{v(this,As,setTimeout(()=>{v(this,As,null),c(this,Kn).classList.add("show"),c(this,ds)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var d;c(this,As)&&(clearTimeout(c(this,As)),v(this,As,null)),(d=c(this,Kn))==null||d.classList.remove("show")},{signal:l})}c(this,Xn)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,ft)),t.parentNode||e.append(t);const s=c(this,ds).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},S(Kt,Mi,null),W(Kt,"_l10n",null);let $m=Kt;var pc,eo,hh,fh,ph,mh,gh,kr,to,Nr,so,jr,Sa,JA,ZA,e2;const xw=class xw{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:a=null,signal:o}){S(this,Sa);S(this,pc);S(this,eo,!1);S(this,hh,null);S(this,fh);S(this,ph);S(this,mh);S(this,gh);S(this,kr,null);S(this,to);S(this,Nr,null);S(this,so);S(this,jr,null);v(this,pc,e),v(this,hh,s),v(this,fh,t),v(this,ph,r),v(this,mh,i),v(this,gh,a),v(this,so,new AbortController),v(this,to,AbortSignal.any([o,c(this,so).signal])),e.addEventListener("touchstart",A(this,Sa,JA).bind(this),{passive:!1,signal:c(this,to)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/dr.pixelRatio}destroy(){var e,t;(e=c(this,so))==null||e.abort(),v(this,so,null),(t=c(this,kr))==null||t.abort(),v(this,kr,null)}};pc=new WeakMap,eo=new WeakMap,hh=new WeakMap,fh=new WeakMap,ph=new WeakMap,mh=new WeakMap,gh=new WeakMap,kr=new WeakMap,to=new WeakMap,Nr=new WeakMap,so=new WeakMap,jr=new WeakMap,Sa=new WeakSet,JA=function(e){var r,i,a;if((r=c(this,fh))!=null&&r.call(this))return;if(e.touches.length===1){if(c(this,kr))return;const o=v(this,kr,new AbortController),l=AbortSignal.any([c(this,to),o.signal]),d=c(this,pc),h={capture:!0,signal:l,passive:!1},f=p=>{var m;p.pointerType==="touch"&&((m=c(this,kr))==null||m.abort(),v(this,kr,null))};d.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(et(p),f(p))},h),d.addEventListener("pointerup",f,h),d.addEventListener("pointercancel",f,h);return}if(!c(this,jr)){v(this,jr,new AbortController);const o=AbortSignal.any([c(this,to),c(this,jr).signal]),l=c(this,pc),d={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",A(this,Sa,ZA).bind(this),d);const h=A(this,Sa,e2).bind(this);l.addEventListener("touchend",h,d),l.addEventListener("touchcancel",h,d),d.capture=!0,l.addEventListener("pointerdown",et,d),l.addEventListener("pointermove",et,d),l.addEventListener("pointercancel",et,d),l.addEventListener("pointerup",et,d),(i=c(this,ph))==null||i.call(this)}if(et(e),e.touches.length!==2||(a=c(this,hh))!=null&&a.call(this)){v(this,Nr,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),v(this,Nr,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},ZA=function(e){var k;if(!c(this,Nr)||e.touches.length!==2)return;et(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:r,screenY:i}=t,{screenX:a,screenY:o}=s,l=c(this,Nr),{touch0X:d,touch0Y:h,touch1X:f,touch1Y:p}=l,m=f-d,y=p-h,x=a-r,_=o-i,g=Math.hypot(x,_)||1,w=Math.hypot(m,y)||1;if(!c(this,eo)&&Math.abs(w-g)<=xw.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=i,l.touch1X=a,l.touch1Y=o,!c(this,eo)){v(this,eo,!0);return}const b=[(r+a)/2,(i+o)/2];(k=c(this,mh))==null||k.call(this,b,w,g)},e2=function(e){var t;e.touches.length>=2||(c(this,jr)&&(c(this,jr).abort(),v(this,jr,null),(t=c(this,gh))==null||t.call(this)),c(this,Nr)&&(et(e),v(this,Nr,null),v(this,eo,!1)))};let Bm=xw;var no,wn,Oe,mc,Di,xh,ro,St,io,Cr,Oi,yh,ao,Es,vh,oo,Tr,Jn,gc,xc,Zs,lo,wh,Qm,ne,Kx,bh,Yx,Fp,t2,s2,Qx,$p,Jx,n2,r2,i2,Zx,a2,ey,o2,l2,c2,ty,Xu;const de=class de{constructor(e){S(this,ne);S(this,no,null);S(this,wn,null);S(this,Oe,null);S(this,mc,!1);S(this,Di,null);S(this,xh,"");S(this,ro,!1);S(this,St,null);S(this,io,null);S(this,Cr,null);S(this,Oi,null);S(this,yh,"");S(this,ao,!1);S(this,Es,null);S(this,vh,!1);S(this,oo,!1);S(this,Tr,!1);S(this,Jn,null);S(this,gc,0);S(this,xc,0);S(this,Zs,null);S(this,lo,null);W(this,"isSelected",!1);W(this,"_isCopy",!1);W(this,"_editToolbar",null);W(this,"_initialOptions",Object.create(null));W(this,"_initialData",null);W(this,"_isVisible",!0);W(this,"_uiManager",null);W(this,"_focusEventsAllowed",!0);S(this,wh,!1);S(this,Qm,de._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[i,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=de.prototype._resizeWithKeyboard,t=cl.TRANSLATE_SMALL,s=cl.TRANSLATE_BIG;return ge(this,"_resizerKeyboardManager",new $f([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],de.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ge(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new MR({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(de._l10n??(de._l10n=e),de._l10nResizer||(de._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),de._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);de._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){je("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,wh)}set _isDraggable(e){var t;v(this,wh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,Qm)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):A(this,ne,Xu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,ao)?v(this,ao,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,r){const[i,a]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(e+s)/i,this.y=(t+r)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,r]=this.parentDimensions;this.setAt(e*s,t*r,this.width*s,this.height*r),this._onTranslated()}translate(e,t){A(this,ne,Kx).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,Es)||v(this,Es,[this.x,this.y,this.width,this.height]),A(this,ne,Kx).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){c(this,Es)||v(this,Es,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,d]=this.getBaseTranslation();a+=l,o+=d;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,Es)&&(c(this,Es)[0]!==this.x||c(this,Es)[1]!==this.y)}get _hasBeenResized(){return!!c(this,Es)&&(c(this,Es)[2]!==this.width||c(this,Es)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=de,r=s/e,i=s/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,r]}=this;let{x:i,y:a,width:o,height:l}=this;if(o*=s,l*=r,i*=s,a*=r,this._mustFixPosition)switch(e){case 0:i=es(i,0,s-o),a=es(a,0,r-l);break;case 90:i=es(i,0,s-l),a=es(a,o,r);break;case 180:i=es(i,o,s),a=es(a,l,r);break;case 270:i=es(i,l,s),a=es(a,0,r-o);break}this.x=i/=s,this.y=a/=r;const[d,h]=this.getBaseTranslation();i+=d,a+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=de,bh,Yx).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=de,bh,Yx).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,r]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/s).toFixed(2)}%`,c(this,ro)||(i.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,r=s.endsWith("%"),i=!c(this,ro)&&t.endsWith("%");if(r&&i)return;const[a,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!c(this,ro)&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,Oe))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||c(this,oo))return this._editToolbar;this._editToolbar=new Bx(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=c(this,Oe))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return c(this,Oe)||($m.initialize(de._l10n),v(this,Oe,new $m(this)),c(this,no)&&(c(this,Oe).data=c(this,no),v(this,no,null))),c(this,Oe)}get altTextData(){var e;return(e=c(this,Oe))==null?void 0:e.data}set altTextData(e){c(this,Oe)&&(c(this,Oe).data=e)}get guessedAltText(){var e;return(e=c(this,Oe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,Oe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,Oe))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,Oe)&&!c(this,Oe).isEmpty()}hasAltTextData(){var e;return((e=c(this,Oe))==null?void 0:e.hasData())??!1}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=c(this,mc)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,ne,ey).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),BA(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,lo)||v(this,lo,new Bm({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,ne,n2).bind(this),onPinching:A(this,ne,r2).bind(this),onPinchEnd:A(this,ne,i2).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=Pt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(v(this,ao,!0),this._isDraggable){A(this,ne,a2).call(this,e);return}A(this,ne,Zx).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Jn)&&clearTimeout(c(this,Jn)),v(this,Jn,setTimeout(()=>{var e;v(this,Jn,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const r=this.parentScale,[i,a]=this.pageDimensions,[o,l]=this.pageTranslation,d=e/r,h=t/r,f=this.x*i,p=this.y*a,m=this.width*i,y=this.height*a;switch(s){case 0:return[f+d+o,a-p-h-y+l,f+d+m+o,a-p-h+l];case 90:return[f+h+o,a-p+d+l,f+h+y+o,a-p+d+m+l];case 180:return[f-d-m+o,a-p+h+l,f-d+o,a-p+h+y+l];case 270:return[f-h-y+o,a-p-d-m+l,f-h+o,a-p-d+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,r,i,a]=e,o=i-s,l=a-r;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-r,l,o];case 180:return[i,t-r,o,l];case 270:return[i,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),v(this,oo,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),v(this,oo,!1),!0):!1}isInEditMode(){return c(this,oo)}shouldGetKeyboardEvents(){return c(this,Tr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&r>0&&e<i&&s>0}rebuild(){A(this,ne,ey).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){je("An editor must be serializable")}static async deserialize(e,t,s){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId});r.rotation=e.rotation,v(r,no,e.accessibilityData),r._isCopy=e.isCopy||!1;const[i,a]=r.pageDimensions,[o,l,d,h]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/i,r.y=l/a,r.width=d/i,r.height=h/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=c(this,Oi))==null||e.abort(),v(this,Oi,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Jn)&&(clearTimeout(c(this,Jn)),v(this,Jn,null)),A(this,ne,Xu).call(this),this.removeEditToolbar(),c(this,Zs)){for(const s of c(this,Zs).values())clearTimeout(s);v(this,Zs,null)}this.parent=null,(t=c(this,lo))==null||t.destroy(),v(this,lo,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,ne,t2).call(this),c(this,St).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),v(this,Cr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,St).children;if(!c(this,wn)){v(this,wn,Array.from(t));const a=A(this,ne,o2).bind(this),o=A(this,ne,l2).bind(this),l=this._uiManager._signal;for(const d of c(this,wn)){const h=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",a,{signal:l}),d.addEventListener("blur",o,{signal:l}),d.addEventListener("focus",A(this,ne,c2).bind(this,h),{signal:l}),d.setAttribute("data-l10n-id",de._l10nResizer[h])}}const s=c(this,wn)[0];let r=0;for(const a of t){if(a===s)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(c(this,wn).length/4);if(i!==r){if(i<r)for(let o=0;o<r-i;o++)c(this,St).append(c(this,St).firstChild);else if(i>r)for(let o=0;o<i-r;o++)c(this,St).firstChild.before(c(this,St).lastChild);let a=0;for(const o of t){const d=c(this,wn)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",de._l10nResizer[d])}}A(this,ne,ty).call(this,0),v(this,Tr,!0),c(this,St).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,Tr)&&A(this,ne,Jx).call(this,c(this,yh),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,ne,Xu).call(this),this.div.focus()}select(){var e,t,s;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,i;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(s=c(this,Oe))==null||s.toggleAltTextBadge(!1)}}unselect(){var e,t,s,r,i;this.isSelected&&(this.isSelected=!1,(e=c(this,St))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(i=c(this,Oe))==null||i.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return c(this,vh)}set isEditing(e){v(this,vh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){v(this,ro,!0);const s=e/t,{style:r}=this.div;r.aspectRatio=s,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Zs)||v(this,Zs,new Map);const{action:s}=e;let r=c(this,Zs).get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),c(this,Zs).delete(s),c(this,Zs).size===0&&v(this,Zs,null)},de._telemetryTimeout),c(this,Zs).set(s,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),v(this,mc,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,mc,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};no=new WeakMap,wn=new WeakMap,Oe=new WeakMap,mc=new WeakMap,Di=new WeakMap,xh=new WeakMap,ro=new WeakMap,St=new WeakMap,io=new WeakMap,Cr=new WeakMap,Oi=new WeakMap,yh=new WeakMap,ao=new WeakMap,Es=new WeakMap,vh=new WeakMap,oo=new WeakMap,Tr=new WeakMap,Jn=new WeakMap,gc=new WeakMap,xc=new WeakMap,Zs=new WeakMap,lo=new WeakMap,wh=new WeakMap,Qm=new WeakMap,ne=new WeakSet,Kx=function([e,t],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bh=new WeakSet,Yx=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Fp=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},t2=function(){if(c(this,St))return;v(this,St,document.createElement("div")),c(this,St).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const r=document.createElement("div");c(this,St).append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",A(this,ne,s2).bind(this,s),{signal:t}),r.addEventListener("contextmenu",On,{signal:t}),r.tabIndex=-1}this.div.prepend(c(this,St))},s2=function(e,t){var h;t.preventDefault();const{isMac:s}=Pt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=c(this,Oe))==null||h.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,v(this,io,[t.screenX,t.screenY]);const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,ne,Jx).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",et,{passive:!1,signal:a}),window.addEventListener("contextmenu",On,{signal:a}),v(this,Cr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{var f;i.abort(),this.parent.togglePointerEvents(!0),(f=c(this,Oe))==null||f.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=l,A(this,ne,$p).call(this)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})},Qx=function(e,t,s,r){this.width=s,this.height=r,this.x=e,this.y=t;const[i,a]=this.parentDimensions;this.setDims(i*s,a*r),this.fixAndSetPosition(),this._onResized()},$p=function(){if(!c(this,Cr))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:r}=c(this,Cr);v(this,Cr,null);const i=this.x,a=this.y,o=this.width,l=this.height;i===e&&a===t&&o===s&&l===r||this.addCommands({cmd:A(this,ne,Qx).bind(this,i,a,o,l),undo:A(this,ne,Qx).bind(this,e,t,s,r),mustExec:!0})},Jx=function(e,t){const[s,r]=this.parentDimensions,i=this.x,a=this.y,o=this.width,l=this.height,d=de.MIN_SIZE/s,h=de.MIN_SIZE/r,f=A(this,ne,Fp).call(this,this.rotation),p=(B,I)=>[f[0]*B+f[2]*I,f[1]*B+f[3]*I],m=A(this,ne,Fp).call(this,360-this.rotation),y=(B,I)=>[m[0]*B+m[2]*I,m[1]*B+m[3]*I];let x,_,g=!1,w=!1;switch(e){case"topLeft":g=!0,x=(B,I)=>[0,0],_=(B,I)=>[B,I];break;case"topMiddle":x=(B,I)=>[B/2,0],_=(B,I)=>[B/2,I];break;case"topRight":g=!0,x=(B,I)=>[B,0],_=(B,I)=>[0,I];break;case"middleRight":w=!0,x=(B,I)=>[B,I/2],_=(B,I)=>[0,I/2];break;case"bottomRight":g=!0,x=(B,I)=>[B,I],_=(B,I)=>[0,0];break;case"bottomMiddle":x=(B,I)=>[B/2,I],_=(B,I)=>[B/2,0];break;case"bottomLeft":g=!0,x=(B,I)=>[0,I],_=(B,I)=>[B,0];break;case"middleLeft":w=!0,x=(B,I)=>[0,I/2],_=(B,I)=>[B,I/2];break}const b=x(o,l),k=_(o,l);let E=p(...k);const N=de._round(i+E[0]),j=de._round(a+E[1]);let T=1,M=1,F,R;if(t.fromKeyboard)({deltaX:F,deltaY:R}=t);else{const{screenX:B,screenY:I}=t,[P,O]=c(this,io);[F,R]=this.screenToPageTranslation(B-P,I-O),c(this,io)[0]=B,c(this,io)[1]=I}if([F,R]=y(F/s,R/r),g){const B=Math.hypot(o,l);T=M=Math.max(Math.min(Math.hypot(k[0]-b[0]-F,k[1]-b[1]-R)/B,1/o,1/l),d/o,h/l)}else w?T=es(Math.abs(k[0]-b[0]-F),d,1)/o:M=es(Math.abs(k[1]-b[1]-R),h,1)/l;const V=de._round(o*T),$=de._round(l*M);E=p(..._(V,$));const D=N-E[0],Z=j-E[1];c(this,Es)||v(this,Es,[this.x,this.y,this.width,this.height]),this.width=V,this.height=$,this.x=D,this.y=Z,this.setDims(s*V,r*$),this.fixAndSetPosition(),this._onResizing()},n2=function(){var e;v(this,Cr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,Oe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},r2=function(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const a=A(this,ne,Fp).call(this,this.rotation),o=(N,j)=>[a[0]*N+a[2]*j,a[1]*N+a[3]*j],[l,d]=this.parentDimensions,h=this.x,f=this.y,p=this.width,m=this.height,y=de.MIN_SIZE/l,x=de.MIN_SIZE/d;i=Math.max(Math.min(i,1/p,1/m),y/p,x/m);const _=de._round(p*i),g=de._round(m*i);if(_===p&&g===m)return;c(this,Es)||v(this,Es,[h,f,p,m]);const w=o(p/2,m/2),b=de._round(h+w[0]),k=de._round(f+w[1]),E=o(_/2,g/2);this.x=b-E[0],this.y=k-E[1],this.width=_,this.height=g,this.setDims(l*_,d*g),this.fixAndSetPosition(),this._onResizing()},i2=function(){var e;(e=c(this,Oe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,ne,$p).call(this)},Zx=function(e){const{isMac:t}=Pt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},a2=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:i},o=d=>{r.abort(),v(this,Di,null),v(this,ao,!1),this._uiManager.endDragSession()||A(this,ne,Zx).call(this,d),s&&this._onStopDragging()};t&&(v(this,gc,e.clientX),v(this,xc,e.clientY),v(this,Di,e.pointerId),v(this,xh,e.pointerType),window.addEventListener("pointermove",d=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:f,pointerId:p}=d;if(p!==c(this,Di)){et(d);return}const[m,y]=this.screenToPageTranslation(h-c(this,gc),f-c(this,xc));v(this,gc,h),v(this,xc,f),this._uiManager.dragSelectedEditors(m,y)},a),window.addEventListener("touchmove",et,a),window.addEventListener("pointerdown",d=>{d.pointerType===c(this,xh)&&(c(this,lo)||d.isPrimary)&&o(d),et(d)},a));const l=d=>{if(!c(this,Di)||c(this,Di)===d.pointerId){o(d);return}et(d)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},ey=function(){if(c(this,Oi)||!this.div)return;v(this,Oi,new AbortController);const e=this._uiManager.combinedSignal(c(this,Oi));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},o2=function(e){de._resizerKeyboardManager.exec(this,e)},l2=function(e){var t;c(this,Tr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,St)&&A(this,ne,Xu).call(this)},c2=function(e){v(this,yh,c(this,Tr)?e:"")},ty=function(e){if(c(this,wn))for(const t of c(this,wn))t.tabIndex=e},Xu=function(){v(this,Tr,!1),A(this,ne,ty).call(this,-1),A(this,ne,$p).call(this)},S(de,bh),W(de,"_l10n",null),W(de,"_l10nResizer",null),W(de,"_borderLineWidth",-1),W(de,"_colorManager",new zx),W(de,"_zIndex",1),W(de,"_telemetryTimeout",1e3);let Le=de;class MR extends Le{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const o1=3285377520,Xs=4294901760,Un=65535;class u2{constructor(e){this.h1=e?e&4294967295:o1,this.h2=e?e&4294967295:o1}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let x=0,_=e.length;x<_;x++){const g=e.charCodeAt(x);g<=255?t[s++]=g:(t[s++]=g>>>8,t[s++]=g&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,i=s-r*4,a=new Uint32Array(t.buffer,0,r);let o=0,l=0,d=this.h1,h=this.h2;const f=3432918353,p=461845907,m=f&Un,y=p&Un;for(let x=0;x<r;x++)x&1?(o=a[x],o=o*f&Xs|o*m&Un,o=o<<15|o>>>17,o=o*p&Xs|o*y&Un,d^=o,d=d<<13|d>>>19,d=d*5+3864292196):(l=a[x],l=l*f&Xs|l*m&Un,l=l<<15|l>>>17,l=l*p&Xs|l*y&Un,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*f&Xs|o*m&Un,o=o<<15|o>>>17,o=o*p&Xs|o*y&Un,r&1?d^=o:h^=o}this.h1=d,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Xs|e*36045&Un,t=t*4283543511&Xs|((t<<16|e>>>16)*2950163797&Xs)>>>16,e^=t>>>1,e=e*444984403&Xs|e*60499&Un,t=t*3301882366&Xs|((t<<16|e>>>16)*3120437893&Xs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const sy=Object.freeze({map:null,hash:"",transfer:void 0});var co,uo,At,Jm,d2;class uw{constructor(){S(this,Jm);S(this,co,!1);S(this,uo,null);S(this,At,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=c(this,At).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return c(this,At).get(e)}remove(e){if(c(this,At).delete(e),c(this,At).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,At).values())if(t instanceof Le)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=c(this,At).get(e);let r=!1;if(s!==void 0)for(const[i,a]of Object.entries(t))s[i]!==a&&(r=!0,s[i]=a);else r=!0,c(this,At).set(e,t);r&&A(this,Jm,d2).call(this),t instanceof Le&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,At).has(e)}get size(){return c(this,At).size}resetModified(){c(this,co)&&(v(this,co,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new h2(this)}get serializable(){if(c(this,At).size===0)return sy;const e=new Map,t=new u2,s=[],r=Object.create(null);let i=!1;for(const[a,o]of c(this,At)){const l=o instanceof Le?o.serialize(!1,r):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:sy}get editorStats(){let e=null;const t=new Map;for(const s of c(this,At).values()){if(!(s instanceof Le))continue;const r=s.telemetryFinalData;if(!r)continue;const{type:i}=r;t.has(i)||t.set(i,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[i]||(e[i]=new Map);for(const[o,l]of Object.entries(r)){if(o==="type")continue;let d=a.get(o);d||(d=new Map,a.set(o,d));const h=d.get(l)??0;d.set(l,h+1)}}for(const[s,r]of t)e[s]=r.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){v(this,uo,null)}get modifiedIds(){if(c(this,uo))return c(this,uo);const e=[];for(const t of c(this,At).values())!(t instanceof Le)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return v(this,uo,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return c(this,At).entries()}}co=new WeakMap,uo=new WeakMap,At=new WeakMap,Jm=new WeakSet,d2=function(){c(this,co)||(v(this,co,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var _h;class h2 extends uw{constructor(t){super();S(this,_h);const{map:s,hash:r,transfer:i}=t.serializable,a=structuredClone(s,i?{transfer:i}:null);v(this,_h,{map:a,hash:r,transfer:i})}get print(){je("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,_h)}get modifiedIds(){return ge(this,"modifiedIds",{ids:new Set,hash:""})}}_h=new WeakMap;var yc;class DR{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){S(this,yc,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,yc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||c(this,yc).has(e.loadedName))){if(st(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:a}=e,o=new FontFace(r,i,a);this.addNativeFontFace(o);try{await o.load(),c(this,yc).add(r),s==null||s(e)}catch{oe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}je("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw oe(`Failed to load font '${s.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ge(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ge(this,"isSyncFontLoadingSupported",Zt||Pt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(st(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:t,callback:e};return s.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ge(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(k,E){return k.charCodeAt(E)<<24|k.charCodeAt(E+1)<<16|k.charCodeAt(E+2)<<8|k.charCodeAt(E+3)&255}function r(k,E,N,j){const T=k.substring(0,E),M=k.substring(E+N);return T+j+M}let i,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let d=0;function h(k,E){if(++d>30){oe("Load test font never loaded."),E();return}if(l.font="30px "+k,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(h.bind(null,k,E))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=r(p,976,f.length,f);const y=16,x=1482184792;let _=s(p,y);for(i=0,a=f.length-3;i<a;i+=4)_=_-x+s(f,i)|0;i<f.length&&(_=_-x+s(f+"XXX",i)|0),p=r(p,y,4,wR(_));const g=`url(data:font/opentype;base64,${btoa(p)});`,w=`@font-face {font-family:"${f}";src:${g}}`;this.insertRule(w);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const k of[e.loadedName,f]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=k,b.append(E)}this._document.body.append(b),h(f,()=>{b.remove(),t.complete()})}}yc=new WeakMap;class OR{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${LA(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let r;try{r=e.get(s)}catch(a){oe(`getPathGenerator - ignoring character: "${a}".`)}const i=new Path2D(r||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}}function FR(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Zt)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function $R(n){if(Zt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Df(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const ny=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,BR=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",UR=ER.bind(null,ny,BR);var Pr,Zm;class zR{constructor(){S(this,Pr,new Map);S(this,Zm,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};c(this,Zm).then(()=>{for(const[r]of c(this,Pr))r.call(this,s)})}addEventListener(e,t,s=null){let r=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:i}=s;if(i.aborted){oe("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}c(this,Pr).set(t,r)}removeEventListener(e,t){const s=c(this,Pr).get(t);s==null||s(),c(this,Pr).delete(t)}terminate(){for(const[,e]of c(this,Pr))e==null||e();c(this,Pr).clear()}}Pr=new WeakMap,Zm=new WeakMap;const fp={DATA:1,ERROR:2},Je={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function l1(){}function cs(n){if(n instanceof wa||n instanceof Ox||n instanceof r1||n instanceof Fm||n instanceof A0)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||je('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new wa(n.message);case"InvalidPDFException":return new Ox(n.message);case"PasswordException":return new r1(n.message,n.code);case"ResponseException":return new Fm(n.message,n.status,n.missing);case"UnknownErrorException":return new A0(n.message,n.details)}return new A0(n.message,n.toString())}var vc,un,f2,p2,m2,Bp;class Ku{constructor(e,t,s){S(this,un);S(this,vc,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,un,f2).bind(this),{signal:c(this,vc).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},s)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,s,r){const i=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:d=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:d,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:d.desiredSize},r),h.promise},pull:d=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Je.PULL,streamId:i,desiredSize:d.desiredSize}),h.promise},cancel:d=>{st(d instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Je.CANCEL,streamId:i,reason:cs(d)}),h.promise}},s)}destroy(){var e;(e=c(this,vc))==null||e.abort(),v(this,vc,null)}}vc=new WeakMap,un=new WeakSet,f2=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,un,m2).call(this,e);return}if(e.callback){const s=e.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===fp.DATA)r.resolve(e.data);else if(e.callback===fp.ERROR)r.reject(cs(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(a){i.postMessage({sourceName:s,targetName:r,callback:fp.DATA,callbackId:e.callbackId,data:a})},function(a){i.postMessage({sourceName:s,targetName:r,callback:fp.ERROR,callbackId:e.callbackId,reason:cs(a)})});return}if(e.streamId){A(this,un,p2).call(this,e);return}t(e.data)},p2=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(d,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:r,stream:Je.ENQUEUE,streamId:t,chunk:d},f)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Je.CLOSE,streamId:t}),delete a.streamSinks[t])},error(d){st(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Je.ERROR,streamId:t,reason:cs(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Je.START_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:s,targetName:r,stream:Je.START_COMPLETE,streamId:t,reason:cs(d)})})},m2=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Je.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(cs(e.reason));break;case Je.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(cs(e.reason));break;case Je.PULL:if(!o){i.postMessage({sourceName:s,targetName:r,stream:Je.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||l1).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Je.PULL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:s,targetName:r,stream:Je.PULL_COMPLETE,streamId:t,reason:cs(d)})});break;case Je.ENQUEUE:if(st(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Je.CLOSE:if(st(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,un,Bp).call(this,a,t);break;case Je.ERROR:st(a,"error should have stream controller"),a.controller.error(cs(e.reason)),A(this,un,Bp).call(this,a,t);break;case Je.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(cs(e.reason)),A(this,un,Bp).call(this,a,t);break;case Je.CANCEL:if(!o)break;const l=cs(e.reason);Promise.try(o.onCancel||l1,l).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Je.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:s,targetName:r,stream:Je.CANCEL_COMPLETE,streamId:t,reason:cs(d)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Bp=async function(e,t){var s,r,i;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(r=e.pullCall)==null?void 0:r.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var Sh;class g2{constructor({enableHWA:e=!1}){S(this,Sh,!1);v(this,Sh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!c(this,Sh)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){je("Abstract method `_createCanvas` called.")}}Sh=new WeakMap;class HR extends g2{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class x2{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){je("Abstract method `_fetch` called.")}}class c1 extends x2{async _fetch(e){const t=await Of(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Df(t)}}class y2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,r,i){return"none"}destroy(e=!1){}}var ho,wc,Rr,Lr,Bt,fo,po,K,Ot,Yu,Nl,Up,jl,v2,ry,Cl,Qu,Ju,iy,Zu;class WR extends y2{constructor({docId:t,ownerDocument:s=globalThis.document}){super();S(this,K);S(this,ho);S(this,wc);S(this,Rr);S(this,Lr);S(this,Bt);S(this,fo);S(this,po,0);v(this,Lr,t),v(this,Bt,s)}addFilter(t){if(!t)return"none";let s=c(this,K,Ot).get(t);if(s)return s;const[r,i,a]=A(this,K,Up).call(this,t),o=t.length===1?r:`${r}${i}${a}`;if(s=c(this,K,Ot).get(o),s)return c(this,K,Ot).set(t,s),s;const l=`g_${c(this,Lr)}_transfer_map_${Gt(this,po)._++}`,d=A(this,K,jl).call(this,l);c(this,K,Ot).set(t,d),c(this,K,Ot).set(o,d);const h=A(this,K,Cl).call(this,l);return A(this,K,Ju).call(this,r,i,a,h),d}addHCMFilter(t,s){var y;const r=`${t}-${s}`,i="base";let a=c(this,K,Yu).get(i);if((a==null?void 0:a.key)===r||(a?((y=a.filter)==null||y.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},c(this,K,Yu).set(i,a)),!t||!s))return a.url;const o=A(this,K,Zu).call(this,t);t=te.makeHexColor(...o);const l=A(this,K,Zu).call(this,s);if(s=te.makeHexColor(...l),c(this,K,Nl).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const d=new Array(256);for(let x=0;x<=255;x++){const _=x/255;d[x]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=d.join(","),f=`g_${c(this,Lr)}_hcm_filter`,p=a.filter=A(this,K,Cl).call(this,f);A(this,K,Ju).call(this,h,h,h,p),A(this,K,ry).call(this,p);const m=(x,_)=>{const g=o[x]/255,w=l[x]/255,b=new Array(_+1);for(let k=0;k<=_;k++)b[k]=g+k/_*(w-g);return b.join(",")};return A(this,K,Ju).call(this,m(0,5),m(1,5),m(2,5),p),a.url=A(this,K,jl).call(this,f),a.url}addAlphaFilter(t){let s=c(this,K,Ot).get(t);if(s)return s;const[r]=A(this,K,Up).call(this,[t]),i=`alpha_${r}`;if(s=c(this,K,Ot).get(i),s)return c(this,K,Ot).set(t,s),s;const a=`g_${c(this,Lr)}_alpha_map_${Gt(this,po)._++}`,o=A(this,K,jl).call(this,a);c(this,K,Ot).set(t,o),c(this,K,Ot).set(i,o);const l=A(this,K,Cl).call(this,a);return A(this,K,iy).call(this,r,l),o}addLuminosityFilter(t){let s=c(this,K,Ot).get(t||"luminosity");if(s)return s;let r,i;if(t?([r]=A(this,K,Up).call(this,[t]),i=`luminosity_${r}`):i="luminosity",s=c(this,K,Ot).get(i),s)return c(this,K,Ot).set(t,s),s;const a=`g_${c(this,Lr)}_luminosity_map_${Gt(this,po)._++}`,o=A(this,K,jl).call(this,a);c(this,K,Ot).set(t,o),c(this,K,Ot).set(i,o);const l=A(this,K,Cl).call(this,a);return A(this,K,v2).call(this,l),t&&A(this,K,iy).call(this,r,l),o}addHighlightHCMFilter(t,s,r,i,a){var w;const o=`${s}-${r}-${i}-${a}`;let l=c(this,K,Yu).get(t);if((l==null?void 0:l.key)===o||(l?((w=l.filter)==null||w.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},c(this,K,Yu).set(t,l)),!s||!r))return l.url;const[d,h]=[s,r].map(A(this,K,Zu).bind(this));let f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,y]=[i,a].map(A(this,K,Zu).bind(this));p<f&&([f,p,m,y]=[p,f,y,m]),c(this,K,Nl).style.color="";const x=(b,k,E)=>{const N=new Array(256),j=(p-f)/E,T=b/255,M=(k-b)/(255*E);let F=0;for(let R=0;R<=E;R++){const V=Math.round(f+R*j),$=T+R*M;for(let D=F;D<=V;D++)N[D]=$;F=V+1}for(let R=F;R<256;R++)N[R]=N[F-1];return N.join(",")},_=`g_${c(this,Lr)}_hcm_${t}_filter`,g=l.filter=A(this,K,Cl).call(this,_);return A(this,K,ry).call(this,g),A(this,K,Ju).call(this,x(m[0],y[0],5),x(m[1],y[1],5),x(m[2],y[2],5),g),l.url=A(this,K,jl).call(this,_),l.url}destroy(t=!1){var s,r,i,a;t&&((s=c(this,fo))!=null&&s.size)||((r=c(this,Rr))==null||r.parentNode.parentNode.remove(),v(this,Rr,null),(i=c(this,wc))==null||i.clear(),v(this,wc,null),(a=c(this,fo))==null||a.clear(),v(this,fo,null),v(this,po,0))}}ho=new WeakMap,wc=new WeakMap,Rr=new WeakMap,Lr=new WeakMap,Bt=new WeakMap,fo=new WeakMap,po=new WeakMap,K=new WeakSet,Ot=function(){return c(this,wc)||v(this,wc,new Map)},Yu=function(){return c(this,fo)||v(this,fo,new Map)},Nl=function(){if(!c(this,Rr)){const t=c(this,Bt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const r=c(this,Bt).createElementNS(pr,"svg");r.setAttribute("width",0),r.setAttribute("height",0),v(this,Rr,c(this,Bt).createElementNS(pr,"defs")),t.append(r),r.append(c(this,Rr)),c(this,Bt).body.append(t)}return c(this,Rr)},Up=function(t){if(t.length===1){const d=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=d[p]/255;const f=h.join(",");return[f,f,f]}const[s,r,i]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let d=0;d<256;d++)a[d]=s[d]/255,o[d]=r[d]/255,l[d]=i[d]/255;return[a.join(","),o.join(","),l.join(",")]},jl=function(t){if(c(this,ho)===void 0){v(this,ho,"");const s=c(this,Bt).URL;s!==c(this,Bt).baseURI&&($g(s)?oe('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,ho,TA(s,"")))}return`url(${c(this,ho)}#${t})`},v2=function(t){const s=c(this,Bt).createElementNS(pr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},ry=function(t){const s=c(this,Bt).createElementNS(pr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Cl=function(t){const s=c(this,Bt).createElementNS(pr,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),c(this,K,Nl).append(s),s},Qu=function(t,s,r){const i=c(this,Bt).createElementNS(pr,s);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)},Ju=function(t,s,r,i){const a=c(this,Bt).createElementNS(pr,"feComponentTransfer");i.append(a),A(this,K,Qu).call(this,a,"feFuncR",t),A(this,K,Qu).call(this,a,"feFuncG",s),A(this,K,Qu).call(this,a,"feFuncB",r)},iy=function(t,s){const r=c(this,Bt).createElementNS(pr,"feComponentTransfer");s.append(r),A(this,K,Qu).call(this,r,"feFuncA",t)},Zu=function(t){return c(this,K,Nl).style.color=t,cw(getComputedStyle(c(this,K,Nl)).getPropertyValue("color"))};class w2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){je("Abstract method `_fetch` called.")}}class u1 extends w2{async _fetch(e){const t=await Of(e,"arraybuffer");return new Uint8Array(t)}}class b2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){je("Abstract method `_fetch` called.")}}class d1 extends b2{async _fetch(e){const t=await Of(e,"arraybuffer");return new Uint8Array(t)}}Zt&&oe("Please use the `legacy` build in Node.js environments.");async function dw(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class VR extends y2{}class qR extends g2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class GR extends x2{async _fetch(e){return dw(e)}}class XR extends w2{async _fetch(e){return dw(e)}}class KR extends b2{async _fetch(e){return dw(e)}}const jt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ay(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,s),n.clip(r)}class hw{isModifyingCurrentTransform(){return!1}getPattern(){je("Abstract method `getPattern` called.")}}class YR extends hw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,r){let i;if(r===jt.STROKE||r===jt.FILL){const a=t.current.getClippedPathBoundingBox(r,ze(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,d=t.cachedCanvases.getCanvas("pattern",o,l),h=d.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=te.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),ay(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(d.canvas,"no-repeat");const f=new DOMMatrix(s);i.setTransform(f)}else ay(e,this._bbox),i=this._createGradient(e);return i}}function N0(n,e,t,s,r,i,a,o){const l=e.coords,d=e.colors,h=n.data,f=n.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=i,i=a,a=p),l[s+1]>l[r+1]&&(p=s,s=r,r=p,p=a,a=o,o=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=i,i=a,a=p);const m=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,x=(l[s]+e.offsetX)*e.scaleX,_=(l[s+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,w=(l[r+1]+e.offsetY)*e.scaleY;if(y>=w)return;const b=d[i],k=d[i+1],E=d[i+2],N=d[a],j=d[a+1],T=d[a+2],M=d[o],F=d[o+1],R=d[o+2],V=Math.round(y),$=Math.round(w);let D,Z,B,I,P,O,L,H;for(let G=V;G<=$;G++){if(G<_){const le=G<y?0:(y-G)/(y-_);D=m-(m-x)*le,Z=b-(b-N)*le,B=k-(k-j)*le,I=E-(E-T)*le}else{let le;G>w?le=1:_===w?le=0:le=(_-G)/(_-w),D=x-(x-g)*le,Z=N-(N-M)*le,B=j-(j-F)*le,I=T-(T-R)*le}let ie;G<y?ie=0:G>w?ie=1:ie=(y-G)/(y-w),P=m-(m-g)*ie,O=b-(b-M)*ie,L=k-(k-F)*ie,H=E-(E-R)*ie;const U=Math.round(Math.min(D,P)),X=Math.round(Math.max(D,P));let he=f*G+U*4;for(let le=U;le<=X;le++)ie=(D-le)/(D-P),ie<0?ie=0:ie>1&&(ie=1),h[he++]=Z-(Z-O)*ie|0,h[he++]=B-(B-L)*ie|0,h[he++]=I-(I-H)*ie|0,h[he++]=255}}function QR(n,e,t){const s=e.coords,r=e.colors;let i,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,d=o-1;for(i=0;i<l;i++){let h=i*o;for(let f=0;f<d;f++,h++)N0(n,t,s[h],s[h+1],s[h+o],r[h],r[h+1],r[h+o]),N0(n,t,s[h+o+1],s[h+1],s[h+o],r[h+o+1],r[h+1],r[h+o])}break;case"triangles":for(i=0,a=s.length;i<a;i+=3)N0(n,t,s[i],s[i+1],s[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class JR extends hw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=d/f,y=h/p,x={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/m,scaleY:1/y},_=f+2*2,g=p+2*2,w=s.getCanvas("mesh",_,g),b=w.context,k=b.createImageData(f,p);if(t){const N=k.data;for(let j=0,T=N.length;j<T;j+=4)N[j]=t[0],N[j+1]=t[1],N[j+2]=t[2],N[j+3]=255}for(const N of this._figures)QR(k,N,x);return b.putImageData(k,2,2),{canvas:w.canvas,offsetX:o-2*m,offsetY:l-2*y,scaleX:m,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,r){ay(e,this._bbox);const i=new Float32Array(2);if(r===jt.SHADING)te.singularValueDecompose2dScale(ze(e),i);else if(this.matrix){te.singularValueDecompose2dScale(this.matrix,i);const[o,l]=i;te.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=o,i[1]*=l}else te.singularValueDecompose2dScale(t.baseTransform,i);const a=this._createMeshCanvas(i,r===jt.SHADING?null:this._background,t.cachedCanvases);return r!==jt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class ZR extends hw{getPattern(){return"hotpink"}}function eL(n){switch(n[0]){case"RadialAxial":return new YR(n);case"Mesh":return new JR(n);case"Dummy":return new ZR}throw new Error(`Unknown IR type: ${n[0]}`)}const h1={COLORED:1,UNCOLORED:2},eg=class eg{constructor(e,t,s,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:r,tilingType:i,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:d}=this;l=Math.abs(l),d=Math.abs(d),Fg("TilingType: "+i);const h=t[0],f=t[1],p=t[2],m=t[3],y=p-h,x=m-f,_=new Float32Array(2);te.singularValueDecompose2dScale(this.matrix,_);const[g,w]=_;te.singularValueDecompose2dScale(this.baseTransform,_);const b=g*_[0],k=w*_[1];let E=y,N=x,j=!1,T=!1;const M=Math.ceil(l*b),F=Math.ceil(d*k),R=Math.ceil(y*b),V=Math.ceil(x*k);M>=R?E=l:j=!0,F>=V?N=d:T=!0;const $=this.getSizeAndScale(E,this.ctx.canvas.width,b),D=this.getSizeAndScale(N,this.ctx.canvas.height,k),Z=e.cachedCanvases.getCanvas("pattern",$.size,D.size),B=Z.context,I=o.createCanvasGraphics(B);if(I.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(I,r,a),B.translate(-$.scale*h,-D.scale*f),I.transform($.scale,0,0,D.scale,0,0),B.save(),this.clipBbox(I,h,f,p,m),I.baseTransform=ze(I.ctx),I.executeOperatorList(s),I.endDrawing(),B.restore(),j||T){const P=Z.canvas;j&&(E=l),T&&(N=d);const O=this.getSizeAndScale(E,this.ctx.canvas.width,b),L=this.getSizeAndScale(N,this.ctx.canvas.height,k),H=O.size,G=L.size,ie=e.cachedCanvases.getCanvas("pattern-workaround",H,G),U=ie.context,X=j?Math.floor(y/l):0,he=T?Math.floor(x/d):0;for(let le=0;le<=X;le++)for(let Lt=0;Lt<=he;Lt++)U.drawImage(P,H*le,G*Lt,H,G,0,0,H,G);return{canvas:ie.canvas,scaleX:O.scale,scaleY:L.scale,offsetX:h,offsetY:f}}return{canvas:Z.canvas,scaleX:$.scale,scaleY:D.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,s){const r=Math.max(eg.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=r?i=r:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,r,i){const a=r-t,o=i-s;e.ctx.rect(t,s,a,o),te.axialAlignedBoundingBox([t,s,r,i],ze(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const r=e.ctx,i=e.current;switch(t){case h1.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;r.fillStyle=i.fillColor=a,r.strokeStyle=i.strokeColor=o;break;case h1.UNCOLORED:r.fillStyle=r.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new vR(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,r){let i=s;r!==jt.SHADING&&(i=te.transform(i,t.baseTransform),this.matrix&&(i=te.transform(i,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};W(eg,"MAX_PATTERN_SIZE",3e3);let oy=eg;function tL({src:n,srcPos:e=0,dest:t,width:s,height:r,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const o=Pt.isLittleEndian?4278190080:255,[l,d]=a?[i,o]:[o,i],h=s>>3,f=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let y=0;y<r;y++){for(const _=e+h;e<_;e++){const g=e<p?n[e]:255;t[m++]=g&128?d:l,t[m++]=g&64?d:l,t[m++]=g&32?d:l,t[m++]=g&16?d:l,t[m++]=g&8?d:l,t[m++]=g&4?d:l,t[m++]=g&2?d:l,t[m++]=g&1?d:l}if(f===0)continue;const x=e<p?n[e++]:255;for(let _=0;_<f;_++)t[m++]=x&1<<7-_?d:l}return{srcPos:e,destPos:m}}const f1=16,p1=100,sL=15,m1=10,ps=16,j0=new DOMMatrix,$s=new Float32Array(2),ql=new Float32Array([1/0,1/0,-1/0,-1/0]);function nL(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,r,i,a,o){e.transform(t,s,r,i,a,o),this.__originalTransform(t,s,r,i,a,o)},n.setTransform=function(t,s,r,i,a,o){e.setTransform(t,s,r,i,a,o),this.__originalSetTransform(t,s,r,i,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,r,i,a,o){e.bezierCurveTo(t,s,r,i,a,o),this.__originalBezierCurveTo(t,s,r,i,a,o)},n.rect=function(t,s,r,i){e.rect(t,s,r,i),this.__originalRect(t,s,r,i)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class rL{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,s)):(r=this.canvasFactory.create(t,s),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function pp(n,e,t,s,r,i,a,o,l,d){const[h,f,p,m,y,x]=ze(n);if(f===0&&p===0){const w=a*h+y,b=Math.round(w),k=o*m+x,E=Math.round(k),N=(a+l)*h+y,j=Math.abs(Math.round(N)-b)||1,T=(o+d)*m+x,M=Math.abs(Math.round(T)-E)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),b,E),n.drawImage(e,t,s,r,i,0,0,j,M),n.setTransform(h,f,p,m,y,x),[j,M]}if(h===0&&m===0){const w=o*p+y,b=Math.round(w),k=a*f+x,E=Math.round(k),N=(o+d)*p+y,j=Math.abs(Math.round(N)-b)||1,T=(a+l)*f+x,M=Math.abs(Math.round(T)-E)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,b,E),n.drawImage(e,t,s,r,i,0,0,M,j),n.setTransform(h,f,p,m,y,x),[M,j]}n.drawImage(e,t,s,r,i,a,o,l,d);const _=Math.hypot(h,f),g=Math.hypot(p,m);return[_*l,g*d]}class g1{constructor(e,t){W(this,"alphaIsShape",!1);W(this,"fontSize",0);W(this,"fontSizeScale",1);W(this,"textMatrix",null);W(this,"textMatrixScale",1);W(this,"fontMatrix",Dx);W(this,"leading",0);W(this,"x",0);W(this,"y",0);W(this,"lineX",0);W(this,"lineY",0);W(this,"charSpacing",0);W(this,"wordSpacing",0);W(this,"textHScale",1);W(this,"textRenderingMode",Dt.FILL);W(this,"textRise",0);W(this,"fillColor","#000000");W(this,"strokeColor","#000000");W(this,"patternFill",!1);W(this,"patternStroke",!1);W(this,"fillAlpha",1);W(this,"strokeAlpha",1);W(this,"lineWidth",1);W(this,"activeSMask",null);W(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ql.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=jt.FILL,t=null){const s=this.minMax.slice();if(e===jt.STROKE){t||je("Stroke bounding box must include transform."),te.singularValueDecompose2dScale(t,$s);const r=$s[0]*this.lineWidth/2,i=$s[1]*this.lineWidth/2;s[0]-=r,s[1]-=i,s[2]+=r,s[3]+=i}return s}updateClipFromPath(){const e=te.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ql,0)}getClippedPathBoundingBox(e=jt.FILL,t=null){return te.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function x1(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,r=t%ps,i=(t-r)/ps,a=r===0?i:i+1,o=n.createImageData(s,ps);let l=0,d;const h=e.data,f=o.data;let p,m,y,x;if(e.kind===Pp.GRAYSCALE_1BPP){const _=h.byteLength,g=new Uint32Array(f.buffer,0,f.byteLength>>2),w=g.length,b=s+7>>3,k=4294967295,E=Pt.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(y=p<i?ps:r,d=0,m=0;m<y;m++){const N=_-l;let j=0;const T=N>b?s:N*8-7,M=T&-8;let F=0,R=0;for(;j<M;j+=8)R=h[l++],g[d++]=R&128?k:E,g[d++]=R&64?k:E,g[d++]=R&32?k:E,g[d++]=R&16?k:E,g[d++]=R&8?k:E,g[d++]=R&4?k:E,g[d++]=R&2?k:E,g[d++]=R&1?k:E;for(;j<T;j++)F===0&&(R=h[l++],F=128),g[d++]=R&F?k:E,F>>=1}for(;d<w;)g[d++]=0;n.putImageData(o,0,p*ps)}}else if(e.kind===Pp.RGBA_32BPP){for(m=0,x=s*ps*4,p=0;p<i;p++)f.set(h.subarray(l,l+x)),l+=x,n.putImageData(o,0,m),m+=ps;p<a&&(x=s*r*4,f.set(h.subarray(l,l+x)),n.putImageData(o,0,m))}else if(e.kind===Pp.RGB_24BPP)for(y=ps,x=s*y,p=0;p<a;p++){for(p>=i&&(y=r,x=s*y),d=0,m=x;m--;)f[d++]=h[l++],f[d++]=h[l++],f[d++]=h[l++],f[d++]=255;n.putImageData(o,0,p*ps)}else throw new Error(`bad image kind: ${e.kind}`)}function y1(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,r=t%ps,i=(t-r)/ps,a=r===0?i:i+1,o=n.createImageData(s,ps);let l=0;const d=e.data,h=o.data;for(let f=0;f<a;f++){const p=f<i?ps:r;({srcPos:l}=tL({src:d,srcPos:l,dest:h,width:s,height:p,nonBlackColor:0})),n.putImageData(o,0,f*ps)}}function Mu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function mp(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function v1(n,e){if(e)return!0;te.singularValueDecompose2dScale(n,$s);const t=Math.fround(dr.pixelRatio*ba.PDF_TO_CSS_UNITS);return $s[0]<=t&&$s[1]<=t}const iL=["butt","round","square"],aL=["miter","round","bevel"],oL={},w1={};var Fn,ly,cy,uy;const yw=class yw{constructor(e,t,s,r,i,{optionalContentConfig:a,markedContentStack:o=null},l,d){S(this,Fn);this.ctx=e,this.current=new g1(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new rL(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:r=null}){const i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",i,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ze(this.compositeCtx))}this.ctx.save(),mp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ze(this.ctx)}executeOperatorList(e,t,s,r){const i=e.argsArray,a=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const d=l-o>m1&&typeof s=="function",h=d?Date.now()+sL:0;let f=0;const p=this.commonObjs,m=this.objs;let y;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,s),o;if(y=a[o],y!==Om.dependency)this[y].apply(this,i[o]);else for(const x of i[o]){const _=x.startsWith("g_")?p:m;if(!_.has(x))return _.get(x,s),o}if(o++,o===l)return o;if(d&&++f>m1){if(Date.now()>h)return s(),o;f=0}}}endDrawing(){A(this,Fn,ly).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,Fn,cy).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=r,d="prescale1",h,f;for(;i>2&&o>1||a>2&&l>1;){let p=o,m=l;i>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/p),a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/m),h=this.cachedCanvases.getCanvas(d,p,m),f=h.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,o,l,0,0,p,m),e=h.canvas,o=p,l=m,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:r}=e,i=this.current.fillColor,a=this.current.patternFill,o=ze(t);let l,d,h,f;if((e.bitmap||e.data)&&e.count>1){const M=e.bitmap||e.data.buffer;d=JSON.stringify(a?o:[o.slice(0,4),i]),l=this._cachedBitmapsMap.get(M),l||(l=new Map,this._cachedBitmapsMap.set(M,l));const F=l.get(d);if(F&&!a){const R=Math.round(Math.min(o[0],o[2])+o[4]),V=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:F,offsetX:R,offsetY:V}}h=F}h||(f=this.cachedCanvases.getCanvas("maskCanvas",s,r),y1(f.context,e));let p=te.transform(o,[1/s,0,0,-1/r,0,0]);p=te.transform(p,[1,0,0,1,0,-r]);const m=ql.slice();te.axialAlignedBoundingBox([0,0,s,r],p,m);const[y,x,_,g]=m,w=Math.round(_-y)||1,b=Math.round(g-x)||1,k=this.cachedCanvases.getCanvas("fillCanvas",w,b),E=k.context,N=y,j=x;E.translate(-N,-j),E.transform(...p),h||(h=this._scaleImage(f.canvas,Bn(E)),h=h.img,l&&a&&l.set(d,h)),E.imageSmoothingEnabled=v1(ze(E),e.interpolate),pp(E,h,0,0,h.width,h.height,0,0,s,r),E.globalCompositeOperation="source-in";const T=te.transform(Bn(E),[1,0,0,1,-N,-j]);return E.fillStyle=a?i.getPattern(t,this,T,jt.FILL):i,E.fillRect(0,0,s,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(d,k.canvas)),{canvas:k.canvas,offsetX:Math.round(N),offsetY:Math.round(j)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=iL[e]}setLineJoin(e){this.ctx.lineJoin=aL[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const i=this.ctx=r.context;i.setTransform(this.suspendedCtx.getTransform()),Mu(this.suspendedCtx,i),nL(i,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Mu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,r){const i=r[0],a=r[1],o=r[2]-i,l=r[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,r,i,a,o,l,d,h,f){let p=e.canvas,m=l-h,y=d-f;if(a)if(m<0||y<0||m+s>p.width||y+r>p.height){const _=this.cachedCanvases.getCanvas("maskExtension",s,r),g=_.context;g.drawImage(p,-m,-y),g.globalCompositeOperation="destination-atop",g.fillStyle=a,g.fillRect(0,0,s,r),g.globalCompositeOperation="source-over",p=_.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(m,y,s,r),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(m,y,s,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const x=new Path2D;x.rect(l,d,s,r),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(p,m,y,s,r,l,d,s,r),t.restore()}save(){this.inSMaskMode&&Mu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Mu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,r,i,a){this.ctx.transform(e,t,s,r,i,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[r]=t;if(!s){r||(r=t[0]=new Path2D),this[e](r);return}if(!(r instanceof Path2D)){const i=t[0]=new Path2D;for(let a=0,o=r.length;a<o;)switch(r[a++]){case dp.moveTo:i.moveTo(r[a++],r[a++]);break;case dp.lineTo:i.lineTo(r[a++],r[a++]);break;case dp.curveTo:i.bezierCurveTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++]);break;case dp.closePath:i.closePath();break;default:oe(`Unrecognized drawing path operator: ${r[a-1]}`);break}r=i}te.axialAlignedBoundingBox(s,ze(this.ctx),this.current.minMax),this[e](r)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const i=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,Bn(s),jt.STROKE),i){const a=new Path2D;a.addPath(e,s.getTransform().invertSelf().multiplySelf(i)),e=a}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(jt.STROKE,ze(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,r=this.current.fillColor,i=this.current.patternFill;let a=!1;if(i){const l=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=r.getPattern(s,this,Bn(s),jt.FILL),l){const d=new Path2D;d.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=d}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),a&&s.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=oL}eoClip(){this.pendingClip=w1}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,r=t.getTransform().invertSelf();for(const{transform:i,x:a,y:o,fontSize:l,path:d}of e)s.addPath(d,new DOMMatrix(i).preMultiplySelf(r).translate(a,o).scale(l,-l));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),r=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=s.fontMatrix||Dx,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&oe("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const i=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${i}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let d=t;t<f1?d=f1:t>p1&&(d=p1),this.current.fontSizeScale=t/d,this.ctx.font=`${l} ${o} ${d}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,r,i){const a=this.ctx,o=this.current,l=o.font,d=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,f=d&Dt.FILL_STROKE_MASK,p=!!(d&Dt.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile,y=o.patternStroke&&!l.missingFile;let x;if((l.disableFontFace||p||m||y)&&(x=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||y){a.save(),a.translate(t,s),a.scale(h,-h);let _;if((f===Dt.FILL||f===Dt.FILL_STROKE)&&(r?(_=a.getTransform(),a.setTransform(...r),a.fill(A(this,Fn,uy).call(this,x,_,r))):a.fill(x)),f===Dt.STROKE||f===Dt.FILL_STROKE)if(i){_||(_=a.getTransform()),a.setTransform(...i);const{a:g,b:w,c:b,d:k}=_,E=te.inverseTransform(i),N=te.transform([g,w,b,k,0,0],E);te.singularValueDecompose2dScale(N,$s),a.lineWidth*=Math.max($s[0],$s[1])/h,a.stroke(A(this,Fn,uy).call(this,x,_,i))}else a.lineWidth/=h,a.stroke(x);a.restore()}else(f===Dt.FILL||f===Dt.FILL_STROKE)&&a.fillText(e,t,s),(f===Dt.STROKE||f===Dt.FILL_STROKE)&&a.strokeText(e,t,s);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ze(a),x:t,y:s,fontSize:h,path:x})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){s=!0;break}return ge(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const i=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,d=t.fontDirection,h=t.textHScale*d,f=e.length,p=s.vertical,m=p?1:-1,y=s.defaultVMetrics,x=r*t.fontMatrix[0],_=t.textRenderingMode===Dt.FILL&&!s.disableFontFace&&!t.patternFill;i.save(),t.textMatrix&&i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),d>0?i.scale(h,-1):i.scale(h,1);let g,w;if(t.patternFill){i.save();const j=t.fillColor.getPattern(i,this,Bn(i),jt.FILL);g=ze(i),i.restore(),i.fillStyle=j}if(t.patternStroke){i.save();const j=t.strokeColor.getPattern(i,this,Bn(i),jt.STROKE);w=ze(i),i.restore(),i.strokeStyle=j}let b=t.lineWidth;const k=t.textMatrixScale;if(k===0||b===0){const j=t.textRenderingMode&Dt.FILL_STROKE_MASK;(j===Dt.STROKE||j===Dt.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=k;if(a!==1&&(i.scale(a,a),b/=a),i.lineWidth=b,s.isInvalidPDFjsFont){const j=[];let T=0;for(const M of e)j.push(M.unicode),T+=M.width;i.fillText(j.join(""),0,0),t.x+=T*x*h,i.restore(),this.compose();return}let E=0,N;for(N=0;N<f;++N){const j=e[N];if(typeof j=="number"){E+=m*j*r/1e3;continue}let T=!1;const M=(j.isSpace?l:0)+o,F=j.fontChar,R=j.accent;let V,$,D=j.width;if(p){const B=j.vmetric||y,I=-(j.vmetric?B[1]:D*.5)*x,P=B[2]*x;D=B?-B[0]:D,V=I/a,$=(E+P)/a}else V=E/a,$=0;if(s.remeasure&&D>0){const B=i.measureText(F).width*1e3/r*a;if(D<B&&this.isFontSubpixelAAEnabled){const I=D/B;T=!0,i.save(),i.scale(I,1),V/=I}else D!==B&&(V+=(D-B)/2e3*r/a)}if(this.contentVisible&&(j.isInFont||s.missingFile)){if(_&&!R)i.fillText(F,V,$);else if(this.paintChar(F,V,$,g,w),R){const B=V+r*R.offset.x/a,I=$-r*R.offset.y/a;this.paintChar(R.fontChar,B,I,g,w)}}const Z=p?D*x-M*d:D*x+M*d;E+=Z,T&&i.restore()}p?t.y-=E:t.x+=E*h,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,r=s.font,i=s.fontSize,a=s.fontDirection,o=r.vertical?1:-1,l=s.charSpacing,d=s.wordSpacing,h=s.textHScale*a,f=s.fontMatrix||Dx,p=e.length,m=s.textRenderingMode===Dt.INVISIBLE;let y,x,_,g;if(!(m||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(h,a),y=0;y<p;++y){if(x=e[y],typeof x=="number"){g=o*x*i/1e3,this.ctx.translate(g,0),s.x+=g*h;continue}const w=(x.isSpace?d:0)+l,b=r.charProcOperatorList[x.operatorListId];b?this.contentVisible&&(this.save(),t.scale(i,i),t.transform(...f),this.executeOperatorList(b),this.restore()):oe(`Type3 character "${x.operatorListId}" is not available.`);const k=[x.width,0];te.applyTransform(k,f),_=k[0]*i+w,t.translate(_,0),s.x+=_*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,r,i,a){const o=new Path2D;o.rect(s,r,i-s,a-r),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||ze(this.ctx),r={createCanvasGraphics:i=>new yw(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new oy(e,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=eL(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Bn(t),jt.SHADING);const r=Bn(t);if(r){const{width:i,height:a}=t.canvas,o=ql.slice();te.axialAlignedBoundingBox([0,0,i,a],r,o);const[l,d,h,f]=o;this.ctx.fillRect(l,d,h-l,f-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){je("Should not call beginInlineImage")}beginImageData(){je("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ze(this.ctx),t)){te.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,r,i,a]=t,o=new Path2D;o.rect(s,r,i-s,a-r),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Fg("TODO: Support non-isolated groups."),e.knockout&&oe("Knockout groups not supported.");const s=ze(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=ql.slice();te.axialAlignedBoundingBox(e.bbox,ze(t),r);const i=[0,0,t.canvas.width,t.canvas.height];r=te.intersect(r,i)||[0,0,0,0];const a=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),d=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,d]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,l,d),p=f.context;p.translate(-a,-o),p.transform(...s);let m=new Path2D;const[y,x,_,g]=e.bbox;if(m.rect(y,x,_-y,g-x),e.matrix){const w=new Path2D;w.addPath(m,new DOMMatrix(e.matrix)),m=w}p.clip(m),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Mu(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=ze(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const i=ql.slice();te.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r,i),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,s,r,i){if(A(this,Fn,ly).call(this),mp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,te.singularValueDecompose2dScale(ze(this.ctx),$s);const{viewportScale:l}=this,d=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform($s[0],0,0,-$s[1],0,o*$s[1]),mp(this.ctx)}else{mp(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new g1(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,Fn,cy).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,r=this._createMaskCanvas(e),i=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(i,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,r=0,i,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=ze(o);o.transform(t,s,r,i,0,0);const d=this._createMaskCanvas(e);o.setTransform(1,0,0,1,d.offsetX-l[4],d.offsetY-l[5]);for(let h=0,f=a.length;h<f;h+=2){const p=te.transform(l,[t,s,r,i,a[h],a[h+1]]);o.drawImage(d.canvas,p[4],p[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,r=this.current.patternFill;for(const i of e){const{data:a,width:o,height:l,transform:d}=i,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=h.context;f.save();const p=this.getObject(a,i);y1(f,p),f.globalCompositeOperation="source-in",f.fillStyle=r?s.getPattern(f,this,Bn(t),jt.FILL):s,f.fillRect(0,0,o,l),f.restore(),t.save(),t.transform(...d),t.scale(1,-1),pp(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){oe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,r){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){oe("Dependent image isn't ready yet");return}const a=i.width,o=i.height,l=[];for(let d=0,h=r.length;d<h;d+=2)l.push({transform:[t,0,0,s,r[d],r[d+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,r),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,r=this.ctx;this.save();const{filter:i}=r;i!=="none"&&i!==""&&(r.filter="none"),r.scale(1/t,-1/s);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,s).context;x1(d,e),a=this.applyTransferMapsToCanvas(d)}const o=this._scaleImage(a,Bn(r));r.imageSmoothingEnabled=v1(ze(r),e.interpolate),pp(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const i=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,a).context;x1(l,e),r=this.applyTransferMapsToCanvas(l)}for(const i of t)s.save(),s.transform(...i.transform),s.scale(1,-1),pp(s,r,i.x,i.y,i.w,i.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const r=this.ctx;this.pendingClip&&(s||(this.pendingClip===w1?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ze(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:r,d:i}=this.ctx.getTransform();let a,o;if(s===0&&r===0){const l=Math.abs(t),d=Math.abs(i);if(l===d)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/d;else{const h=l*e,f=d*e;a=h<1?1/h:1,o=f<1?1/f:1}}else{const l=Math.abs(t*i-s*r),d=Math.hypot(t,s),h=Math.hypot(r,i);if(e===0)a=h/l,o=d/l;else{const f=e*l;a=h>f?h/f:1,o=d>f?d/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:r}}=this,[i,a]=this.getScaleForStroking();if(i===a){s.lineWidth=(r||1)*i,s.stroke(e);return}const o=s.getLineDash();t&&s.save(),s.scale(i,a),j0.a=1/i,j0.d=1/a;const l=new Path2D;if(l.addPath(e,j0),o.length>0){const d=Math.max(i,a);s.setLineDash(o.map(h=>h/d)),s.lineDashOffset/=d}s.lineWidth=r||1,s.stroke(l),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Fn=new WeakSet,ly=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},cy=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},uy=function(e,t,s){const r=new Path2D;return r.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),r};let sc=yw;for(const n in Om)sc.prototype[n]!==void 0&&(sc.prototype[Om[n]]=sc.prototype[n]);var Ah,Eh;class lr{static get workerPort(){return c(this,Ah)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");v(this,Ah,e)}static get workerSrc(){return c(this,Eh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");v(this,Eh,e)}}Ah=new WeakMap,Eh=new WeakMap,S(lr,Ah,null),S(lr,Eh,"");var bc,kh;class lL{constructor({parsedData:e,rawData:t}){S(this,bc);S(this,kh);v(this,bc,e),v(this,kh,t)}getRaw(){return c(this,kh)}get(e){return c(this,bc).get(e)??null}[Symbol.iterator](){return c(this,bc).entries()}}bc=new WeakMap,kh=new WeakMap;const Tl=Symbol("INTERNAL");var Nh,jh,Ch,_c;class cL{constructor(e,{name:t,intent:s,usage:r,rbGroups:i}){S(this,Nh,!1);S(this,jh,!1);S(this,Ch,!1);S(this,_c,!0);v(this,Nh,!!(e&Os.DISPLAY)),v(this,jh,!!(e&Os.PRINT)),this.name=t,this.intent=s,this.usage=r,this.rbGroups=i}get visible(){if(c(this,Ch))return c(this,_c);if(!c(this,_c))return!1;const{print:e,view:t}=this.usage;return c(this,Nh)?(t==null?void 0:t.viewState)!=="OFF":c(this,jh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Tl&&je("Internal method `_setVisible` called."),v(this,Ch,s),v(this,_c,t)}}Nh=new WeakMap,jh=new WeakMap,Ch=new WeakMap,_c=new WeakMap;var Fi,ke,Sc,Ac,Th,dy;class uL{constructor(e,t=Os.DISPLAY){S(this,Th);S(this,Fi,null);S(this,ke,new Map);S(this,Sc,null);S(this,Ac,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,v(this,Ac,e.order);for(const s of e.groups)c(this,ke).set(s.id,new cL(t,s));if(e.baseState==="OFF")for(const s of c(this,ke).values())s._setVisible(Tl,!1);for(const s of e.on)c(this,ke).get(s)._setVisible(Tl,!0);for(const s of e.off)c(this,ke).get(s)._setVisible(Tl,!1);v(this,Sc,this.getHash())}}isVisible(e){if(c(this,ke).size===0)return!0;if(!e)return Fg("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,ke).has(e.id)?c(this,ke).get(e.id).visible:(oe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Th,dy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,ke).has(t))return oe(`Optional content group not found: ${t}`),!0;if(c(this,ke).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,ke).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!c(this,ke).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,ke).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!c(this,ke).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,ke).has(t))return oe(`Optional content group not found: ${t}`),!0;if(c(this,ke).get(t).visible)return!1}return!0}return oe(`Unknown optional content policy ${e.policy}.`),!0}return oe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var i;const r=c(this,ke).get(e);if(!r){oe(`Optional content group not found: ${e}`);return}if(s&&t&&r.rbGroups.length)for(const a of r.rbGroups)for(const o of a)o!==e&&((i=c(this,ke).get(o))==null||i._setVisible(Tl,!1,!0));r._setVisible(Tl,!!t,!0),v(this,Fi,null)}setOCGState({state:e,preserveRB:t}){let s;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const i=c(this,ke).get(r);if(i)switch(s){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}v(this,Fi,null)}get hasInitialVisibility(){return c(this,Sc)===null||this.getHash()===c(this,Sc)}getOrder(){return c(this,ke).size?c(this,Ac)?c(this,Ac).slice():[...c(this,ke).keys()]:null}getGroup(e){return c(this,ke).get(e)||null}getHash(){if(c(this,Fi)!==null)return c(this,Fi);const e=new u2;for(const[t,s]of c(this,ke))e.update(`${t}:${s.visible}`);return v(this,Fi,e.hexdigest())}[Symbol.iterator](){return c(this,ke).entries()}}Fi=new WeakMap,ke=new WeakMap,Sc=new WeakMap,Ac=new WeakMap,Th=new WeakSet,dy=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let r=1;r<t;r++){const i=e[r];let a;if(Array.isArray(i))a=A(this,Th,dy).call(this,i);else if(c(this,ke).has(i))a=c(this,ke).get(i).visible;else return oe(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class dL{constructor(e,{disableRange:t=!1,disableStream:s=!1}){st(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,d)=>{this._onReceiveData({begin:l,chunk:d})}),e.addProgressListener((l,d)=>{this._onProgress({loaded:l,total:d})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});st(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,r,i;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(i=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||i.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){st(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new hL(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new fL(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class hL{constructor(e,t,s=!1,r=null){this._stream=e,this._done=s||!1,this._filename=ow(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class fL{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function pL(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=d(h),i(h)}if(t=a(n),t){const h=d(t);return i(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=d(h),i(h)}function s(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function r(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),m=Df(f);f=p.decode(m),e=!1}catch{}}return f}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=r("utf-8",h),e&&(h=r("iso-8859-1",h))),h}function a(h){const f=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(h))!==null;){let[,x,_,g]=p;if(x=parseInt(x,10),x in f){if(x===0)break;continue}f[x]=[_,g]}const y=[];for(let x=0;x<f.length&&x in f;++x){let[_,g]=f[x];g=o(g),_&&(g=unescape(g),x===0&&(g=l(g))),y.push(g)}return y.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),y=h.slice(f+1).replace(/^[^']*'/,"");return r(p,y)}function d(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,_){return String.fromCharCode(parseInt(_,16))}),r(p,y);try{y=atob(y)}catch{}return r(p,y)})}return""}function _2(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const r=e[s];r!==void 0&&t.append(s,r)}return t}function Bg(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function S2({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function A2(n){const e=n.get("Content-Disposition");if(e){let t=pL(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(ow(t))return t}return null}function Bf(n,e){return new Fm(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function E2(n){return n===200||n===206}function k2(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function N2(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(oe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class mL{constructor(e){W(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=_2(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return st(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new gL(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new xL(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class gL{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),r=t.url;fetch(r,k2(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Bg(i.url),!E2(i.status))throw Bf(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const a=i.headers,{allowRangeRequests:o,suggestedLength:l}=S2({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=A2(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new wa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:N2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class xL{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const a=r.url;fetch(a,k2(i,this._withCredentials,this._abortController)).then(o=>{const l=Bg(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!E2(o.status))throw Bf(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:N2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const C0=200,T0=206;function yL(n){const e=n.response;return typeof e!="string"?e:Df(e).buffer}class vL{constructor({url:e,httpHeaders:t,withCredentials:s}){W(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=_2(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=T0):r.expectedStatus=C0,t.responseType="arraybuffer",st(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var r;const s=this.pendingRequests[e];s&&((r=s.onProgress)==null||r.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){s.onError(r.status);return}const i=r.status||C0;if(!(i===C0&&s.expectedStatus===T0)&&i!==s.expectedStatus){s.onError(r.status);return}const o=yL(r);if(i===T0){const l=r.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);d?s.onDone({begin:parseInt(d[1],10),chunk:o}):(oe('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class wL{constructor(e){this._source=e,this._manager=new vL(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return st(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new bL(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new _L(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class bL{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Bg(t.responseURL);const s=t.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...d]=o.split(": ");return[l,d.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:a}=S2({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=A2(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Bf(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _L{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Bg((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Bf(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const SL=/^[a-z][a-z0-9\-+.]+:/i;function AL(n){if(SL.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class EL{constructor(e){this.source=e,this.url=AL(e.url),st(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return st(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new kL(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new NL(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class kL{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Bf(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new wa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class NL{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Du=Symbol("INITIAL_DATA");var ks,Ph,hy;class j2{constructor(){S(this,Ph);S(this,ks,Object.create(null))}get(e,t=null){if(t){const r=A(this,Ph,hy).call(this,e);return r.promise.then(()=>t(r.data)),null}const s=c(this,ks)[e];if(!s||s.data===Du)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=c(this,ks)[e];return!!t&&t.data!==Du}delete(e){const t=c(this,ks)[e];return!t||t.data===Du?!1:(delete c(this,ks)[e],!0)}resolve(e,t=null){const s=A(this,Ph,hy).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in c(this,ks)){const{data:s}=c(this,ks)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}v(this,ks,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,ks)){const{data:t}=c(this,ks)[e];t!==Du&&(yield[e,t])}}}ks=new WeakMap,Ph=new WeakSet,hy=function(e){var t;return(t=c(this,ks))[e]||(t[e]={...Promise.withResolvers(),data:Du})};const jL=1e5,b1=30;var k1,$i,hs,Rh,Lh,mo,Ir,Ih,Mh,go,Ec,kc,Bi,Nc,Dh,jc,xo,Oh,Fh,Cc,yo,$h,Ui,Tc,ci,C2,T2,fy,Ws,zp,py,P2,R2;const it=class it{constructor({textContentSource:e,container:t,viewport:s}){S(this,ci);S(this,$i,Promise.withResolvers());S(this,hs,null);S(this,Rh,!1);S(this,Lh,!!((k1=globalThis.FontInspector)!=null&&k1.enabled));S(this,mo,null);S(this,Ir,null);S(this,Ih,0);S(this,Mh,0);S(this,go,null);S(this,Ec,null);S(this,kc,0);S(this,Bi,0);S(this,Nc,Object.create(null));S(this,Dh,[]);S(this,jc,null);S(this,xo,[]);S(this,Oh,new WeakMap);S(this,Fh,null);var l;if(e instanceof ReadableStream)v(this,jc,e);else if(typeof e=="object")v(this,jc,new ReadableStream({start(d){d.enqueue(e),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,hs,v(this,Ec,t)),v(this,Bi,s.scale*dr.pixelRatio),v(this,kc,s.rotation),v(this,Ir,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:i,pageX:a,pageY:o}=s.rawDims;v(this,Fh,[1,0,0,-1,-a,o+i]),v(this,Mh,r),v(this,Ih,i),A(l=it,Ws,P2).call(l),ll(t,s),c(this,$i).promise.finally(()=>{c(it,Tc).delete(this),v(this,Ir,null),v(this,Nc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Pt.platform;return ge(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,go).read().then(({value:t,done:s})=>{if(s){c(this,$i).resolve();return}c(this,mo)??v(this,mo,t.lang),Object.assign(c(this,Nc),t.styles),A(this,ci,C2).call(this,t.items),e()},c(this,$i).reject)};return v(this,go,c(this,jc).getReader()),c(it,Tc).add(this),e(),c(this,$i).promise}update({viewport:e,onBefore:t=null}){var i;const s=e.scale*dr.pixelRatio,r=e.rotation;if(r!==c(this,kc)&&(t==null||t(),v(this,kc,r),ll(c(this,Ec),{rotation:r})),s!==c(this,Bi)){t==null||t(),v(this,Bi,s);const a={div:null,properties:null,ctx:A(i=it,Ws,zp).call(i,c(this,mo))};for(const o of c(this,xo))a.properties=c(this,Oh).get(o),a.div=o,A(this,ci,fy).call(this,a)}}cancel(){var t;const e=new wa("TextLayer task cancelled.");(t=c(this,go))==null||t.cancel(e).catch(()=>{}),v(this,go,null),c(this,$i).reject(e)}get textDivs(){return c(this,xo)}get textContentItemsStr(){return c(this,Dh)}static cleanup(){if(!(c(this,Tc).size>0)){c(this,Cc).clear();for(const{canvas:e}of c(this,yo).values())e.remove();c(this,yo).clear()}}};$i=new WeakMap,hs=new WeakMap,Rh=new WeakMap,Lh=new WeakMap,mo=new WeakMap,Ir=new WeakMap,Ih=new WeakMap,Mh=new WeakMap,go=new WeakMap,Ec=new WeakMap,kc=new WeakMap,Bi=new WeakMap,Nc=new WeakMap,Dh=new WeakMap,jc=new WeakMap,xo=new WeakMap,Oh=new WeakMap,Fh=new WeakMap,Cc=new WeakMap,yo=new WeakMap,$h=new WeakMap,Ui=new WeakMap,Tc=new WeakMap,ci=new WeakSet,C2=function(e){var r,i;if(c(this,Rh))return;(i=c(this,Ir)).ctx??(i.ctx=A(r=it,Ws,zp).call(r,c(this,mo)));const t=c(this,xo),s=c(this,Dh);for(const a of e){if(t.length>jL){oe("Ignoring additional textDivs for performance reasons."),v(this,Rh,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=c(this,hs);v(this,hs,document.createElement("span")),c(this,hs).classList.add("markedContent"),a.id!==null&&c(this,hs).setAttribute("id",`${a.id}`),o.append(c(this,hs))}else a.type==="endMarkedContent"&&v(this,hs,c(this,hs).parentNode);continue}s.push(a.str),A(this,ci,T2).call(this,a)}},T2=function(e){var x;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,xo).push(t);const r=te.transform(c(this,Fh),e.transform);let i=Math.atan2(r[1],r[0]);const a=c(this,Nc)[e.fontName];a.vertical&&(i+=Math.PI/2);let o=c(this,Lh)&&a.fontSubstitution||a.fontFamily;o=it.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),d=l*A(x=it,Ws,R2).call(x,o,a,c(this,mo));let h,f;i===0?(h=r[4],f=r[5]-d):(h=r[4]+d*Math.sin(i),f=r[5]-d*Math.cos(i));const p="calc(var(--total-scale-factor) *",m=t.style;c(this,hs)===c(this,Ec)?(m.left=`${(100*h/c(this,Mh)).toFixed(2)}%`,m.top=`${(100*f/c(this,Ih)).toFixed(2)}%`):(m.left=`${p}${h.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(c(it,Ui)*l).toFixed(2)}px)`,m.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,Lh)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),g=Math.abs(e.transform[3]);_!==g&&Math.max(_,g)/Math.min(_,g)>1.5&&(y=!0)}if(y&&(s.canvasWidth=a.vertical?e.height:e.width),c(this,Oh).set(t,s),c(this,Ir).div=t,c(this,Ir).properties=s,A(this,ci,fy).call(this,c(this,Ir)),s.hasText&&c(this,hs).append(t),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),c(this,hs).append(_)}},fy=function(e){var o;const{div:t,properties:s,ctx:r}=e,{style:i}=t;let a="";if(c(it,Ui)>1&&(a=`scale(${1/c(it,Ui)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=i,{canvasWidth:d,fontSize:h}=s;A(o=it,Ws,py).call(o,r,h*c(this,Bi),l);const{width:f}=r.measureText(t.textContent);f>0&&(a=`scaleX(${d*c(this,Bi)/f}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(i.transform=a)},Ws=new WeakSet,zp=function(e=null){let t=c(this,yo).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,yo).set(e,t),c(this,$h).set(t,{size:0,family:""})}return t},py=function(e,t,s){const r=c(this,$h).get(e);t===r.size&&s===r.family||(e.font=`${t}px ${s}`,r.size=t,r.family=s)},P2=function(){if(c(this,Ui)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),v(this,Ui,e.getBoundingClientRect().height),e.remove()},R2=function(e,t,s){const r=c(this,Cc).get(e);if(r)return r;const i=A(this,Ws,zp).call(this,s);i.canvas.width=i.canvas.height=b1,A(this,Ws,py).call(this,i,b1,e);const a=i.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let d=.8;return o?d=o/(o+l):(Pt.platform.isFirefox&&oe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),c(this,Cc).set(e,d),d},S(it,Ws),S(it,Cc,new Map),S(it,yo,new Map),S(it,$h,new WeakMap),S(it,Ui,null),S(it,Tc,new Set);let Xd=it;class Kd{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function r(i){var l;if(!i)return;let a=null;const o=i.name;if(o==="#text")a=i.value;else if(Kd.shouldBuildText(o))(l=i==null?void 0:i.attributes)!=null&&l.textContent?a=i.attributes.textContent:i.value&&(a=i.value);else return;if(a!==null&&t.push({str:a}),!!i.children)for(const d of i.children)r(d)}return r(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const CL=100;function L2(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new my,{docId:t}=e,s=n.url?FR(n.url):null,r=n.data?$R(n.data):null,i=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof I2?n.range:null,d=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof Yd?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!$g(n.docBaseUrl)?n.docBaseUrl:null,m=hp(n.cMapUrl),y=n.cMapPacked!==!1,x=n.CMapReaderFactory||(Zt?GR:c1),_=hp(n.iccUrl),g=hp(n.standardFontDataUrl),w=n.StandardFontDataFactory||(Zt?XR:u1),b=hp(n.wasmUrl),k=n.WasmFactory||(Zt?KR:d1),E=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,j=n.isEvalSupported!==!1,T=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Zt,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Zt&&(Pt.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,R=typeof n.disableFontFace=="boolean"?n.disableFontFace:Zt,V=n.fontExtraProperties===!0,$=n.enableXfa===!0,D=n.ownerDocument||globalThis.document,Z=n.disableRange===!0,B=n.disableStream===!0,I=n.disableAutoFetch===!0,P=n.pdfBug===!0,O=n.CanvasFactory||(Zt?qR:HR),L=n.FilterFactory||(Zt?VR:WR),H=n.enableHWA===!0,G=n.useWasm!==!1,ie=l?l.length:n.length??NaN,U=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Zt&&!R,X=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(x===c1&&w===u1&&k===d1&&m&&g&&b&&Wu(m,document.baseURI)&&Wu(g,document.baseURI)&&Wu(b,document.baseURI)),he=null;gR(f);const le={canvasFactory:new O({ownerDocument:D,enableHWA:H}),filterFactory:new L({docId:t,ownerDocument:D}),cMapReaderFactory:X?null:new x({baseUrl:m,isCompressed:y}),standardFontDataFactory:X?null:new w({baseUrl:g}),wasmFactory:X?null:new k({baseUrl:b})};h||(h=Yd.create({verbosity:f,port:lr.workerPort}),e._worker=h);const Lt={docId:t,apiVersion:"5.3.93",data:r,password:o,disableAutoFetch:I,rangeChunkSize:d,length:ie,docBaseUrl:p,enableXfa:$,evaluatorOptions:{maxImageSize:N,disableFontFace:R,ignoreErrors:E,isEvalSupported:j,isOffscreenCanvasSupported:T,isImageDecoderSupported:M,canvasMaxAreaInBytes:F,fontExtraProperties:V,useSystemFonts:U,useWasm:G,useWorkerFetch:X,cMapUrl:m,iccUrl:_,standardFontDataUrl:g,wasmUrl:b}},yl={ownerDocument:D,pdfBug:P,styleElement:he,loadingParams:{disableAutoFetch:I,enableXfa:$}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Pa=h.messageHandler.sendWithPromise("GetDocRequest",Lt,r?[r.buffer]:null);let di;if(l)di=new dL(l,{disableRange:Z,disableStream:B});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const vl=Wu(s)?mL:Zt?EL:wL;di=new vl({url:s,length:ie,httpHeaders:i,withCredentials:a,rangeChunkSize:d,disableRange:Z,disableStream:B})}return Pa.then(vl=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Su=new Ku(t,vl,h.port),zf=new RL(Su,e,di,yl,le);e._transport=zf,Su.send("Ready",null)})}).catch(e._capability.reject),e}var tg;const sg=class sg{constructor(){W(this,"_capability",Promise.withResolvers());W(this,"_transport",null);W(this,"_worker",null);W(this,"docId",`d${Gt(sg,tg)._++}`);W(this,"destroyed",!1);W(this,"onPassword",null);W(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};tg=new WeakMap,S(sg,tg,0);let my=sg;var vo,Bh,Uh,zh,Hh;class I2{constructor(e,t,s=!1,r=null){S(this,vo,Promise.withResolvers());S(this,Bh,[]);S(this,Uh,[]);S(this,zh,[]);S(this,Hh,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(e){c(this,Hh).push(e)}addProgressListener(e){c(this,zh).push(e)}addProgressiveReadListener(e){c(this,Uh).push(e)}addProgressiveDoneListener(e){c(this,Bh).push(e)}onDataRange(e,t){for(const s of c(this,Hh))s(e,t)}onDataProgress(e,t){c(this,vo).promise.then(()=>{for(const s of c(this,zh))s(e,t)})}onDataProgressiveRead(e){c(this,vo).promise.then(()=>{for(const t of c(this,Uh))t(e)})}onDataProgressiveDone(){c(this,vo).promise.then(()=>{for(const e of c(this,Bh))e()})}transportReady(){c(this,vo).resolve()}requestDataRange(e,t){je("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}vo=new WeakMap,Bh=new WeakMap,Uh=new WeakMap,zh=new WeakMap,Hh=new WeakMap;class TL{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ge(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Mr,wo,ed;class PL{constructor(e,t,s,r=!1){S(this,wo);S(this,Mr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=r?new a1:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new j2,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:i=!1}={}){return new Ff({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ge(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:r=_i.ENABLE,transform:i=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:d=null,printAnnotationStorage:h=null,isEditing:f=!1}){var k,E;(k=this._stats)==null||k.time("Overall");const p=this._transport.getRenderingIntent(s,r,h,f),{renderingIntent:m,cacheKey:y}=p;v(this,Mr,!1),o||(o=this._transport.getOptionalContentConfig(m));let x=this._intentStates.get(y);x||(x=Object.create(null),this._intentStates.set(y,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const _=!!(m&Os.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(E=this._stats)==null||E.time("Page Request"),this._pumpOperatorList(p));const g=N=>{var j;x.renderTasks.delete(w),_&&v(this,Mr,!0),A(this,wo,ed).call(this),N?(w.capability.reject(N),this._abortOperatorList({intentState:x,reason:N instanceof Error?N:new Error(N)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(j=globalThis.Stats)!=null&&j.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new gy({callback:g,params:{canvasContext:e,viewport:t,transform:i,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:d});(x.renderTasks||(x.renderTasks=new Set)).add(w);const b=w.task;return Promise.all([x.displayReadyCapability.promise,o]).then(([N,j])=>{var T;if(this.destroyed){g();return}if((T=this._stats)==null||T.time("Rendering"),!(j.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:N,optionalContentConfig:j}),w.operatorListChanged()}).catch(g),b}getOperatorList({intent:e="display",annotationMode:t=_i.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){var d;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,r,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Kd.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,r){function i(){a.read().then(function({value:l,done:d}){if(d){s(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},r)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),v(this,Mr,!1),Promise.all(e)}cleanup(e=!1){v(this,Mr,!0);const t=A(this,wo,ed).call(this);return e&&t&&this._stats&&(this._stats=new a1),t}_startRenderPage(e,t){var r,i;const s=this._intentStates.get(t);s&&((r=this._stats)==null||r.timeEnd("Page Request"),(i=s.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let s=0,r=e.length;s<r;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,wo,ed).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:r}){const{map:i,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},a).getReader(),d=this._intentStates.get(t);d.streamReader=l;const h=()=>{l.read().then(({value:f,done:p})=>{if(p){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,d),h())},f=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const p of d.renderTasks)p.operatorListChanged();A(this,wo,ed).call(this)}if(d.displayReadyCapability)d.displayReadyCapability.reject(f);else if(d.opListReadCapability)d.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof aw){let r=CL;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new wa(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}Mr=new WeakMap,wo=new WeakSet,ed=function(){if(!c(this,Mr)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,Mr,!1),!0};var zi,bn,Dr,bo,ng,_o,So,ns,Hp,M2,D2,td,Pc,Wp;const De=class De{constructor({name:e=null,port:t=null,verbosity:s=xR()}={}){S(this,ns);S(this,zi,Promise.withResolvers());S(this,bn,null);S(this,Dr,null);S(this,bo,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(c(De,So).has(t))throw new Error("Cannot use more than one PDFWorker per port.");c(De,So).set(t,this),A(this,ns,M2).call(this,t)}else A(this,ns,D2).call(this)}get promise(){return c(this,zi).promise}get port(){return c(this,Dr)}get messageHandler(){return c(this,bn)}destroy(){var e,t;this.destroyed=!0,(e=c(this,bo))==null||e.terminate(),v(this,bo,null),c(De,So).delete(c(this,Dr)),v(this,Dr,null),(t=c(this,bn))==null||t.destroy(),v(this,bn,null)}static create(e){const t=c(this,So).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new De(e)}static get workerSrc(){if(lr.workerSrc)return lr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ge(this,"_setupFakeWorkerGlobal",(async()=>c(this,Pc,Wp)?c(this,Pc,Wp):(await import(this.workerSrc)).WorkerMessageHandler)())}};zi=new WeakMap,bn=new WeakMap,Dr=new WeakMap,bo=new WeakMap,ng=new WeakMap,_o=new WeakMap,So=new WeakMap,ns=new WeakSet,Hp=function(){c(this,zi).resolve(),c(this,bn).send("configure",{verbosity:this.verbosity})},M2=function(e){v(this,Dr,e),v(this,bn,new Ku("main","worker",e)),c(this,bn).on("ready",()=>{}),A(this,ns,Hp).call(this)},D2=function(){if(c(De,_o)||c(De,Pc,Wp)){A(this,ns,td).call(this);return}let{workerSrc:e}=De;try{De._isSameOrigin(window.location,e)||(e=De._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ku("main","worker",t),r=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?c(this,zi).reject(new Error("Worker was destroyed")):A(this,ns,td).call(this)},i=new AbortController;t.addEventListener("error",()=>{c(this,bo)||r()},{signal:i.signal}),s.on("test",o=>{if(i.abort(),this.destroyed||!o){r();return}v(this,bn,s),v(this,Dr,t),v(this,bo,t),A(this,ns,Hp).call(this)}),s.on("ready",o=>{if(i.abort(),this.destroyed){r();return}try{a()}catch{A(this,ns,td).call(this)}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Fg("The worker has been disabled.")}A(this,ns,td).call(this)},td=function(){c(De,_o)||(oe("Setting up fake worker."),v(De,_o,!0)),De._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){c(this,zi).reject(new Error("Worker was destroyed"));return}const t=new zR;v(this,Dr,t);const s=`fake${Gt(De,ng)._++}`,r=new Ku(s+"_worker",s,t);e.setup(r,t),v(this,bn,new Ku(s,s+"_worker",t)),A(this,ns,Hp).call(this)}).catch(e=>{c(this,zi).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Pc=new WeakSet,Wp=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},S(De,Pc),S(De,ng,0),S(De,_o,!1),S(De,So,new WeakMap),Zt&&(v(De,_o,!0),lr.workerSrc||(lr.workerSrc="./pdf.worker.mjs")),De._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const r=new URL(t,s);return s.origin===r.origin},De._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},De.fromPort=e=>{if(CR("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return De.create(e)};let Yd=De;var Or,Zn,Rc,Lc,Fr,Ao,sd;class RL{constructor(e,t,s,r,i){S(this,Ao);S(this,Or,new Map);S(this,Zn,new Map);S(this,Rc,new Map);S(this,Lc,new Map);S(this,Fr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new j2,this.fontLoader=new DR({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ge(this,"annotationStorage",new uw)}getRenderingIntent(e,t=_i.ENABLE,s=null,r=!1,i=!1){let a=Os.DISPLAY,o=sy;switch(e){case"any":a=Os.ANY;break;case"display":break;case"print":a=Os.PRINT;break;default:oe(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Os.PRINT&&s instanceof h2?s:this.annotationStorage;switch(t){case _i.DISABLE:a+=Os.ANNOTATIONS_DISABLE;break;case _i.ENABLE:break;case _i.ENABLE_FORMS:a+=Os.ANNOTATIONS_FORMS;break;case _i.ENABLE_STORAGE:a+=Os.ANNOTATIONS_STORAGE,o=l.serializable;break;default:oe(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=Os.IS_EDITING),i&&(a+=Os.OPLIST);const{ids:d,hash:h}=l.modifiedIds,f=[a,o.hash,h];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:d}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=c(this,Fr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of c(this,Zn).values())e.push(r._destroy());c(this,Zn).clear(),c(this,Rc).clear(),c(this,Lc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,i;this.commonObjs.clear(),this.fontLoader.clear(),c(this,Or).clear(),this.filterFactory.destroy(),Xd.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new wa("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,r)=>{st(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:a}){if(a){r.close();return}st(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:a}=this._fullReader;return(!r||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var d;(d=t.onProgress)==null||d.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:a}}),e.on("GetRangeReader",(s,r)=>{st(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:a,done:o}){if(o){r.close();return}st(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{i.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new TL(s,this))}),e.on("DocException",s=>{t._capability.reject(cs(s))}),e.on("PasswordRequest",s=>{v(this,Fr,Promise.withResolvers());try{if(!t.onPassword)throw cs(s);const r=i=>{i instanceof Error?c(this,Fr).reject(i):c(this,Fr).resolve({password:i})};t.onPassword(r,s.code)}catch(r){c(this,Fr).reject(r)}return c(this,Fr).promise}),e.on("DataLoaded",s=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;c(this,Zn).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,r,i])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in i){const h=i.error;oe(`Error during font loading: ${h}`),this.commonObjs.resolve(s,h);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,l=new OR(i,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(s,l)});break;case"CopyLocalImage":const{imageRef:d}=i;st(d,"The imageRef must be defined.");for(const h of c(this,Zn).values())for(const[,f]of h.objs)if((f==null?void 0:f.ref)===d)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([s,r,i,a])=>{var l;if(this.destroyed)return;const o=c(this,Zn).get(r);if(!o.objs.has(s)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(i){case"Image":case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&oe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=c(this,Rc).get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&c(this,Lc).set(i.refStr,e);const a=new PL(t,i,this,this._params.pdfBug);return c(this,Zn).set(t,a),a});return c(this,Rc).set(t,r),r}getPageIndex(e){return ny(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,Ao,sd).call(this,"GetFieldObjects")}hasJSActions(){return A(this,Ao,sd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,Ao,sd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,Ao,sd).call(this,"GetOptionalContentConfig").then(t=>new uL(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,Or).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(r=>{var i,a;return{info:r[0],metadata:r[1]?new lL(r[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return c(this,Or).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Zn).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,Or).clear(),this.filterFactory.destroy(!0),Xd.cleanup()}}cachedPageNumber(e){if(!ny(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,Lc).get(t)??null}}Or=new WeakMap,Zn=new WeakMap,Rc=new WeakMap,Lc=new WeakMap,Fr=new WeakMap,Ao=new WeakSet,sd=function(e,t=null){const s=c(this,Or).get(e);if(s)return s;const r=this.messageHandler.sendWithPromise(e,t);return c(this,Or).set(e,r),r};var Hi;class LL{constructor(e){S(this,Hi,null);W(this,"onContinue",null);W(this,"onError",null);v(this,Hi,e)}get promise(){return c(this,Hi).capability.promise}cancel(e=0){c(this,Hi).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,Hi).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,Hi);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Hi=new WeakMap;var Wi,Eo;const Ua=class Ua{constructor({callback:e,params:t,objs:s,commonObjs:r,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:d,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){S(this,Wi,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=d,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new LL(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(c(Ua,Eo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(Ua,Eo).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:r,transform:i,background:a}=this.params;this.gfx=new sc(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var s,r,i;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),c(this,Wi)&&(window.cancelAnimationFrame(c(this,Wi)),v(this,Wi,null)),c(Ua,Eo).delete(this._canvas),e||(e=new aw(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(r=this.task).onError)==null||i.call(r,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,Wi,window.requestAnimationFrame(()=>{v(this,Wi,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(Ua,Eo).delete(this._canvas),this.callback())))}};Wi=new WeakMap,Eo=new WeakMap,S(Ua,Eo,new WeakSet);let gy=Ua;const IL="5.3.93",ML="cbeef3233";function _1(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Ou(n){return Math.max(0,Math.min(255,255*n))}class S1{static CMYK_G([e,t,s,r]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ou(e),[e,e,e]}static G_HTML([e]){const t=_1(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Ou)}static RGB_HTML(e){return`#${e.map(_1).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,s+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,s,r]){return[Ou(1-Math.min(1,e+r)),Ou(1-Math.min(1,s+r)),Ou(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const r=1-e,i=1-t,a=1-s,o=Math.min(r,i,a);return["CMYK",r,i,a,o]}}class DL{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){je("Abstract method `_createSVG` called.")}}class Um extends DL{_createSVG(e){return document.createElementNS(pr,e)}}class O2{static setupStorage(e,t,s,r,i){const a=r.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,d=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:r,linkService:i}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[l,d]of Object.entries(a))if(d!=null)switch(l){case"class":d.length&&e.setAttribute(l,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,d)}o&&i.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var f,p;const t=e.annotationStorage,s=e.linkService,r=e.xfaHtml,i=e.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:i,linkService:s});const o=i!=="richText",l=e.div;if(l.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}o&&l.setAttribute("class","xfaLayer xfaFont");const d=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);a.append(m),o&&Kd.shouldBuildText(r.name)&&d.push(m)}return{textDivs:d}}const h=[[r,-1,a]];for(;h.length>0;){const[m,y,x]=h.at(-1);if(y+1===m.children.length){h.pop();continue}const _=m.children[++h.at(-1)[1]];if(_===null)continue;const{name:g}=_;if(g==="#text"){const b=document.createTextNode(_.value);d.push(b),x.append(b);continue}const w=(f=_==null?void 0:_.attributes)!=null&&f.xmlns?document.createElementNS(_.attributes.xmlns,g):document.createElement(g);if(x.append(w),_.attributes&&this.setAttributes({html:w,element:_,storage:t,intent:i,linkService:s}),((p=_.children)==null?void 0:p.length)>0)h.push([_,-1,w]);else if(_.value){const b=document.createTextNode(_.value);o&&Kd.shouldBuildText(g)&&d.push(b),w.append(b)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const OL=9,ul=new WeakSet;class A1{static create(e){switch(e.data.annotationType){case Ze.LINK:return new F2(e);case Ze.TEXT:return new FL(e);case Ze.WIDGET:switch(e.data.fieldType){case"Tx":return new $L(e);case"Btn":return e.data.radioButton?new U2(e):e.data.checkBox?new UL(e):new zL(e);case"Ch":return new HL(e);case"Sig":return new BL(e)}return new xl(e);case Ze.POPUP:return new yy(e);case Ze.FREETEXT:return new q2(e);case Ze.LINE:return new VL(e);case Ze.SQUARE:return new qL(e);case Ze.CIRCLE:return new GL(e);case Ze.POLYLINE:return new G2(e);case Ze.CARET:return new KL(e);case Ze.INK:return new fw(e);case Ze.POLYGON:return new XL(e);case Ze.HIGHLIGHT:return new X2(e);case Ze.UNDERLINE:return new YL(e);case Ze.SQUIGGLY:return new QL(e);case Ze.STRIKEOUT:return new JL(e);case Ze.STAMP:return new K2(e);case Ze.FILEATTACHMENT:return new ZL(e);default:return new Qe(e)}}}var ko,Ic,Mc,Wh,xy;const vw=class vw{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){S(this,Wh);S(this,ko,null);S(this,Ic,!1);S(this,Mc,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return vw._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;c(this,ko)||v(this,ko,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&A(this,Wh,xy).call(this,t),(s=c(this,Mc))==null||s.popup.updateEdited(e)}resetEdited(){var e;c(this,ko)&&(A(this,Wh,xy).call(this,c(this,ko).rect),(e=c(this,Mc))==null||e.popup.resetEdited(),v(this,ko,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof xl||(i.tabIndex=0);const{style:a}=i;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof yy){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,i),i}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(x>0||_>0){const w=`calc(${x}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;a.borderRadius=w}else if(this instanceof U2){const w=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=w}switch(t.borderStyle.style){case kl.SOLID:a.borderStyle="solid";break;case kl.DASHED:a.borderStyle="dashed";break;case kl.BEVELED:oe("Unimplemented border style: beveled");break;case kl.INSET:oe("Unimplemented border style: inset");break;case kl.UNDERLINE:a.borderBottomStyle="solid";break}const g=t.borderColor||null;g?(v(this,Ic,!0),a.borderColor=te.makeHexColor(g[0]|0,g[1]|0,g[2]|0)):a.borderWidth=0}const d=te.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:m}=r.rawDims;a.left=`${100*(d[0]-p)/h}%`,a.top=`${100*(d[1]-m)/f}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(a.width=`${100*o/h}%`,a.height=`${100*l/f}%`):this.setRotation(y,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:i,height:a}=this;e%180!==0&&([i,a]=[a,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*a/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,r)=>{const i=r.detail[t],a=i[0],o=i.slice(1);r.target.style[s]=S1[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:S1[`${a}_rgb`](o)})};return ge(this,"_commonActions",{display:t=>{const{display:s}=t.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const r of Object.keys(t.detail)){const i=e[r]||s[r];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[r,i]of Object.entries(t)){const a=s[r];if(a){const o={detail:{[r]:i},target:e};a(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,r,i]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,_,g,w]=e.subarray(2,6);if(r===x&&i===_&&t===g&&s===w)return}const{style:a}=this.container;let o;if(c(this,Ic)){const{borderColor:x,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const l=r-t,d=i-s,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=h.createElement("defs");f.append(p);const m=h.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let x=2,_=e.length;x<_;x+=8){const g=e[x],w=e[x+1],b=e[x+2],k=e[x+3],E=h.createElement("rect"),N=(b-t)/l,j=(i-w)/d,T=(g-b)/l,M=(w-k)/d;E.setAttribute("x",N),E.setAttribute("y",j),E.setAttribute("width",T),E.setAttribute("height",M),m.append(E),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${j}" width="${T}" height="${M}"/>`)}c(this,Ic)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=v(this,Mc,new yy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){je("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:a,exportValues:o}of r){if(i===-1||a===t)continue;const l=typeof o=="string"?o:null,d=document.querySelector(`[data-element-id="${a}"]`);if(d&&!ul.has(d)){oe(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:d})}return s}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,a=r.getAttribute("data-element-id");a!==t&&ul.has(r)&&s.push({id:a,exportValue:i,domElement:r})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};ko=new WeakMap,Ic=new WeakMap,Mc=new WeakMap,Wh=new WeakSet,xy=function(e){const{container:{style:t},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+l)/a}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(r)};let Qe=vw;var Bs,Da,$2,B2;class F2 extends Qe{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});S(this,Bs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(s.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action),i=!0):t.attachment?(A(this,Bs,$2).call(this,r,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(A(this,Bs,B2).call(this,r,t.setOCGState),i=!0):t.dest?(this._bindLink(r,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,Bs,Da).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),A(this,Bs,Da).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(s.actions)){const a=r.get(i);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),A(this,Bs,Da).call(this)}_bindResetFormAction(t,s){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),A(this,Bs,Da).call(this),!this._fieldObjects){oe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var f;r==null||r();const{fields:i,refs:a,include:o}=s,l=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const m of i){const y=this._fieldObjects[m]||[];for(const{id:x}of y)p.add(x)}for(const m of Object.values(this._fieldObjects))for(const y of m)p.has(y.id)===o&&l.push(y)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const d=this.annotationStorage,h=[];for(const p of l){const{id:m}=p;switch(h.push(m),p.type){case"text":{const x=p.defaultValue||"";d.setValue(m,{value:x});break}case"checkbox":case"radiobutton":{const x=p.defaultValue===p.exportValues;d.setValue(m,{value:x});break}case"combobox":case"listbox":{const x=p.defaultValue||"";d.setValue(m,{value:x});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!ul.has(y)){oe(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Bs=new WeakSet,Da=function(){this.container.setAttribute("data-internal-link","")},$2=function(t,s,r=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(s.content,s.filename,r),!1},A(this,Bs,Da).call(this)},B2=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),A(this,Bs,Da).call(this)};class FL extends Qe{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class xl extends Qe{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Pt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,r,i){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(a)}}))})}_setEventListeners(e,t,s,r){var i,a,o;for(const[l,d]of s)(d==="Action"||(i=this.data.actions)!=null&&i[d])&&((d==="Focus"||d==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,d,r),d==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):d==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":te.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||OL,i=e.style;let a;const o=2,l=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(d/(S0*r))||1,f=d/h;a=Math.min(r,l(f/S0))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(r,l(d/S0))}i.fontSize=`calc(${a}px * var(--total-scale-factor))`,i.color=te.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class $L extends xl{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,r){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),i.setValue(a.id,{[r]:s})}render(){var r,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let d=a.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=d??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",d??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ul.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const f=this.data.dateFormat||this.data.timeFormat;f&&(s.title=f),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(s,"value",m.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",m=>{const y=this.data.defaultFieldValue??"";s.value=h.userValue=y,h.formattedValue=null});let p=m=>{const{formattedValue:y}=h;y!=null&&(m.target.value=y),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",y=>{var _;if(h.focused)return;const{target:x}=y;h.userValue&&(x.value=h.userValue),h.lastCommittedValue=x.value,h.commitKey=1,(_=this.data.actions)!=null&&_.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const x={value(_){h.userValue=_.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:g}=_.detail;h.formattedValue=g,g!=null&&_.target!==document.activeElement&&(_.target.value=g),e.setValue(t,{formattedValue:g})},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{var k;const{charLimit:g}=_.detail,{target:w}=_;if(g===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",g);let b=h.userValue;!b||b.length<=g||(b=b.slice(0,g),w.value=h.userValue=b,e.setValue(t,{value:b}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(x,y)}),s.addEventListener("keydown",y=>{var g;h.commitKey=1;let x=-1;if(y.key==="Escape"?x=0:y.key==="Enter"&&!this.data.multiLine?x=2:y.key==="Tab"&&(h.commitKey=3),x===-1)return;const{value:_}=y.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:x,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const m=p;p=null,s.addEventListener("blur",y=>{var _,g;if(!h.focused||!y.relatedTarget)return;(_=this.data.actions)!=null&&_.Blur||(h.focused=!1);const{value:x}=y.target;h.userValue=x,h.lastCommittedValue!==x&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:h.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}})),m(y)}),(i=this.data.actions)!=null&&i.Keystroke&&s.addEventListener("beforeinput",y=>{var N;h.lastCommittedValue=null;const{data:x,target:_}=y,{value:g,selectionStart:w,selectionEnd:b}=_;let k=w,E=b;switch(y.inputType){case"deleteWordBackward":{const j=g.substring(0,w).match(/\w*[^\w]*$/);j&&(k-=j[0].length);break}case"deleteWordForward":{const j=g.substring(w).match(/^[^\w]*\w*/);j&&(E+=j[0].length);break}case"deleteContentBackward":w===b&&(k-=1);break;case"deleteContentForward":w===b&&(E+=1);break}y.preventDefault(),(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,change:x||"",willCommit:!1,selStart:k,selEnd:E}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(p&&s.addEventListener("blur",p),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class BL extends xl{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class UL extends xl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return ul.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const d of this._getElementsByName(o,s)){const h=l&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=h),e.setValue(d.id,{value:h})}e.setValue(s,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class U2 extends xl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(s,{value:r})),r)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(ul.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const d of this._getElementsByName(o,s))e.setValue(d.id,{value:!1});e.setValue(s,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:d=>{const h=a===d.detail.value;for(const f of this._getElementsByName(d.target.name)){const p=h&&f.id===s;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class zL extends F2{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class HL extends xl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");ul.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of r.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,s.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),i=!1),r.append(f)}let a=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),r.prepend(h),a=()=>{h.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:m}=r;return m?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const d=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const m=p.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const x of r.options)x.selected=y.has(x.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){r.multiple=!0},remove(p){const m=r.options,y=p.detail.remove;m[y].selected=!1,r.remove(y),m.length>0&&Array.prototype.findIndex.call(m,_=>_.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:d(p)}),l=o(!1)},clear(p){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:m,displayValue:y,exportValue:x}=p.detail.insert,_=r.children[m],g=document.createElement("option");g.textContent=y,g.value=x,_?_.before(g):r.append(g),e.setValue(t,{value:o(!0),items:d(p)}),l=o(!1)},items(p){const{items:m}=p.detail;for(;r.length!==0;)r.remove(0);for(const y of m){const{displayValue:x,exportValue:_}=y,g=document.createElement("option");g.textContent=x,g.value=_,r.append(g)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:d(p)}),l=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const y of p.target.options)y.selected=m.has(y.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),r.addEventListener("input",h=>{var m;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):r.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class yy extends Qe{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Qe._hasPopupData(t)}),this.elements=s,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new WL({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${iw}${r}`).join(",")),this.container}}var Dc,rg,ig,Oc,Fc,qe,$r,No,Vh,qh,$c,Br,_n,Ur,Gh,zr,Xh,jo,Co,Ce,Vp,vy,z2,H2,W2,V2,qp,Gp,wy;class WL{constructor({container:e,color:t,elements:s,titleObj:r,modificationDate:i,contentsObj:a,richText:o,parent:l,rect:d,parentRect:h,open:f}){S(this,Ce);S(this,Dc,A(this,Ce,W2).bind(this));S(this,rg,A(this,Ce,wy).bind(this));S(this,ig,A(this,Ce,Gp).bind(this));S(this,Oc,A(this,Ce,qp).bind(this));S(this,Fc,null);S(this,qe,null);S(this,$r,null);S(this,No,null);S(this,Vh,null);S(this,qh,null);S(this,$c,null);S(this,Br,!1);S(this,_n,null);S(this,Ur,null);S(this,Gh,null);S(this,zr,null);S(this,Xh,null);S(this,jo,null);S(this,Co,!1);var p;v(this,qe,e),v(this,Xh,r),v(this,$r,a),v(this,zr,o),v(this,qh,l),v(this,Fc,t),v(this,Gh,d),v(this,$c,h),v(this,Vh,s),v(this,No,lw.toDateObject(i)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",c(this,Oc)),m.addEventListener("mouseenter",c(this,ig)),m.addEventListener("mouseleave",c(this,rg)),m.classList.add("popupTriggerArea");for(const m of s)(p=m.container)==null||p.addEventListener("keydown",c(this,Dc));c(this,qe).hidden=!0,f&&A(this,Ce,qp).call(this)}render(){if(c(this,_n))return;const e=v(this,_n,document.createElement("div"));if(e.className="popup",c(this,Fc)){const i=e.style.outlineColor=te.makeHexColor(...c(this,Fc));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=c(this,Xh),e.append(t),c(this,No)){const i=document.createElement("time");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,No).valueOf()})),i.dateTime=c(this,No).toISOString(),t.append(i)}const r=c(this,Ce,Vp);if(r)O2.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(c(this,$r));e.append(i)}c(this,qe).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let i=0,a=r.length;i<a;++i){const o=r[i];s.append(document.createTextNode(o)),i<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;c(this,jo)||v(this,jo,{contentsObj:c(this,$r),richText:c(this,zr)}),e&&v(this,Ur,null),t&&(v(this,zr,A(this,Ce,H2).call(this,t)),v(this,$r,null)),(s=c(this,_n))==null||s.remove(),v(this,_n,null)}resetEdited(){var e;c(this,jo)&&({contentsObj:Gt(this,$r)._,richText:Gt(this,zr)._}=c(this,jo),v(this,jo,null),(e=c(this,_n))==null||e.remove(),v(this,_n,null),v(this,Ur,null))}forceHide(){v(this,Co,this.isVisible),c(this,Co)&&(c(this,qe).hidden=!0)}maybeShow(){c(this,Co)&&(c(this,_n)||A(this,Ce,Gp).call(this),v(this,Co,!1),c(this,qe).hidden=!1)}get isVisible(){return c(this,qe).hidden===!1}}Dc=new WeakMap,rg=new WeakMap,ig=new WeakMap,Oc=new WeakMap,Fc=new WeakMap,qe=new WeakMap,$r=new WeakMap,No=new WeakMap,Vh=new WeakMap,qh=new WeakMap,$c=new WeakMap,Br=new WeakMap,_n=new WeakMap,Ur=new WeakMap,Gh=new WeakMap,zr=new WeakMap,Xh=new WeakMap,jo=new WeakMap,Co=new WeakMap,Ce=new WeakSet,Vp=function(){const e=c(this,zr),t=c(this,$r);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,zr).html||null},vy=function(){var e,t,s;return((s=(t=(e=c(this,Ce,Vp))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},z2=function(){var e,t,s;return((s=(t=(e=c(this,Ce,Vp))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},H2=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:c(this,Ce,z2),fontSize:c(this,Ce,vy)?`calc(${c(this,Ce,vy)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return s},W2=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,Br))&&A(this,Ce,qp).call(this)},V2=function(){if(c(this,Ur)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:r,pageY:i}}}=c(this,qh);let a=!!c(this,$c),o=a?c(this,$c):c(this,Gh);for(const y of c(this,Vh))if(!o||te.intersect(y.data.rect,o)!==null){o=y.data.rect,a=!0;break}const l=te.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,f=l[0]+h,p=l[1];v(this,Ur,[100*(f-r)/t,100*(p-i)/s]);const{style:m}=c(this,qe);m.left=`${c(this,Ur)[0]}%`,m.top=`${c(this,Ur)[1]}%`},qp=function(){v(this,Br,!c(this,Br)),c(this,Br)?(A(this,Ce,Gp).call(this),c(this,qe).addEventListener("click",c(this,Oc)),c(this,qe).addEventListener("keydown",c(this,Dc))):(A(this,Ce,wy).call(this),c(this,qe).removeEventListener("click",c(this,Oc)),c(this,qe).removeEventListener("keydown",c(this,Dc)))},Gp=function(){c(this,_n)||this.render(),this.isVisible?c(this,Br)&&c(this,qe).classList.add("focused"):(A(this,Ce,V2).call(this),c(this,qe).hidden=!1,c(this,qe).style.zIndex=parseInt(c(this,qe).style.zIndex)+1e3)},wy=function(){c(this,qe).classList.remove("focused"),!(c(this,Br)||!this.isVisible)&&(c(this,qe).hidden=!0,c(this,qe).style.zIndex=parseInt(c(this,qe).style.zIndex)-1e3)};class q2 extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ae.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Kh;class VL extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Kh,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),a=v(this,Kh,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Kh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kh=new WeakMap;var Yh;class qL extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Yh,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),a=t.borderStyle.width,o=v(this,Yh,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",r-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Yh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yh=new WeakMap;var Qh;class GL extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Qh,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),a=t.borderStyle.width,o=v(this,Qh,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",r/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",r/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qh=new WeakMap;var Jh;class G2 extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Jh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:r,popupRef:i},width:a,height:o}=this;if(!s)return this.container;const l=this.svgFactory.create(a,o,!0);let d=[];for(let f=0,p=s.length;f<p;f+=2){const m=s[f]-t[0],y=t[3]-s[f+1];d.push(`${m},${y}`)}d=d.join(" ");const h=v(this,Jh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",d),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Jh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Jh=new WeakMap;class XL extends G2{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class KL extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Zh,To,ef,by;class fw extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,ef);S(this,Zh,null);S(this,To,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ae.HIGHLIGHT:ae.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:r,borderStyle:i,popupRef:a}}=this,{transform:o,width:l,height:d}=A(this,ef,by).call(this,s,t),h=this.svgFactory.create(l,d,!0),f=v(this,Zh,this.svgFactory.createElement("svg:g"));h.append(f),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,m=r.length;p<m;p++){const y=this.svgFactory.createElement(this.svgElementName);c(this,To).push(y),y.setAttribute("points",r[p].join(",")),f.append(y)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:r,rect:i}=t,a=c(this,Zh);if(s>=0&&a.setAttribute("stroke-width",s||1),r)for(let o=0,l=c(this,To).length;o<l;o++)c(this,To)[o].setAttribute("points",r[o].join(","));if(i){const{transform:o,width:l,height:d}=A(this,ef,by).call(this,this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${d}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return c(this,To)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zh=new WeakMap,To=new WeakMap,ef=new WeakSet,by=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class X2 extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ae.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class YL extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class QL extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class JL extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class K2 extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ae.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var tf,sf,_y;class ZL extends Qe{constructor(t){var r;super(t,{isRenderable:!0});S(this,sf);S(this,tf,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let r;s.hasAppearance||s.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),r.addEventListener("dblclick",A(this,sf,_y).bind(this)),v(this,tf,r);const{isMac:i}=Pt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&A(this,sf,_y).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return c(this,tf)}addHighlightArea(){this.container.classList.add("highlightArea")}}tf=new WeakMap,sf=new WeakSet,_y=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var nf,Po,Vi,rf,Aa,Ay,Ey;const ww=class ww{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:r,page:i,viewport:a,structTreeLayer:o}){S(this,Aa);S(this,nf,null);S(this,Po,null);S(this,Vi,new Map);S(this,rf,null);this.div=e,v(this,nf,t),v(this,Po,s),v(this,rf,o||null),this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return c(this,Vi).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;ll(s,this.viewport);const r=new Map,i={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Um,annotationStorage:e.annotationStorage||new uw,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===Ze.POPUP;if(l){const f=r.get(o.id);if(!f)continue;i.elements=f}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const d=A1.create(i);if(!d.isRenderable)continue;if(!l&&o.popupRef){const f=r.get(o.popupRef);f?f.push(d):r.set(o.popupRef,[d])}const h=d.render();o.hidden&&(h.style.visibility="hidden"),await A(this,Aa,Ay).call(this,h,o.id,i.elements),d._isEditable&&(c(this,Vi).set(d.data.id,d),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(d))}A(this,Aa,Ey).call(this)}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new Um,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=ww._defaultBorderStyle),s.data=r;const i=A1.create(s);if(!i.isRenderable)continue;const a=i.render();await A(this,Aa,Ay).call(this,a,r.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,ll(t,{rotation:e.rotation}),A(this,Aa,Ey).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,Vi).values())}getEditableAnnotation(e){return c(this,Vi).get(e)}static get _defaultBorderStyle(){return ge(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:kl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};nf=new WeakMap,Po=new WeakMap,Vi=new WeakMap,rf=new WeakMap,Aa=new WeakSet,Ay=async function(e,t,s){var o,l;const r=e.firstChild||e,i=r.id=`${iw}${t}`,a=await((o=c(this,rf))==null?void 0:o.getAriaAttributes(i));if(a)for(const[d,h]of a)r.setAttribute(d,h);s?s.at(-1).container.after(e):(this.div.append(e),(l=c(this,nf))==null||l.moveElementInDOM(this.div,e,r,!1))},Ey=function(){var t;if(!c(this,Po))return;const e=this.div;for(const[s,r]of c(this,Po)){const i=e.querySelector(`[data-annotation-id="${s}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(r):a.classList.contains("annotationContent")?a.after(r):a.before(r):i.append(r);const o=c(this,Vi).get(s);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,i.id,r),o._hasNoCanvas=!1):o.canvas=r)}c(this,Po).clear()};let Sy=ww;const gp=/\r\n?|\n/g;var Sn,Ns,af,Ro,js,rt,Y2,Q2,J2,Xp,ri,Kp,Yp,Z2,Ny,eE;const Pe=class Pe extends Le{constructor(t){super({...t,name:"freeTextEditor"});S(this,rt);S(this,Sn);S(this,Ns,"");S(this,af,`${this.id}-editor`);S(this,Ro,null);S(this,js);v(this,Sn,t.color||Pe._defaultColor||Le._defaultLineColor),v(this,js,t.fontSize||Pe._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Pe.prototype,s=a=>a.isEmpty(),r=cl.TRANSLATE_SMALL,i=cl.TRANSLATE_BIG;return ge(this,"_keyboardManager",new $f([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}]]))}static initialize(t,s){Le.initialize(t,s);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case xe.FREETEXT_SIZE:Pe._defaultFontSize=s;break;case xe.FREETEXT_COLOR:Pe._defaultColor=s;break}}updateParams(t,s){switch(t){case xe.FREETEXT_SIZE:A(this,rt,Y2).call(this,s);break;case xe.FREETEXT_COLOR:A(this,rt,Q2).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[xe.FREETEXT_SIZE,Pe._defaultFontSize],[xe.FREETEXT_COLOR,Pe._defaultColor||Le._defaultLineColor]]}get propertiesToUpdate(){return[[xe.FREETEXT_SIZE,c(this,js)],[xe.FREETEXT_COLOR,c(this,Sn)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Pe._internalPadding*t,-(Pe._internalPadding+c(this,js))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,Ro,new AbortController);const t=this._uiManager.combinedSignal(c(this,Ro));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,af)),this._isDraggable=!0,(t=c(this,Ro))==null||t.abort(),v(this,Ro,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,Ns),s=v(this,Ns,A(this,rt,J2).call(this).trimEnd());if(t===s)return;const r=i=>{if(v(this,Ns,i),!i){this.remove();return}A(this,rt,Yp).call(this),this._uiManager.rebuild(this),A(this,rt,Xp).call(this)};this.addCommands({cmd:()=>{r(s)},undo:()=>{r(t)},mustExec:!1}),A(this,rt,Xp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Pe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,af)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${c(this,js)}px * var(--total-scale-factor))`,r.color=c(this,Sn),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,d]=this.getInitialTranslation();[l,d]=this.pageTranslationToScreen(l,d);const[h,f]=this.pageDimensions,[p,m]=this.pageTranslation;let y,x;switch(this.rotation){case 0:y=t+(o[0]-p)/h,x=s+this.height-(o[1]-m)/f;break;case 90:y=t+(o[0]-p)/h,x=s-(o[1]-m)/f,[l,d]=[d,-l];break;case 180:y=t-this.width+(o[0]-p)/h,x=s-(o[1]-m)/f,[l,d]=[-l,-d];break;case 270:y=t+(o[0]-p-this.height*f)/h,x=s+(o[1]-m-this.width*h)/f,[l,d]=[-d,l];break}this.setAt(y*i,x*a,l,d)}else this._moveAfterPaste(t,s);A(this,rt,Yp).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,x,_;const s=t.clipboardData||window.clipboardData,{types:r}=s;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=A(y=Pe,ri,Ny).call(y,s.getData("text")||"").replaceAll(gp,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:d}=o,h=[],f=[];if(l.nodeType===Node.TEXT_NODE){const g=l.parentElement;if(f.push(l.nodeValue.slice(d).replaceAll(gp,"")),g!==this.editorDiv){let w=h;for(const b of this.editorDiv.childNodes){if(b===g){w=f;continue}w.push(A(x=Pe,ri,Kp).call(x,b))}}h.push(l.nodeValue.slice(0,d).replaceAll(gp,""))}else if(l===this.editorDiv){let g=h,w=0;for(const b of this.editorDiv.childNodes)w++===d&&(g=f),g.push(A(_=Pe,ri,Kp).call(_,b))}v(this,Ns,`${h.join(`
`)}${i}${f.join(`
`)}`),A(this,rt,Yp).call(this);const p=new Range;let m=Math.sumPrecise(h.map(g=>g.length));for(const{firstChild:g}of this.editorDiv.childNodes)if(g.nodeType===Node.TEXT_NODE){const w=g.nodeValue.length;if(m<=w){p.setStart(g,m),p.setEnd(g,m);break}m-=w}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,r){var o;let i=null;if(t instanceof q2){const{data:{defaultAppearanceData:{fontSize:l,fontColor:d},rect:h,rotation:f,id:p,popupRef:m},textContent:y,textPosition:x,parent:{page:{pageNumber:_}}}=t;if(!y||y.length===0)return null;i=t={annotationType:ae.FREETEXT,color:Array.from(d),fontSize:l,value:y.join(`
`),position:x,pageIndex:_-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,r);return v(a,js,t.fontSize),v(a,Sn,te.makeHexColor(...t.color)),v(a,Ns,A(o=Pe,ri,Ny).call(o,t.value)),a._initialData=i,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Pe._internalPadding*this.parentScale,r=this.getRect(s,s),i=Le._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,Sn)),a={annotationType:ae.FREETEXT,color:i,fontSize:c(this,js),value:A(this,rt,Z2).call(this),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!A(this,rt,eE).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:r}=s;r.fontSize=`calc(${c(this,js)}px * var(--total-scale-factor))`,r.color=c(this,Sn),s.replaceChildren();for(const a of c(this,Ns).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const i=Pe._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:c(this,Ns)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Sn=new WeakMap,Ns=new WeakMap,af=new WeakMap,Ro=new WeakMap,js=new WeakMap,rt=new WeakSet,Y2=function(t){const s=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-c(this,js))*this.parentScale),v(this,js,i),A(this,rt,Xp).call(this)},r=c(this,js);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Q2=function(t){const s=i=>{v(this,Sn,this.editorDiv.style.color=i)},r=c(this,Sn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},J2=function(){var r;const t=[];this.editorDiv.normalize();let s=null;for(const i of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(A(r=Pe,ri,Kp).call(r,i)),s=i);return t.join(`
`)},Xp=function(){const[t,s]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),r=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/s):(this.width=r.height/t,this.height=r.width/s),this.fixAndSetPosition()},ri=new WeakSet,Kp=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(gp,"")},Yp=function(){if(this.editorDiv.replaceChildren(),!!c(this,Ns))for(const t of c(this,Ns).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Z2=function(){return c(this,Ns).replaceAll(""," ")},Ny=function(t){return t.replaceAll(" ","")},eE=function(t){const{value:s,fontSize:r,color:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==r||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==a},S(Pe,ri),W(Pe,"_freeTextDefaultContent",""),W(Pe,"_internalPadding",0),W(Pe,"_defaultColor",null),W(Pe,"_defaultFontSize",10),W(Pe,"_type","freetext"),W(Pe,"_editorType",ae.FREETEXT);let ky=Pe;class Y{toSVGPath(){je("Abstract method `toSVGPath` must be implemented.")}get box(){je("Abstract getter `box` must be implemented.")}serialize(e,t){je("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,r,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*r,a[o+1]=s+e[o+1]*i;return a}static _rescaleAndSwap(e,t,s,r,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*r,a[o+1]=s+e[o]*i;return a}static _translate(e,t,s,r){r||(r=new Float32Array(e.length));for(let i=0,a=e.length;i<a;i+=2)r[i]=t+e[i],r[i+1]=s+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,r,i){switch(i){case 90:return[1-t/s,e/r];case 180:return[1-e/s,1-t/r];case 270:return[t/s,1-e/r];default:return[e/s,t/r]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,r,i,a){return[(e+5*s)/6,(t+5*r)/6,(5*s+i)/6,(5*r+a)/6,(s+i)/2,(r+a)/2]}}W(Y,"PRECISION",1e-4);var Cs,An,Bc,Uc,er,fe,Lo,Io,of,lf,zc,Hc,qi,cf,ag,og,dt,nd,tE,sE,nE,rE,iE,aE;const wr=class wr{constructor({x:e,y:t},s,r,i,a,o=0){S(this,dt);S(this,Cs);S(this,An,[]);S(this,Bc);S(this,Uc);S(this,er,[]);S(this,fe,new Float32Array(18));S(this,Lo);S(this,Io);S(this,of);S(this,lf);S(this,zc);S(this,Hc);S(this,qi,[]);v(this,Cs,s),v(this,Hc,i*r),v(this,Uc,a),c(this,fe).set([NaN,NaN,NaN,NaN,e,t],6),v(this,Bc,o),v(this,lf,c(wr,cf)*r),v(this,of,c(wr,og)*r),v(this,zc,r),c(this,qi).push(e,t)}isEmpty(){return isNaN(c(this,fe)[8])}add({x:e,y:t}){var M;v(this,Lo,e),v(this,Io,t);const[s,r,i,a]=c(this,Cs);let[o,l,d,h]=c(this,fe).subarray(8,12);const f=e-d,p=t-h,m=Math.hypot(f,p);if(m<c(this,of))return!1;const y=m-c(this,lf),x=y/m,_=x*f,g=x*p;let w=o,b=l;o=d,l=h,d+=_,h+=g,(M=c(this,qi))==null||M.push(e,t);const k=-g/y,E=_/y,N=k*c(this,Hc),j=E*c(this,Hc);return c(this,fe).set(c(this,fe).subarray(2,8),0),c(this,fe).set([d+N,h+j],4),c(this,fe).set(c(this,fe).subarray(14,18),12),c(this,fe).set([d-N,h-j],16),isNaN(c(this,fe)[6])?(c(this,er).length===0&&(c(this,fe).set([o+N,l+j],2),c(this,er).push(NaN,NaN,NaN,NaN,(o+N-s)/i,(l+j-r)/a),c(this,fe).set([o-N,l-j],14),c(this,An).push(NaN,NaN,NaN,NaN,(o-N-s)/i,(l-j-r)/a)),c(this,fe).set([w,b,o,l,d,h],6),!this.isEmpty()):(c(this,fe).set([w,b,o,l,d,h],6),Math.abs(Math.atan2(b-l,w-o)-Math.atan2(g,_))<Math.PI/2?([o,l,d,h]=c(this,fe).subarray(2,6),c(this,er).push(NaN,NaN,NaN,NaN,((o+d)/2-s)/i,((l+h)/2-r)/a),[o,l,w,b]=c(this,fe).subarray(14,18),c(this,An).push(NaN,NaN,NaN,NaN,((w+o)/2-s)/i,((b+l)/2-r)/a),!0):([w,b,o,l,d,h]=c(this,fe).subarray(0,6),c(this,er).push(((w+5*o)/6-s)/i,((b+5*l)/6-r)/a,((5*o+d)/6-s)/i,((5*l+h)/6-r)/a,((o+d)/2-s)/i,((l+h)/2-r)/a),[d,h,o,l,w,b]=c(this,fe).subarray(12,18),c(this,An).push(((w+5*o)/6-s)/i,((b+5*l)/6-r)/a,((5*o+d)/6-s)/i,((5*l+h)/6-r)/a,((o+d)/2-s)/i,((l+h)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,er),t=c(this,An);if(isNaN(c(this,fe)[6])&&!this.isEmpty())return A(this,dt,tE).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);A(this,dt,nE).call(this,s);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return A(this,dt,sE).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,r,i,a){return new oE(e,t,s,r,i,a)}getOutlines(){var f;const e=c(this,er),t=c(this,An),s=c(this,fe),[r,i,a,o]=c(this,Cs),l=new Float32Array((((f=c(this,qi))==null?void 0:f.length)??0)+2);for(let p=0,m=l.length-2;p<m;p+=2)l[p]=(c(this,qi)[p]-r)/a,l[p+1]=(c(this,qi)[p+1]-i)/o;if(l[l.length-2]=(c(this,Lo)-r)/a,l[l.length-1]=(c(this,Io)-i)/o,isNaN(s[6])&&!this.isEmpty())return A(this,dt,rE).call(this,l);const d=new Float32Array(c(this,er).length+24+c(this,An).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){d[p]=d[p+1]=NaN;continue}d[p]=e[p],d[p+1]=e[p+1]}h=A(this,dt,aE).call(this,d,h);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){d[h]=d[h+1]=NaN,h+=2;continue}d[h]=t[p+m],d[h+1]=t[p+m+1],h+=2}return A(this,dt,iE).call(this,d,h),this.newFreeDrawOutline(d,l,c(this,Cs),c(this,zc),c(this,Bc),c(this,Uc))}};Cs=new WeakMap,An=new WeakMap,Bc=new WeakMap,Uc=new WeakMap,er=new WeakMap,fe=new WeakMap,Lo=new WeakMap,Io=new WeakMap,of=new WeakMap,lf=new WeakMap,zc=new WeakMap,Hc=new WeakMap,qi=new WeakMap,cf=new WeakMap,ag=new WeakMap,og=new WeakMap,dt=new WeakSet,nd=function(){const e=c(this,fe).subarray(4,6),t=c(this,fe).subarray(16,18),[s,r,i,a]=c(this,Cs);return[(c(this,Lo)+(e[0]-t[0])/2-s)/i,(c(this,Io)+(e[1]-t[1])/2-r)/a,(c(this,Lo)+(t[0]-e[0])/2-s)/i,(c(this,Io)+(t[1]-e[1])/2-r)/a]},tE=function(){const[e,t,s,r]=c(this,Cs),[i,a,o,l]=A(this,dt,nd).call(this);return`M${(c(this,fe)[2]-e)/s} ${(c(this,fe)[3]-t)/r} L${(c(this,fe)[4]-e)/s} ${(c(this,fe)[5]-t)/r} L${i} ${a} L${o} ${l} L${(c(this,fe)[16]-e)/s} ${(c(this,fe)[17]-t)/r} L${(c(this,fe)[14]-e)/s} ${(c(this,fe)[15]-t)/r} Z`},sE=function(e){const t=c(this,An);e.push(`L${t[4]} ${t[5]} Z`)},nE=function(e){const[t,s,r,i]=c(this,Cs),a=c(this,fe).subarray(4,6),o=c(this,fe).subarray(16,18),[l,d,h,f]=A(this,dt,nd).call(this);e.push(`L${(a[0]-t)/r} ${(a[1]-s)/i} L${l} ${d} L${h} ${f} L${(o[0]-t)/r} ${(o[1]-s)/i}`)},rE=function(e){const t=c(this,fe),[s,r,i,a]=c(this,Cs),[o,l,d,h]=A(this,dt,nd).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-r)/a],0),this.newFreeDrawOutline(f,e,c(this,Cs),c(this,zc),c(this,Bc),c(this,Uc))},iE=function(e,t){const s=c(this,An);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},aE=function(e,t){const s=c(this,fe).subarray(4,6),r=c(this,fe).subarray(16,18),[i,a,o,l]=c(this,Cs),[d,h,f,p]=A(this,dt,nd).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(r[0]-i)/o,(r[1]-a)/l],t),t+=24},S(wr,cf,8),S(wr,ag,2),S(wr,og,c(wr,cf)+c(wr,ag));let zm=wr;var Wc,Mo,Hr,uf,Ts,df,Ke,lg,lE;class oE extends Y{constructor(t,s,r,i,a,o){super();S(this,lg);S(this,Wc);S(this,Mo,new Float32Array(4));S(this,Hr);S(this,uf);S(this,Ts);S(this,df);S(this,Ke);v(this,Ke,t),v(this,Ts,s),v(this,Wc,r),v(this,df,i),v(this,Hr,a),v(this,uf,o),this.lastPoint=[NaN,NaN],A(this,lg,lE).call(this,o);const[l,d,h,f]=c(this,Mo);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/h,t[p+1]=(t[p+1]-d)/f;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-l)/h,s[p+1]=(s[p+1]-d)/f}toSVGPath(){const t=[`M${c(this,Ke)[4]} ${c(this,Ke)[5]}`];for(let s=6,r=c(this,Ke).length;s<r;s+=6){if(isNaN(c(this,Ke)[s])){t.push(`L${c(this,Ke)[s+4]} ${c(this,Ke)[s+5]}`);continue}t.push(`C${c(this,Ke)[s]} ${c(this,Ke)[s+1]} ${c(this,Ke)[s+2]} ${c(this,Ke)[s+3]} ${c(this,Ke)[s+4]} ${c(this,Ke)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,r,i],a){const o=r-t,l=i-s;let d,h;switch(a){case 0:d=Y._rescale(c(this,Ke),t,i,o,-l),h=Y._rescale(c(this,Ts),t,i,o,-l);break;case 90:d=Y._rescaleAndSwap(c(this,Ke),t,s,o,l),h=Y._rescaleAndSwap(c(this,Ts),t,s,o,l);break;case 180:d=Y._rescale(c(this,Ke),r,s,-o,l),h=Y._rescale(c(this,Ts),r,s,-o,l);break;case 270:d=Y._rescaleAndSwap(c(this,Ke),r,i,-o,-l),h=Y._rescaleAndSwap(c(this,Ts),r,i,-o,-l);break}return{outline:Array.from(d),points:[Array.from(h)]}}get box(){return c(this,Mo)}newOutliner(t,s,r,i,a,o=0){return new zm(t,s,r,i,a,o)}getNewOutline(t,s){const[r,i,a,o]=c(this,Mo),[l,d,h,f]=c(this,Wc),p=a*h,m=o*f,y=r*h+l,x=i*f+d,_=this.newOutliner({x:c(this,Ts)[0]*p+y,y:c(this,Ts)[1]*m+x},c(this,Wc),c(this,df),t,c(this,uf),s??c(this,Hr));for(let g=2;g<c(this,Ts).length;g+=2)_.add({x:c(this,Ts)[g]*p+y,y:c(this,Ts)[g+1]*m+x});return _.getOutlines()}}Wc=new WeakMap,Mo=new WeakMap,Hr=new WeakMap,uf=new WeakMap,Ts=new WeakMap,df=new WeakMap,Ke=new WeakMap,lg=new WeakSet,lE=function(t){const s=c(this,Ke);let r=s[4],i=s[5];const a=[r,i,r,i];let o=r,l=i;const d=t?Math.max:Math.min;for(let f=6,p=s.length;f<p;f+=6){const m=s[f+4],y=s[f+5];if(isNaN(s[f]))te.pointBoundingBox(m,y,a),l<y?(o=m,l=y):l===y&&(o=d(o,m));else{const x=[1/0,1/0,-1/0,-1/0];te.bezierBoundingBox(r,i,...s.slice(f,f+6),x),te.rectBoundingBox(...x,a),l<x[3]?(o=x[2],l=x[3]):l===x[3]&&(o=d(o,x[2]))}r=m,i=y}const h=c(this,Mo);h[0]=a[0]-c(this,Hr),h[1]=a[1]-c(this,Hr),h[2]=a[2]-a[0]+2*c(this,Hr),h[3]=a[3]-a[1]+2*c(this,Hr),this.lastPoint=[o,l]};var hf,ff,Gi,En,is,cE,Qp,uE,dE,Cy;class jy{constructor(e,t=0,s=0,r=!0){S(this,is);S(this,hf);S(this,ff);S(this,Gi,[]);S(this,En,[]);const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:y,y:x,width:_,height:g}of e){const w=Math.floor((y-t)/o)*o,b=Math.ceil((y+_+t)/o)*o,k=Math.floor((x-t)/o)*o,E=Math.ceil((x+g+t)/o)*o,N=[w,k,E,!0],j=[b,k,E,!1];c(this,Gi).push(N,j),te.rectBoundingBox(w,k,b,E,i)}const l=i[2]-i[0]+2*s,d=i[3]-i[1]+2*s,h=i[0]-s,f=i[1]-s,p=c(this,Gi).at(r?-1:-2),m=[p[0],p[2]];for(const y of c(this,Gi)){const[x,_,g]=y;y[0]=(x-h)/l,y[1]=(_-f)/d,y[2]=(g-f)/d}v(this,hf,new Float32Array([h,f,l,d])),v(this,ff,m)}getOutlines(){c(this,Gi).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of c(this,Gi))t[3]?(e.push(...A(this,is,Cy).call(this,t)),A(this,is,uE).call(this,t)):(A(this,is,dE).call(this,t),e.push(...A(this,is,Cy).call(this,t)));return A(this,is,cE).call(this,e)}}hf=new WeakMap,ff=new WeakMap,Gi=new WeakMap,En=new WeakMap,is=new WeakSet,cE=function(e){const t=[],s=new Set;for(const a of e){const[o,l,d]=a;t.push([o,l,a],[o,d,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],d=t[a+1][2];l.push(d),d.push(l),s.add(l),s.add(d)}const r=[];let i;for(;s.size>0;){const a=s.values().next().value;let[o,l,d,h,f]=a;s.delete(a);let p=o,m=l;for(i=[o,d],r.push(i);;){let y;if(s.has(h))y=h;else if(s.has(f))y=f;else break;s.delete(y),[o,l,d,h,f]=y,p!==o&&(i.push(p,m,o,m===l?l:d),p=o),m=m===l?d:l}i.push(p,m)}return new eI(r,c(this,hf),c(this,ff))},Qp=function(e){const t=c(this,En);let s=0,r=t.length-1;for(;s<=r;){const i=s+r>>1,a=t[i][0];if(a===e)return i;a<e?s=i+1:r=i-1}return r+1},uE=function([,e,t]){const s=A(this,is,Qp).call(this,e);c(this,En).splice(s,0,[e,t])},dE=function([,e,t]){const s=A(this,is,Qp).call(this,e);for(let r=s;r<c(this,En).length;r++){const[i,a]=c(this,En)[r];if(i!==e)break;if(i===e&&a===t){c(this,En).splice(r,1);return}}for(let r=s-1;r>=0;r--){const[i,a]=c(this,En)[r];if(i!==e)break;if(i===e&&a===t){c(this,En).splice(r,1);return}}},Cy=function(e){const[t,s,r]=e,i=[[t,s,r]],a=A(this,is,Qp).call(this,r);for(let o=0;o<a;o++){const[l,d]=c(this,En)[o];for(let h=0,f=i.length;h<f;h++){const[,p,m]=i[h];if(!(d<=p||m<=l)){if(p>=l){if(m>d)i[h][1]=d;else{if(f===1)return[];i.splice(h,1),h--,f--}continue}i[h][2]=l,m>d&&i.push([t,d,m])}}}return i};var pf,Vc;class eI extends Y{constructor(t,s,r){super();S(this,pf);S(this,Vc);v(this,Vc,t),v(this,pf,s),this.lastPoint=r}toSVGPath(){const t=[];for(const s of c(this,Vc)){let[r,i]=s;t.push(`M${r} ${i}`);for(let a=2;a<s.length;a+=2){const o=s[a],l=s[a+1];o===r?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),r=o)}t.push("Z")}return t.join(" ")}serialize([t,s,r,i],a){const o=[],l=r-t,d=i-s;for(const h of c(this,Vc)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=t+h[p]*l,f[p+1]=i-h[p+1]*d;o.push(f)}return o}get box(){return c(this,pf)}get classNamesForOutlining(){return["highlightOutline"]}}pf=new WeakMap,Vc=new WeakMap;class Ty extends zm{newFreeDrawOutline(e,t,s,r,i,a){return new tI(e,t,s,r,i,a)}}class tI extends oE{newOutliner(e,t,s,r,i,a=0){return new Ty(e,t,s,r,i,a)}}var Ps,Do,qc,lt,mf,Gc,Wr,gf,Xi,kn,Xc,xf,Ne,Py,Ry,Ly,Oa,hE,pi;const us=class us{constructor({editor:e=null,uiManager:t=null}){S(this,Ne);S(this,Ps,null);S(this,Do,null);S(this,qc);S(this,lt,null);S(this,mf,!1);S(this,Gc,!1);S(this,Wr,null);S(this,gf);S(this,Xi,null);S(this,kn,null);S(this,Xc);var s,r;e?(v(this,Gc,!1),v(this,Xc,xe.HIGHLIGHT_COLOR),v(this,Wr,e)):(v(this,Gc,!0),v(this,Xc,xe.HIGHLIGHT_DEFAULT_COLOR)),v(this,kn,(e==null?void 0:e._uiManager)||t),v(this,gf,c(this,kn)._eventBus),v(this,qc,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((r=c(this,kn))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),c(us,xf)||v(us,xf,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ge(this,"_keyboardManager",new $f([[["Escape","mac+Escape"],us.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],us.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],us.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],us.prototype._moveToPrevious],[["Home","mac+Home"],us.prototype._moveToBeginning],[["End","mac+End"],us.prototype._moveToEnd]]))}renderButton(){const e=v(this,Ps,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",c(this,Wr)&&(e.ariaControls=`${c(this,Wr).id}_colorpicker_dropdown`);const t=c(this,kn)._signal;e.addEventListener("click",A(this,Ne,Oa).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Ne,Ly).bind(this),{signal:t});const s=v(this,Do,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=c(this,qc),e.append(s),e}renderMainDropdown(){const e=v(this,lt,A(this,Ne,Py).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===c(this,Ps)){A(this,Ne,Oa).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Ne,Ry).call(this,t,e)}_moveToNext(e){var t,s;if(!c(this,Ne,pi)){A(this,Ne,Oa).call(this,e);return}if(e.target===c(this,Ps)){(t=c(this,lt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=c(this,lt))==null?void 0:t.firstChild)||e.target===c(this,Ps)){c(this,Ne,pi)&&this._hideDropdownFromKeyboard();return}c(this,Ne,pi)||A(this,Ne,Oa).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!c(this,Ne,pi)){A(this,Ne,Oa).call(this,e);return}(t=c(this,lt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Ne,pi)){A(this,Ne,Oa).call(this,e);return}(t=c(this,lt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,lt))==null||e.classList.add("hidden"),c(this,Ps).ariaExpanded="false",(t=c(this,Xi))==null||t.abort(),v(this,Xi,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,Gc)){if(!c(this,Ne,pi)){(e=c(this,Wr))==null||e.unselect();return}this.hideDropdown(),c(this,Ps).focus({preventScroll:!0,focusVisible:c(this,mf)})}}updateColor(e){if(c(this,Do)&&(c(this,Do).style.backgroundColor=e),!c(this,lt))return;const t=c(this,kn).highlightColors.values();for(const s of c(this,lt).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=c(this,Ps))==null||e.remove(),v(this,Ps,null),v(this,Do,null),(t=c(this,lt))==null||t.remove(),v(this,lt,null)}};Ps=new WeakMap,Do=new WeakMap,qc=new WeakMap,lt=new WeakMap,mf=new WeakMap,Gc=new WeakMap,Wr=new WeakMap,gf=new WeakMap,Xi=new WeakMap,kn=new WeakMap,Xc=new WeakMap,xf=new WeakMap,Ne=new WeakSet,Py=function(){const e=document.createElement("div"),t=c(this,kn)._signal;e.addEventListener("contextmenu",On,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),c(this,Wr)&&(e.id=`${c(this,Wr).id}_colorpicker_dropdown`);for(const[s,r]of c(this,kn).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=s,i.setAttribute("data-l10n-id",c(us,xf)[s]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=r,i.ariaSelected=r===c(this,qc),i.addEventListener("click",A(this,Ne,Ry).bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",A(this,Ne,Ly).bind(this),{signal:t}),e},Ry=function(e,t){t.stopPropagation(),c(this,gf).dispatch("switchannotationeditorparams",{source:this,type:c(this,Xc),value:e})},Ly=function(e){us._keyboardManager.exec(this,e)},Oa=function(e){if(c(this,Ne,pi)){this.hideDropdown();return}if(v(this,mf,e.detail===0),c(this,Xi)||(v(this,Xi,new AbortController),window.addEventListener("pointerdown",A(this,Ne,hE).bind(this),{signal:c(this,kn).combinedSignal(c(this,Xi))})),c(this,Ps).ariaExpanded="true",c(this,lt)){c(this,lt).classList.remove("hidden");return}const t=v(this,lt,A(this,Ne,Py).call(this));c(this,Ps).append(t)},hE=function(e){var t;(t=c(this,lt))!=null&&t.contains(e.target)||this.hideDropdown()},pi=function(){return c(this,lt)&&!c(this,lt).classList.contains("hidden")},S(us,xf,null);let Hm=us;var Kc,yf,Vr,Oo,vf,fs,wf,bf,Fo,en,Rs,Et,Yc,qr,Ut,Qc,tn,_f,ue,Iy,Jp,fE,pE,mE,My,Fa,an,Pl,gE,Zp,rd,xE,yE,vE,wE,bE;const be=class be extends Le{constructor(t){super({...t,name:"highlightEditor"});S(this,ue);S(this,Kc,null);S(this,yf,0);S(this,Vr);S(this,Oo,null);S(this,vf,null);S(this,fs,null);S(this,wf,null);S(this,bf,0);S(this,Fo,null);S(this,en,null);S(this,Rs,null);S(this,Et,!1);S(this,Yc,null);S(this,qr);S(this,Ut,null);S(this,Qc,"");S(this,tn);S(this,_f,"");this.color=t.color||be._defaultColor,v(this,tn,t.thickness||be._defaultThickness),v(this,qr,t.opacity||be._defaultOpacity),v(this,Vr,t.boxes||null),v(this,_f,t.methodOfCreation||""),v(this,Qc,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(v(this,Et,!0),A(this,ue,Jp).call(this,t),A(this,ue,Fa).call(this)):c(this,Vr)&&(v(this,Kc,t.anchorNode),v(this,yf,t.anchorOffset),v(this,wf,t.focusNode),v(this,bf,t.focusOffset),A(this,ue,Iy).call(this),A(this,ue,Fa).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=be.prototype;return ge(this,"_keyboardManager",new $f([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,Et)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,tn),methodOfCreation:c(this,_f)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var r;Le.initialize(t,s),be._defaultColor||(be._defaultColor=((r=s.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case xe.HIGHLIGHT_DEFAULT_COLOR:be._defaultColor=s;break;case xe.HIGHLIGHT_THICKNESS:be._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return c(this,Yc)}updateParams(t,s){switch(t){case xe.HIGHLIGHT_COLOR:A(this,ue,fE).call(this,s);break;case xe.HIGHLIGHT_THICKNESS:A(this,ue,pE).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[xe.HIGHLIGHT_DEFAULT_COLOR,be._defaultColor],[xe.HIGHLIGHT_THICKNESS,be._defaultThickness]]}get propertiesToUpdate(){return[[xe.HIGHLIGHT_COLOR,this.color||be._defaultColor],[xe.HIGHLIGHT_THICKNESS,c(this,tn)||be._defaultThickness],[xe.HIGHLIGHT_FREE,c(this,Et)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",v(this,vf,new Hm({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,ue,rd).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,ue,rd).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,ue,My).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,ue,Fa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?A(this,ue,My).call(this):t&&(A(this,ue,Fa).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var i,a,o;const{drawLayer:s}=this.parent;let r;c(this,Et)?(t=(t-this.rotation+360)%360,r=A(i=be,an,Pl).call(i,c(this,en).box,t)):r=A(a=be,an,Pl).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(c(this,Rs),{bbox:r,root:{"data-main-rotation":t}}),s.updateProperties(c(this,Ut),{bbox:A(o=be,an,Pl).call(o,c(this,fs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Qc)&&(t.setAttribute("aria-label",c(this,Qc)),t.setAttribute("role","mark")),c(this,Et)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,ue,gE).bind(this),{signal:this._uiManager._signal});const s=v(this,Fo,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=c(this,Oo);const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),BA(this,c(this,Fo),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Ut),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Ut),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,ue,Zp).call(this,!0);break;case 1:case 3:A(this,ue,Zp).call(this,!1);break}}select(){var t;super.select(),c(this,Ut)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Ut),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Ut)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Ut),{rootClass:{selected:!1}}),c(this,Et)||A(this,ue,Zp).call(this,!1))}get _mustFixPosition(){return!c(this,Et)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,Rs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Ut),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:r,x:i,y:a}){const{x:o,y:l,width:d,height:h}=r.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=y=>{f.abort(),A(this,an,wE).call(this,t,y)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",et,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",On,{signal:p}),r.addEventListener("pointermove",A(this,an,vE).bind(this,t),{signal:p}),this._freeHighlight=new Ty({x:i,y:a},[o,l,d,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,r){var x,_,g,w;let i=null;if(t instanceof X2){const{data:{quadPoints:b,rect:k,rotation:E,id:N,color:j,opacity:T,popupRef:M},parent:{page:{pageNumber:F}}}=t;i=t={annotationType:ae.HIGHLIGHT,color:Array.from(j),opacity:T,quadPoints:b,boxes:null,pageIndex:F-1,rect:k.slice(0),rotation:E,annotationElementId:N,id:N,deleted:!1,popupRef:M}}else if(t instanceof fw){const{data:{inkLists:b,rect:k,rotation:E,id:N,color:j,borderStyle:{rawWidth:T},popupRef:M},parent:{page:{pageNumber:F}}}=t;i=t={annotationType:ae.HIGHLIGHT,color:Array.from(j),thickness:T,inkLists:b,boxes:null,pageIndex:F-1,rect:k.slice(0),rotation:E,annotationElementId:N,id:N,deleted:!1,popupRef:M}}const{color:a,quadPoints:o,inkLists:l,opacity:d}=t,h=await super.deserialize(t,s,r);h.color=te.makeHexColor(...a),v(h,qr,d||1),l&&v(h,tn,t.thickness),h._initialData=i;const[f,p]=h.pageDimensions,[m,y]=h.pageTranslation;if(o){const b=v(h,Vr,[]);for(let k=0;k<o.length;k+=8)b.push({x:(o[k]-m)/f,y:1-(o[k+1]-y)/p,width:(o[k+2]-o[k])/f,height:(o[k+1]-o[k+5])/p});A(x=h,ue,Iy).call(x),A(_=h,ue,Fa).call(_),h.rotate(h.rotation)}else if(l){v(h,Et,!0);const b=l[0],k={x:b[0]-m,y:p-(b[1]-y)},E=new Ty(k,[0,0,f,p],1,c(h,tn)/2,!0,.001);for(let T=0,M=b.length;T<M;T+=2)k.x=b[T]-m,k.y=p-(b[T+1]-y),E.add(k);const{id:N,clipPathId:j}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);A(g=h,ue,Jp).call(g,{highlightOutlines:E.getOutlines(),highlightId:N,clipPathId:j}),A(w=h,ue,Fa).call(w),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),r=Le._colorManager.convert(this.color),i={annotationType:ae.HIGHLIGHT,color:r,opacity:c(this,qr),thickness:c(this,tn),quadPoints:A(this,ue,xE).call(this),outlines:A(this,ue,yE).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:A(this,ue,rd).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!A(this,ue,bE).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Kc=new WeakMap,yf=new WeakMap,Vr=new WeakMap,Oo=new WeakMap,vf=new WeakMap,fs=new WeakMap,wf=new WeakMap,bf=new WeakMap,Fo=new WeakMap,en=new WeakMap,Rs=new WeakMap,Et=new WeakMap,Yc=new WeakMap,qr=new WeakMap,Ut=new WeakMap,Qc=new WeakMap,tn=new WeakMap,_f=new WeakMap,ue=new WeakSet,Iy=function(){const t=new jy(c(this,Vr),.001);v(this,en,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,en).box;const s=new jy(c(this,Vr),.0025,.001,this._uiManager.direction==="ltr");v(this,fs,s.getOutlines());const{lastPoint:r}=c(this,fs);v(this,Yc,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Jp=function({highlightOutlines:t,highlightId:s,clipPathId:r}){var f,p;if(v(this,en,t),v(this,fs,t.getNewOutline(c(this,tn)/2+1.5,.0025)),s>=0)v(this,Rs,s),v(this,Oo,r),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),v(this,Ut,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,fs).box,path:{d:c(this,fs).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,Rs),{bbox:A(f=be,an,Pl).call(f,c(this,en).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Ut),{bbox:A(p=be,an,Pl).call(p,c(this,fs).box,m),path:{d:c(this,fs).toSVGPath()}})}const[a,o,l,d]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=d;break;case 90:{const[m,y]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*y/m,this.height=d*m/y;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=d;break;case 270:{const[m,y]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*y/m,this.height=d*m/y;break}}const{lastPoint:h}=c(this,fs);v(this,Yc,[(h[0]-a)/l,(h[1]-o)/d])},fE=function(t){const s=(a,o)=>{var l,d;this.color=a,v(this,qr,o),(l=this.parent)==null||l.drawLayer.updateProperties(c(this,Rs),{root:{fill:a,"fill-opacity":o}}),(d=c(this,vf))==null||d.updateColor(a)},r=this.color,i=c(this,qr);this.addCommands({cmd:s.bind(this,t,be._defaultOpacity),undo:s.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},pE=function(t){const s=c(this,tn),r=i=>{v(this,tn,i),A(this,ue,mE).call(this,i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},mE=function(t){if(!c(this,Et))return;A(this,ue,Jp).call(this,{highlightOutlines:c(this,en).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,r]=this.parentDimensions;this.setDims(this.width*s,this.height*r)},My=function(){c(this,Rs)===null||!this.parent||(this.parent.drawLayer.remove(c(this,Rs)),v(this,Rs,null),this.parent.drawLayer.remove(c(this,Ut)),v(this,Ut,null))},Fa=function(t=this.parent){c(this,Rs)===null&&({id:Gt(this,Rs)._,clipPathId:Gt(this,Oo)._}=t.drawLayer.draw({bbox:c(this,en).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,qr)},rootClass:{highlight:!0,free:c(this,Et)},path:{d:c(this,en).toSVGPath()}},!1,!0),v(this,Ut,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,Et)},bbox:c(this,fs).box,path:{d:c(this,fs).toSVGPath()}},c(this,Et))),c(this,Fo)&&(c(this,Fo).style.clipPath=c(this,Oo)))},an=new WeakSet,Pl=function([t,s,r,i],a){switch(a){case 90:return[1-s-i,t,i,r];case 180:return[1-t-r,1-s-i,r,i];case 270:return[s,1-t-r,i,r]}return[t,s,r,i]},gE=function(t){be._keyboardManager.exec(this,t)},Zp=function(t){if(!c(this,Kc))return;const s=window.getSelection();t?s.setPosition(c(this,Kc),c(this,yf)):s.setPosition(c(this,wf),c(this,bf))},rd=function(){return c(this,Et)?this.rotation:0},xE=function(){if(c(this,Et))return null;const[t,s]=this.pageDimensions,[r,i]=this.pageTranslation,a=c(this,Vr),o=new Float32Array(a.length*8);let l=0;for(const{x:d,y:h,width:f,height:p}of a){const m=d*t+r,y=(1-h)*s+i;o[l]=o[l+4]=m,o[l+1]=o[l+3]=y,o[l+2]=o[l+6]=m+f*t,o[l+5]=o[l+7]=y-p*s,l+=8}return o},yE=function(t){return c(this,en).serialize(t,A(this,ue,rd).call(this))},vE=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},wE=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},bE=function(t){const{color:s}=this._initialData;return t.color.some((r,i)=>r!==s[i])},S(be,an),W(be,"_defaultColor",null),W(be,"_defaultOpacity",1),W(be,"_defaultThickness",12),W(be,"_type","highlight"),W(be,"_editorType",ae.HIGHLIGHT),W(be,"_freeHighlightId",-1),W(be,"_freeHighlight",null),W(be,"_freeHighlightClipId","");let Wm=be;var $o;class _E{constructor(){S(this,$o,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){c(this,$o)[e]=t}toSVGProperties(){const e=c(this,$o);return v(this,$o,Object.create(null)),{root:e}}reset(){v(this,$o,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){je("Not implemented")}}$o=new WeakMap;var Ls,Jc,pt,Bo,Uo,Ki,Yi,Qi,zo,ve,Dy,Oy,Fy,id,SE,em,ad,Rl;const J=class J extends Le{constructor(t){super(t);S(this,ve);S(this,Ls,null);S(this,Jc);W(this,"_drawId",null);v(this,Jc,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(A(this,ve,Dy).call(this,t),A(this,ve,id).call(this))}static _mergeSVGProperties(t,s){const r=new Set(Object.keys(t));for(const[i,a]of Object.entries(s))r.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){je("Not implemented")}static get typesMap(){je("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,s),this._currentParent&&(c(J,pt).updateProperty(r,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,s[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,s[i]]);return t}_updateProperty(t,s,r){const i=this._drawingOptions,a=i[s],o=l=>{var h;i.updateProperty(s,l);const d=c(this,Ls).updateProperty(s,l);d&&A(this,ve,ad).call(this,d),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(c(this,Ls).getPathResizingSVGProperties(A(this,ve,em).call(this)),{bbox:A(this,ve,Rl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(c(this,Ls).getPathResizedSVGProperties(A(this,ve,em).call(this)),{bbox:A(this,ve,Rl).call(this)}))}_onTranslating(t,s){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:A(this,ve,Rl).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(c(this,Ls).getPathTranslatedSVGProperties(A(this,ve,em).call(this),this.parentDimensions),{bbox:A(this,ve,Rl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,Jc)&&(v(this,Jc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,ve,Fy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,ve,id).call(this),A(this,ve,ad).call(this,c(this,Ls).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,ve,Fy).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,ve,id).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties({bbox:A(this,ve,Rl).call(this)},c(this,Ls).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,ve,ad).call(this,c(this,Ls).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),r}static createDrawerInstance(t,s,r,i,a){je("Not implemented")}static startDrawing(t,s,r,i){var _;const{target:a,offsetX:o,offsetY:l,pointerId:d,pointerType:h}=i;if(c(J,Yi)&&c(J,Yi)!==h)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=a.getBoundingClientRect(),y=v(J,Bo,new AbortController),x=t.combinedSignal(y);if(c(J,Ki)||v(J,Ki,d),c(J,Yi)??v(J,Yi,h),window.addEventListener("pointerup",g=>{var w;c(J,Ki)===g.pointerId?this._endDraw(g):(w=c(J,Qi))==null||w.delete(g.pointerId)},{signal:x}),window.addEventListener("pointercancel",g=>{var w;c(J,Ki)===g.pointerId?this._currentParent.endDrawingSession():(w=c(J,Qi))==null||w.delete(g.pointerId)},{signal:x}),window.addEventListener("pointerdown",g=>{c(J,Yi)===g.pointerType&&((c(J,Qi)||v(J,Qi,new Set)).add(g.pointerId),c(J,pt).isCancellable()&&(c(J,pt).removeLastElement(),c(J,pt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",On,{signal:x}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),a.addEventListener("touchmove",g=>{g.timeStamp===c(J,zo)&&et(g)},{signal:x}),t.toggleDrawing(),(_=s._editorUndoBar)==null||_.hide(),c(J,pt)){t.drawLayer.updateProperties(this._currentDrawId,c(J,pt).startNew(o,l,p,m,f));return}s.updateUIForDefaultProperties(this),v(J,pt,this.createDrawerInstance(o,l,p,m,f)),v(J,Uo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(J,Uo).toSVGProperties(),c(J,pt).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(v(J,zo,-1),!c(J,pt))return;const{offsetX:s,offsetY:r,pointerId:i}=t;if(c(J,Ki)===i){if(((a=c(J,Qi))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(J,pt).add(s,r)),v(J,zo,t.timeStamp),et(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,v(J,pt,null),v(J,Uo,null),v(J,Yi,null),v(J,zo,NaN)),c(J,Bo)&&(c(J,Bo).abort(),v(J,Bo,null),v(J,Ki,NaN),v(J,Qi,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,c(J,pt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=c(J,pt),i=this._currentDrawId,a=r.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,r.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:xe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(xe.DRAW_STEP),!c(J,pt).isEmpty()){const{pageDimensions:[r,i],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(J,pt).getOutlines(r*a,i*a,a,this._INNER_MARGIN),drawingOptions:c(J,Uo),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,r,i,a,o){je("Not implemented")}static async deserialize(t,s,r){var f,p;const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}=s.viewport,d=this.deserializeDraw(o,l,i,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,r);return h.createDrawingOptions(t),A(f=h,ve,Dy).call(f,{drawOutlines:d}),A(p=h,ve,id).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,r]=this.pageTranslation,[i,a]=this.pageDimensions;return c(this,Ls).serialize([s,r,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ls=new WeakMap,Jc=new WeakMap,pt=new WeakMap,Bo=new WeakMap,Uo=new WeakMap,Ki=new WeakMap,Yi=new WeakMap,Qi=new WeakMap,zo=new WeakMap,ve=new WeakSet,Dy=function({drawOutlines:t,drawId:s,drawingOptions:r}){v(this,Ls,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,ve,Oy).call(this,t,this.parent),A(this,ve,ad).call(this,t.box)},Oy=function(t,s){const{id:r}=s.drawLayer.draw(J._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},Fy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},id=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,ve,Oy).call(this,c(this,Ls),t)}},SE=function([t,s,r,i]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[s,1-t,r*(o/a),i*(a/o)];case 180:return[1-t,1-s,r,i];case 270:return[1-s,t,r*(o/a),i*(a/o)];default:return[t,s,r,i]}},em=function(){const{x:t,y:s,width:r,height:i,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-s,t,r*(a/o),i*(o/a)];case 180:return[1-t,1-s,r,i];case 270:return[s,1-t,r*(a/o),i*(o/a)];default:return[t,s,r,i]}},ad=function(t){if([this.x,this.y,this.width,this.height]=A(this,ve,SE).call(this,t),this.div){this.fixAndSetPosition();const[s,r]=this.parentDimensions;this.setDims(this.width*s,this.height*r)}this._onResized()},Rl=function(){const{x:t,y:s,width:r,height:i,rotation:a,parentRotation:o,parentDimensions:[l,d]}=this;switch((a*4+o)/90){case 1:return[1-s-i,t,i,r];case 2:return[1-t-r,1-s-i,r,i];case 3:return[s,1-t-r,i,r];case 4:return[t,s-r*(l/d),i*(d/l),r*(l/d)];case 5:return[1-s,t,r*(l/d),i*(d/l)];case 6:return[1-t-i*(d/l),1-s,i*(d/l),r*(l/d)];case 7:return[s-r*(l/d),1-t-i*(d/l),r*(l/d),i*(d/l)];case 8:return[t-r,s-i,r,i];case 9:return[1-s,t-r,i,r];case 10:return[1-t,1-s,r,i];case 11:return[s-i,1-t,i,r];case 12:return[t-i*(d/l),s,i*(d/l),r*(l/d)];case 13:return[1-s-r*(l/d),t-i*(d/l),r*(l/d),i*(d/l)];case 14:return[1-t,1-s-r*(l/d),i*(d/l),r*(l/d)];case 15:return[s,1-t,r*(l/d),i*(d/l)];default:return[t,s,r,i]}},W(J,"_currentDrawId",-1),W(J,"_currentParent",null),S(J,pt,null),S(J,Bo,null),S(J,Uo,null),S(J,Ki,NaN),S(J,Yi,null),S(J,Qi,null),S(J,zo,NaN),W(J,"_INNER_MARGIN",3);let Vm=J;var tr,mt,gt,Ho,Zc,Yt,kt,sn,Wo,Vo,qo,eu,tm;class sI{constructor(e,t,s,r,i,a){S(this,eu);S(this,tr,new Float64Array(6));S(this,mt);S(this,gt);S(this,Ho);S(this,Zc);S(this,Yt);S(this,kt,"");S(this,sn,0);S(this,Wo,new Uf);S(this,Vo);S(this,qo);v(this,Vo,s),v(this,qo,r),v(this,Ho,i),v(this,Zc,a),[e,t]=A(this,eu,tm).call(this,e,t);const o=v(this,mt,[NaN,NaN,NaN,NaN,e,t]);v(this,Yt,[e,t]),v(this,gt,[{line:o,points:c(this,Yt)}]),c(this,tr).set(o,0)}updateProperty(e,t){e==="stroke-width"&&v(this,Zc,t)}isEmpty(){return!c(this,gt)||c(this,gt).length===0}isCancellable(){return c(this,Yt).length<=10}add(e,t){[e,t]=A(this,eu,tm).call(this,e,t);const[s,r,i,a]=c(this,tr).subarray(2,6),o=e-i,l=t-a;return Math.hypot(c(this,Vo)*o,c(this,qo)*l)<=2?null:(c(this,Yt).push(e,t),isNaN(s)?(c(this,tr).set([i,a,e,t],2),c(this,mt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,tr)[0])&&c(this,mt).splice(6,6),c(this,tr).set([s,r,i,a,e,t],0),c(this,mt).push(...Y.createBezierPoints(s,r,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(c(this,Yt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,r,i){v(this,Vo,s),v(this,qo,r),v(this,Ho,i),[e,t]=A(this,eu,tm).call(this,e,t);const a=v(this,mt,[NaN,NaN,NaN,NaN,e,t]);v(this,Yt,[e,t]);const o=c(this,gt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),c(this,gt).push({line:a,points:c(this,Yt)}),c(this,tr).set(a,0),v(this,sn,0),this.toSVGPath(),null}getLastElement(){return c(this,gt).at(-1)}setLastElement(e){return c(this,gt)?(c(this,gt).push(e),v(this,mt,e.line),v(this,Yt,e.points),v(this,sn,0),{path:{d:this.toSVGPath()}}):c(this,Wo).setLastElement(e)}removeLastElement(){if(!c(this,gt))return c(this,Wo).removeLastElement();c(this,gt).pop(),v(this,kt,"");for(let e=0,t=c(this,gt).length;e<t;e++){const{line:s,points:r}=c(this,gt)[e];v(this,mt,s),v(this,Yt,r),v(this,sn,0),this.toSVGPath()}return{path:{d:c(this,kt)}}}toSVGPath(){const e=Y.svgRound(c(this,mt)[4]),t=Y.svgRound(c(this,mt)[5]);if(c(this,Yt).length===2)return v(this,kt,`${c(this,kt)} M ${e} ${t} Z`),c(this,kt);if(c(this,Yt).length<=6){const r=c(this,kt).lastIndexOf("M");v(this,kt,`${c(this,kt).slice(0,r)} M ${e} ${t}`),v(this,sn,6)}if(c(this,Yt).length===4){const r=Y.svgRound(c(this,mt)[10]),i=Y.svgRound(c(this,mt)[11]);return v(this,kt,`${c(this,kt)} L ${r} ${i}`),v(this,sn,12),c(this,kt)}const s=[];c(this,sn)===0&&(s.push(`M ${e} ${t}`),v(this,sn,6));for(let r=c(this,sn),i=c(this,mt).length;r<i;r+=6){const[a,o,l,d,h,f]=c(this,mt).slice(r,r+6).map(Y.svgRound);s.push(`C${a} ${o} ${l} ${d} ${h} ${f}`)}return v(this,kt,c(this,kt)+s.join(" ")),v(this,sn,c(this,mt).length),c(this,kt)}getOutlines(e,t,s,r){const i=c(this,gt).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),c(this,Wo).build(c(this,gt),e,t,s,c(this,Ho),c(this,Zc),r),v(this,tr,null),v(this,mt,null),v(this,gt,null),v(this,kt,null),c(this,Wo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}tr=new WeakMap,mt=new WeakMap,gt=new WeakMap,Ho=new WeakMap,Zc=new WeakMap,Yt=new WeakMap,kt=new WeakMap,sn=new WeakMap,Wo=new WeakMap,Vo=new WeakMap,qo=new WeakMap,eu=new WeakSet,tm=function(e,t){return Y._normalizePoint(e,t,c(this,Vo),c(this,qo),c(this,Ho))};var Qt,Sf,Af,Is,sr,nr,tu,su,Go,Ct,gr,AE,EE,kE;class Uf extends Y{constructor(){super(...arguments);S(this,Ct);S(this,Qt);S(this,Sf,0);S(this,Af);S(this,Is);S(this,sr);S(this,nr);S(this,tu);S(this,su);S(this,Go)}build(t,s,r,i,a,o,l){v(this,sr,s),v(this,nr,r),v(this,tu,i),v(this,su,a),v(this,Go,o),v(this,Af,l??0),v(this,Is,t),A(this,Ct,EE).call(this)}get thickness(){return c(this,Go)}setLastElement(t){return c(this,Is).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,Is).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of c(this,Is)){if(t.push(`M${Y.svgRound(s[4])} ${Y.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${Y.svgRound(s[10])} ${Y.svgRound(s[11])}`);continue}for(let r=6,i=s.length;r<i;r+=6){const[a,o,l,d,h,f]=s.subarray(r,r+6).map(Y.svgRound);t.push(`C${a} ${o} ${l} ${d} ${h} ${f}`)}}return t.join("")}serialize([t,s,r,i],a){const o=[],l=[],[d,h,f,p]=A(this,Ct,AE).call(this);let m,y,x,_,g,w,b,k,E;switch(c(this,su)){case 0:E=Y._rescale,m=t,y=s+i,x=r,_=-i,g=t+d*r,w=s+(1-h-p)*i,b=t+(d+f)*r,k=s+(1-h)*i;break;case 90:E=Y._rescaleAndSwap,m=t,y=s,x=r,_=i,g=t+h*r,w=s+d*i,b=t+(h+p)*r,k=s+(d+f)*i;break;case 180:E=Y._rescale,m=t+r,y=s,x=-r,_=i,g=t+(1-d-f)*r,w=s+h*i,b=t+(1-d)*r,k=s+(h+p)*i;break;case 270:E=Y._rescaleAndSwap,m=t+r,y=s+i,x=-r,_=-i,g=t+(1-h-p)*r,w=s+(1-d-f)*i,b=t+(1-h)*r,k=s+(1-d)*i;break}for(const{line:N,points:j}of c(this,Is))o.push(E(N,m,y,x,_,a?new Array(N.length):null)),l.push(E(j,m,y,x,_,a?new Array(j.length):null));return{lines:o,points:l,rect:[g,w,b,k]}}static deserialize(t,s,r,i,a,{paths:{lines:o,points:l},rotation:d,thickness:h}){const f=[];let p,m,y,x,_;switch(d){case 0:_=Y._rescale,p=-t/r,m=s/i+1,y=1/r,x=-1/i;break;case 90:_=Y._rescaleAndSwap,p=-s/i,m=-t/r,y=1/i,x=1/r;break;case 180:_=Y._rescale,p=t/r+1,m=-s/i,y=-1/r,x=1/i;break;case 270:_=Y._rescaleAndSwap,p=s/i+1,m=t/r+1,y=-1/i,x=-1/r;break}if(!o){o=[];for(const w of l){const b=w.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const k=new Float32Array(3*(b-2));o.push(k);let[E,N,j,T]=w.subarray(0,4);k.set([NaN,NaN,NaN,NaN,E,N],0);for(let M=4;M<b;M+=2){const F=w[M],R=w[M+1];k.set(Y.createBezierPoints(E,N,j,T,F,R),(M-2)*3),[E,N,j,T]=[j,T,F,R]}}}for(let w=0,b=o.length;w<b;w++)f.push({line:_(o[w].map(k=>k??NaN),p,m,y,x),points:_(l[w].map(k=>k??NaN),p,m,y,x)});const g=new this.prototype.constructor;return g.build(f,r,i,1,d,h,a),g}get box(){return c(this,Qt)}updateProperty(t,s){return t==="stroke-width"?A(this,Ct,kE).call(this,s):null}updateParentDimensions([t,s],r){const[i,a]=A(this,Ct,gr).call(this);v(this,sr,t),v(this,nr,s),v(this,tu,r);const[o,l]=A(this,Ct,gr).call(this),d=o-i,h=l-a,f=c(this,Qt);return f[0]-=d,f[1]-=h,f[2]+=2*d,f[3]+=2*h,f}updateRotation(t){return v(this,Sf,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Qt).map(Y.svgRound).join(" ")}get defaultProperties(){const[t,s]=c(this,Qt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Y.svgRound(t)} ${Y.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=c(this,Qt);let r=0,i=0,a=0,o=0,l=0,d=0;switch(c(this,Sf)){case 90:i=s/t,a=-t/s,l=t;break;case 180:r=-1,o=-1,l=t,d=s;break;case 270:i=-s/t,a=t/s,d=s;break;default:return""}return`matrix(${r} ${i} ${a} ${o} ${Y.svgRound(l)} ${Y.svgRound(d)})`}getPathResizingSVGProperties([t,s,r,i]){const[a,o]=A(this,Ct,gr).call(this),[l,d,h,f]=c(this,Qt);if(Math.abs(h-a)<=Y.PRECISION||Math.abs(f-o)<=Y.PRECISION){const _=t+r/2-(l+h/2),g=s+i/2-(d+f/2);return{path:{"transform-origin":`${Y.svgRound(t)} ${Y.svgRound(s)}`,transform:`${this.rotationTransform} translate(${_} ${g})`}}}const p=(r-2*a)/(h-2*a),m=(i-2*o)/(f-2*o),y=h/r,x=f/i;return{path:{"transform-origin":`${Y.svgRound(l)} ${Y.svgRound(d)}`,transform:`${this.rotationTransform} scale(${y} ${x}) translate(${Y.svgRound(a)} ${Y.svgRound(o)}) scale(${p} ${m}) translate(${Y.svgRound(-a)} ${Y.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,r,i]){const[a,o]=A(this,Ct,gr).call(this),l=c(this,Qt),[d,h,f,p]=l;if(l[0]=t,l[1]=s,l[2]=r,l[3]=i,Math.abs(f-a)<=Y.PRECISION||Math.abs(p-o)<=Y.PRECISION){const g=t+r/2-(d+f/2),w=s+i/2-(h+p/2);for(const{line:b,points:k}of c(this,Is))Y._translate(b,g,w,b),Y._translate(k,g,w,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Y.svgRound(t)} ${Y.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*a)/(f-2*a),y=(i-2*o)/(p-2*o),x=-m*(d+a)+t+a,_=-y*(h+o)+s+o;if(m!==1||y!==1||x!==0||_!==0)for(const{line:g,points:w}of c(this,Is))Y._rescale(g,x,_,m,y,g),Y._rescale(w,x,_,m,y,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Y.svgRound(t)} ${Y.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],r){const[i,a]=r,o=c(this,Qt),l=t-o[0],d=s-o[1];if(c(this,sr)===i&&c(this,nr)===a)for(const{line:h,points:f}of c(this,Is))Y._translate(h,l,d,h),Y._translate(f,l,d,f);else{const h=c(this,sr)/i,f=c(this,nr)/a;v(this,sr,i),v(this,nr,a);for(const{line:p,points:m}of c(this,Is))Y._rescale(p,l,d,h,f,p),Y._rescale(m,l,d,h,f,m);o[2]*=h,o[3]*=f}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Y.svgRound(t)} ${Y.svgRound(s)}`}}}get defaultSVGProperties(){const t=c(this,Qt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Y.svgRound(t[0])} ${Y.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Qt=new WeakMap,Sf=new WeakMap,Af=new WeakMap,Is=new WeakMap,sr=new WeakMap,nr=new WeakMap,tu=new WeakMap,su=new WeakMap,Go=new WeakMap,Ct=new WeakSet,gr=function(t=c(this,Go)){const s=c(this,Af)+t/2*c(this,tu);return c(this,su)%180===0?[s/c(this,sr),s/c(this,nr)]:[s/c(this,nr),s/c(this,sr)]},AE=function(){const[t,s,r,i]=c(this,Qt),[a,o]=A(this,Ct,gr).call(this,0);return[t+a,s+o,r-2*a,i-2*o]},EE=function(){const t=v(this,Qt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of c(this,Is)){if(i.length<=12){for(let l=4,d=i.length;l<d;l+=6)te.pointBoundingBox(i[l],i[l+1],t);continue}let a=i[4],o=i[5];for(let l=6,d=i.length;l<d;l+=6){const[h,f,p,m,y,x]=i.subarray(l,l+6);te.bezierBoundingBox(a,o,h,f,p,m,y,x,t),a=y,o=x}}const[s,r]=A(this,Ct,gr).call(this);t[0]=es(t[0]-s,0,1),t[1]=es(t[1]-r,0,1),t[2]=es(t[2]+s,0,1),t[3]=es(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},kE=function(t){const[s,r]=A(this,Ct,gr).call(this);v(this,Go,t);const[i,a]=A(this,Ct,gr).call(this),[o,l]=[i-s,a-r],d=c(this,Qt);return d[0]-=o,d[1]-=l,d[2]+=2*o,d[3]+=2*l,d};class Ug extends _E{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Le._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Ug(this._viewParameters);return e.updateAll(this),e}}var cg,NE;const Xl=class Xl extends Vm{constructor(t){super({...t,name:"inkEditor"});S(this,cg);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Le.initialize(t,s),this._defaultDrawingOptions=new Ug(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ge(this,"typesMap",new Map([[xe.INK_THICKNESS,"stroke-width"],[xe.INK_COLOR,"stroke"],[xe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,r,i,a){return new sI(t,s,r,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,r,i,a,o){return Uf.deserialize(t,s,r,i,a,o)}static async deserialize(t,s,r){let i=null;if(t instanceof fw){const{data:{inkLists:o,rect:l,rotation:d,id:h,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:y},parent:{page:{pageNumber:x}}}=t;i=t={annotationType:ae.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:x-1,rect:l.slice(0),rotation:d,annotationElementId:h,id:h,deleted:!1,popupRef:y}}const a=await super.deserialize(t,s,r);return a._initialData=i,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:r}=this;s.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:r}){this._drawingOptions=Xl.getDefaultDrawingOptions({stroke:te.makeHexColor(...t),"stroke-width":s,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,d={annotationType:ae.INK,color:Le._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:s,points:r},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(d.isCopy=!0,d):this.annotationElementId&&!A(this,cg,NE).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(t){const{points:s,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:s}),null}};cg=new WeakSet,NE=function(t){const{color:s,thickness:r,opacity:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==s[l])||t.thickness!==r||t.opacity!==i||t.pageIndex!==a},W(Xl,"_type","ink"),W(Xl,"_editorType",ae.INK),W(Xl,"_defaultDrawingOptions",null);let $y=Xl;class By extends Uf{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const xp=8,Fu=3;var Xo,Se,Uy,Nn,jE,CE,zy,sm,TE,PE,RE,Hy,Wy,LE;class Jr{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:r},i,a,o,l){let d=new OffscreenCanvas(1,1),h=d.getContext("2d",{alpha:!1});const f=200,p=h.font=`${s} ${r} ${f}px ${t}`,{actualBoundingBoxLeft:m,actualBoundingBoxRight:y,actualBoundingBoxAscent:x,actualBoundingBoxDescent:_,fontBoundingBoxAscent:g,fontBoundingBoxDescent:w,width:b}=h.measureText(e),k=1.5,E=Math.ceil(Math.max(Math.abs(m)+Math.abs(y)||0,b)*k),N=Math.ceil(Math.max(Math.abs(x)+Math.abs(_)||f,Math.abs(g)+Math.abs(w)||f)*k);d=new OffscreenCanvas(E,N),h=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=p,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,E,N),h.fillStyle="black",h.fillText(e,E*(k-1)/2,N*(3-k)/2);const j=A(this,Se,Hy).call(this,h.getImageData(0,0,E,N).data),T=A(this,Se,RE).call(this,j),M=A(this,Se,Wy).call(this,T),F=A(this,Se,zy).call(this,j,E,N,M);return this.processDrawnLines({lines:{curves:F,width:E,height:N},pageWidth:i,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,s,r,i){const[a,o,l]=A(this,Se,LE).call(this,e),[d,h]=A(this,Se,PE).call(this,a,o,l,Math.hypot(o,l)*c(this,Xo).sigmaSFactor,c(this,Xo).sigmaR,c(this,Xo).kernelSize),f=A(this,Se,Wy).call(this,h),p=A(this,Se,zy).call(this,d,o,l,f);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:a,areContours:o}){r%180!==0&&([t,s]=[s,t]);const{curves:l,width:d,height:h}=e,f=e.thickness??0,p=[],m=Math.min(t/d,s/h),y=m/t,x=m/s,_=[];for(const{points:w}of l){const b=a?A(this,Se,TE).call(this,w):w;if(!b)continue;_.push(b);const k=b.length,E=new Float32Array(k),N=new Float32Array(3*(k===2?2:k-2));if(p.push({line:N,points:E}),k===2){E[0]=b[0]*y,E[1]=b[1]*x,N.set([NaN,NaN,NaN,NaN,E[0],E[1]],0);continue}let[j,T,M,F]=b;j*=y,T*=x,M*=y,F*=x,E.set([j,T,M,F],0),N.set([NaN,NaN,NaN,NaN,j,T],0);for(let R=4;R<k;R+=2){const V=E[R]=b[R]*y,$=E[R+1]=b[R+1]*x;N.set(Y.createBezierPoints(j,T,M,F,V,$),(R-2)*3),[j,T,M,F]=[M,F,V,$]}}if(p.length===0)return null;const g=o?new By:new Uf;return g.build(p,t,s,1,r,o?0:f,i),{outline:g,newCurves:_,areContours:o,thickness:f,width:d,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:r,height:i}){let a=1/0,o=-1/0,l=0;for(const b of e){l+=b.length;for(let k=2,E=b.length;k<E;k++){const N=b[k]-b[k-2];a=Math.min(a,N),o=Math.max(o,N)}}let d;a>=-128&&o<=127?d=Int8Array:a>=-32768&&o<=32767?d=Int16Array:d=Int32Array;const h=e.length,f=xp+Fu*h,p=new Uint32Array(f);let m=0;p[m++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*d.BYTES_PER_ELEMENT,p[m++]=0,p[m++]=r,p[m++]=i,p[m++]=t?0:1,p[m++]=Math.max(0,Math.floor(s??0)),p[m++]=h,p[m++]=d.BYTES_PER_ELEMENT;for(const b of e)p[m++]=b.length-2,p[m++]=b[0],p[m++]=b[1];const y=new CompressionStream("deflate-raw"),x=y.writable.getWriter();await x.ready,x.write(p);const _=d.prototype.constructor;for(const b of e){const k=new _(b.length-2);for(let E=2,N=b.length;E<N;E++)k[E-2]=b[E]-b[E-2];x.write(k)}x.close();const g=await new Response(y.readable).arrayBuffer(),w=new Uint8Array(g);return LA(w)}static async decompressSignature(e){try{const t=kR(e),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let a=null,o=0;for await(const b of s)a||(a=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),a.set(b,o),o+=b.length;const l=new Uint32Array(a.buffer,0,a.length>>2),d=l[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const h=l[2],f=l[3],p=l[4]===0,m=l[5],y=l[6],x=l[7],_=[],g=(xp+Fu*y)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(x){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(a.buffer,g);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(a.buffer,g);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(a.buffer,g);break}o=0;for(let b=0;b<y;b++){const k=l[Fu*b+xp],E=new Float32Array(k+2);_.push(E);for(let N=0;N<Fu-1;N++)E[N]=l[Fu*b+xp+N+1];for(let N=0;N<k;N++)E[N+2]=E[N]+w[o++]}return{areContours:p,thickness:m,outlines:_,width:h,height:f}}catch(t){return oe(`decompressSignature: ${t}`),null}}}Xo=new WeakMap,Se=new WeakSet,Uy=function(e,t,s,r){return s-=e,r-=t,s===0?r>0?0:4:s===1?r+6:2-r},Nn=new WeakMap,jE=function(e,t,s,r,i,a,o){const l=A(this,Se,Uy).call(this,s,r,i,a);for(let d=0;d<8;d++){const h=(-d+l-o+16)%8,f=c(this,Nn)[2*h],p=c(this,Nn)[2*h+1];if(e[(s+f)*t+(r+p)]!==0)return h}return-1},CE=function(e,t,s,r,i,a,o){const l=A(this,Se,Uy).call(this,s,r,i,a);for(let d=0;d<8;d++){const h=(d+l+o+16)%8,f=c(this,Nn)[2*h],p=c(this,Nn)[2*h+1];if(e[(s+f)*t+(r+p)]!==0)return h}return-1},zy=function(e,t,s,r){const i=e.length,a=new Int32Array(i);for(let h=0;h<i;h++)a[h]=e[h]<=r?1:0;for(let h=1;h<s-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*s-1-h]=0;let o=1,l;const d=[];for(let h=1;h<s-1;h++){l=1;for(let f=1;f<t-1;f++){const p=h*t+f,m=a[p];if(m===0)continue;let y=h,x=f;if(m===1&&a[p-1]===0)o+=1,x-=1;else if(m>=1&&a[p+1]===0)o+=1,x+=1,m>1&&(l=m);else{m!==1&&(l=Math.abs(m));continue}const _=[f,h],g=x===f+1,w={isHole:g,points:_,id:o,parent:0};d.push(w);let b;for(const R of d)if(R.id===l){b=R;break}b?b.isHole?w.parent=g?b.parent:l:w.parent=g?l:b.parent:w.parent=g?l:0;const k=A(this,Se,jE).call(this,a,t,h,f,y,x,0);if(k===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let E=c(this,Nn)[2*k],N=c(this,Nn)[2*k+1];const j=h+E,T=f+N;y=j,x=T;let M=h,F=f;for(;;){const R=A(this,Se,CE).call(this,a,t,M,F,y,x,1);E=c(this,Nn)[2*R],N=c(this,Nn)[2*R+1];const V=M+E,$=F+N;_.push($,V);const D=M*t+F;if(a[D+1]===0?a[D]=-o:a[D]===1&&(a[D]=o),V===h&&$===f&&M===j&&F===T){a[p]!==1&&(l=Math.abs(a[p]));break}else y=M,x=F,M=V,F=$}}}return d},sm=function(e,t,s,r){if(s-t<=4){for(let j=t;j<s-2;j+=2)r.push(e[j],e[j+1]);return}const i=e[t],a=e[t+1],o=e[s-4]-i,l=e[s-3]-a,d=Math.hypot(o,l),h=o/d,f=l/d,p=h*a-f*i,m=l/o,y=1/d,x=Math.atan(m),_=Math.cos(x),g=Math.sin(x),w=y*(Math.abs(_)+Math.abs(g)),b=y*(1-w+w**2),k=Math.max(Math.atan(Math.abs(g+_)*b),Math.atan(Math.abs(g-_)*b));let E=0,N=t;for(let j=t+2;j<s-2;j+=2){const T=Math.abs(p-h*e[j+1]+f*e[j]);T>E&&(N=j,E=T)}E>(d*k)**2?(A(this,Se,sm).call(this,e,t,N+2,r),A(this,Se,sm).call(this,e,N,s,r)):r.push(i,a)},TE=function(e){const t=[],s=e.length;return A(this,Se,sm).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},PE=function(e,t,s,r,i,a){const o=new Float32Array(a**2),l=-2*r**2,d=a>>1;for(let x=0;x<a;x++){const _=(x-d)**2;for(let g=0;g<a;g++)o[x*a+g]=Math.exp((_+(g-d)**2)/l)}const h=new Float32Array(256),f=-2*i**2;for(let x=0;x<256;x++)h[x]=Math.exp(x**2/f);const p=e.length,m=new Uint8Array(p),y=new Uint32Array(256);for(let x=0;x<s;x++)for(let _=0;_<t;_++){const g=x*t+_,w=e[g];let b=0,k=0;for(let N=0;N<a;N++){const j=x+N-d;if(!(j<0||j>=s))for(let T=0;T<a;T++){const M=_+T-d;if(M<0||M>=t)continue;const F=e[j*t+M],R=o[N*a+T]*h[Math.abs(F-w)];b+=F*R,k+=R}}const E=m[g]=Math.round(b/k);y[E]++}return[m,y]},RE=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},Hy=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let r=-1/0,i=1/0;for(let o=0,l=s.length;o<l;o++){if(e[(o<<2)+3]===0){r=s[o]=255;continue}const h=s[o]=e[o<<2];h>r&&(r=h),h<i&&(i=h)}const a=255/(r-i);for(let o=0;o<t;o++)s[o]=(s[o]-i)*a;return s},Wy=function(e){let t,s=-1/0,r=-1/0;const i=e.findIndex(l=>l!==0);let a=i,o=i;for(t=i;t<256;t++){const l=e[t];l>s&&(t-a>r&&(r=t-a,o=t-1),s=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},LE=function(e){const t=e,{width:s,height:r}=e,{maxDim:i}=c(this,Xo);let a=s,o=r;if(s>i||r>i){let p=s,m=r,y=Math.log2(Math.max(s,r)/i);const x=Math.floor(y);y=y===x?x-1:x;for(let g=0;g<y;g++){a=Math.ceil(p/2),o=Math.ceil(m/2);const w=new OffscreenCanvas(a,o);w.getContext("2d").drawImage(e,0,0,p,m,0,0,a,o),p=a,m=o,e!==t&&e.close(),e=w.transferToImageBitmap()}const _=Math.min(i/a,i/o);a=Math.round(a*_),o=Math.round(o*_)}const d=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=d.getImageData(0,0,a,o).data;return[A(this,Se,Hy).call(this,h),a,o]},S(Jr,Se),S(Jr,Xo,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),S(Jr,Nn,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class pw extends _E{constructor(){super(),super.updateProperties({fill:Le._defaultLineColor,"stroke-width":0})}clone(){const e=new pw;return e.updateAll(this),e}}class mw extends Ug{constructor(e){super(e),super.updateProperties({stroke:Le._defaultLineColor,"stroke-width":1})}clone(){const e=new mw(this._viewParameters);return e.updateAll(this),e}}var Ji,rr,Zi,Ko;const _s=class _s extends Vm{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});S(this,Ji,!1);S(this,rr,null);S(this,Zi,null);S(this,Ko,null);this._willKeepAspectRatio=!0,v(this,Zi,t.signatureData||null),v(this,rr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Le.initialize(t,s),this._defaultDrawingOptions=new pw,this._defaultDrawnSignatureOptions=new mw(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return ge(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!c(this,rr)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(c(this,Zi)){const{lines:i,mustSmooth:a,areContours:o,description:l,uuid:d,heightInPage:h}=c(this,Zi),{rawDims:{pageWidth:f,pageHeight:p},rotation:m}=this.parent.viewport,y=Jr.processDrawnLines({lines:i,pageWidth:f,pageHeight:p,rotation:m,innerMargin:_s._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(y,h,l,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return r&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){v(this,Ko,t),this.addEditToolbar()}getUuid(){return c(this,Ko)}get description(){return c(this,rr)}set description(t){v(this,rr,t),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:r,width:i,height:a}=c(this,Zi),o=Math.max(i,a),l=Jr.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:r,width:i,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,r,i){const{x:a,y:o}=this,{outline:l}=v(this,Zi,t);v(this,Ji,l instanceof By),this.description=r,this.div.setAttribute("data-l10n-args",JSON.stringify({description:r}));let d;c(this,Ji)?d=_s.getDefaultDrawingOptions():(d=_s._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:d});const[h,f]=this.parentDimensions,[,p]=this.pageDimensions;let m=s/p;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(h*this.width,f*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return Jr.process(t,s,r,i,_s._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:r,pageHeight:i},rotation:a}=this.parent.viewport;return Jr.extractContoursFromText(t,s,r,i,a,_s._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return Jr.processDrawnLines({lines:t,pageWidth:s,pageHeight:r,rotation:i,innerMargin:_s._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=_s.getDefaultDrawingOptions():(this._drawingOptions=_s._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:ae.SIGNATURE,isSignature:!0,areContours:c(this,Ji),color:[0,0,0],thickness:c(this,Ji)?0:a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:s,points:r},o.uuid=c(this,Ko),o.isCopy=!0):o.lines=s,c(this,rr)&&(o.accessibilityData={type:"Figure",alt:c(this,rr)}),o}static deserializeDraw(t,s,r,i,a,o){return o.areContours?By.deserialize(t,s,r,i,a,o):Uf.deserialize(t,s,r,i,a,o)}static async deserialize(t,s,r){var a;const i=await super.deserialize(t,s,r);return v(i,Ji,t.areContours),v(i,rr,((a=t.accessibilityData)==null?void 0:a.alt)||""),v(i,Ko,t.uuid),i}};Ji=new WeakMap,rr=new WeakMap,Zi=new WeakMap,Ko=new WeakMap,W(_s,"_type","signature"),W(_s,"_editorType",ae.SIGNATURE),W(_s,"_defaultDrawingOptions",null);let Vy=_s;var Fe,xt,ea,Gr,ta,nu,Xr,Yo,ir,Ms,ru,we,od,ld,nm,rm,im,Gy,am,IE;class qy extends Le{constructor(t){super({...t,name:"stampEditor"});S(this,we);S(this,Fe,null);S(this,xt,null);S(this,ea,null);S(this,Gr,null);S(this,ta,null);S(this,nu,"");S(this,Xr,null);S(this,Yo,!1);S(this,ir,null);S(this,Ms,!1);S(this,ru,!1);v(this,Gr,t.bitmapUrl),v(this,ta,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Le.initialize(t,s)}static isHandlingMimeForPasting(t){return $x.includes(t)}static paste(t,s){s.pasteEditor({mode:ae.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const d=l.output;return await this.setGuessedAltText(d),s&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var t;c(this,xt)&&(v(this,Fe,null),this._uiManager.imageManager.deleteId(c(this,xt)),(t=c(this,Xr))==null||t.remove(),v(this,Xr,null),c(this,ir)&&(clearTimeout(c(this,ir)),v(this,ir,null))),super.remove()}rebuild(){if(!this.parent){c(this,xt)&&A(this,we,nm).call(this);return}super.rebuild(),this.div!==null&&(c(this,xt)&&c(this,Xr)===null&&A(this,we,nm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,ea)||c(this,Fe)||c(this,Gr)||c(this,ta)||c(this,xt)||c(this,Yo))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),c(this,Yo)||(c(this,Fe)?A(this,we,rm).call(this):A(this,we,nm).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(v(this,xt,r),i&&v(this,Fe,i),v(this,Yo,!1),A(this,we,rm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,ir)!==null&&clearTimeout(c(this,ir)),v(this,ir,setTimeout(()=>{v(this,ir,null),A(this,we,Gy).call(this)},200))}copyCanvas(t,s,r=!1){var m;t||(t=224);const{width:i,height:a}=c(this,Fe),o=new dr;let l=c(this,Fe),d=i,h=a,f=null;if(s){if(i>s||a>s){const T=Math.min(s/i,s/a);d=Math.floor(i*T),h=Math.floor(a*T)}f=document.createElement("canvas");const y=f.width=Math.ceil(d*o.sx),x=f.height=Math.ceil(h*o.sy);c(this,Ms)||(l=A(this,we,im).call(this,y,x));const _=f.getContext("2d");_.filter=this._uiManager.hcmFilter;let g="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(g="#8f8f9d",w="#42414d");const b=15,k=b*o.sx,E=b*o.sy,N=new OffscreenCanvas(k*2,E*2),j=N.getContext("2d");j.fillStyle=g,j.fillRect(0,0,k*2,E*2),j.fillStyle=w,j.fillRect(0,0,k,E),j.fillRect(k,E,k,E),_.fillStyle=_.createPattern(N,"repeat"),_.fillRect(0,0,y,x),_.drawImage(l,0,0,l.width,l.height,0,0,y,x)}let p=null;if(r){let y,x;if(o.symmetric&&l.width<t&&l.height<t)y=l.width,x=l.height;else if(l=c(this,Fe),i>t||a>t){const w=Math.min(t/i,t/a);y=Math.floor(i*w),x=Math.floor(a*w),c(this,Ms)||(l=A(this,we,im).call(this,y,x))}const g=new OffscreenCanvas(y,x).getContext("2d",{willReadFrequently:!0});g.drawImage(l,0,0,l.width,l.height,0,0,y,x),p={width:y,height:x,data:g.getImageData(0,0,y,x).data}}return{canvas:f,width:d,height:h,imageData:p}}static async deserialize(t,s,r){var _;let i=null,a=!1;if(t instanceof K2){const{data:{rect:g,rotation:w,id:b,structParent:k,popupRef:E},container:N,parent:{page:{pageNumber:j}},canvas:T}=t;let M,F;T?(delete t.canvas,{id:M,bitmap:F}=r.imageManager.getFromCanvas(N.id,T),T.remove()):(a=!0,t._hasNoCanvas=!0);const R=((_=await s._structTree.getAriaAttributes(`${iw}${b}`))==null?void 0:_.get("aria-label"))||"";i=t={annotationType:ae.STAMP,bitmapId:M,bitmap:F,pageIndex:j-1,rect:g.slice(0),rotation:w,annotationElementId:b,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:k,popupRef:E}}const o=await super.deserialize(t,s,r),{rect:l,bitmap:d,bitmapUrl:h,bitmapId:f,isSvg:p,accessibilityData:m}=t;a?(r.addMissingCanvas(t.id,o),v(o,Yo,!0)):f&&r.imageManager.isValidId(f)?(v(o,xt,f),d&&v(o,Fe,d)):v(o,Gr,h),v(o,Ms,p);const[y,x]=o.pageDimensions;return o.width=(l[2]-l[0])/y,o.height=(l[3]-l[1])/x,m&&(o.altTextData=m),o._initialData=i,v(o,ru,!!i),o}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:ae.STAMP,bitmapId:c(this,xt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,Ms),structTreeParentId:this._structTreeParentId};if(t)return r.bitmapUrl=A(this,we,am).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(r.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=A(this,we,IE).call(this,r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,s===null)return r;s.stamps||(s.stamps=new Map);const o=c(this,Ms)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!s.stamps.has(c(this,xt)))s.stamps.set(c(this,xt),{area:o,serialized:r}),r.bitmap=A(this,we,am).call(this,!1);else if(c(this,Ms)){const l=s.stamps.get(c(this,xt));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=A(this,we,am).call(this,!1))}return r}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Fe=new WeakMap,xt=new WeakMap,ea=new WeakMap,Gr=new WeakMap,ta=new WeakMap,nu=new WeakMap,Xr=new WeakMap,Yo=new WeakMap,ir=new WeakMap,Ms=new WeakMap,ru=new WeakMap,we=new WeakSet,od=function(t,s=!1){if(!t){this.remove();return}v(this,Fe,t.bitmap),s||(v(this,xt,t.id),v(this,Ms,t.isSvg)),t.file&&v(this,nu,t.file.name),A(this,we,rm).call(this)},ld=function(){if(v(this,ea,null),this._uiManager.enableWaiting(!1),!!c(this,Xr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Fe)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},nm=function(){if(c(this,xt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,xt)).then(r=>A(this,we,od).call(this,r,!0)).finally(()=>A(this,we,ld).call(this));return}if(c(this,Gr)){const r=c(this,Gr);v(this,Gr,null),this._uiManager.enableWaiting(!0),v(this,ea,this._uiManager.imageManager.getFromUrl(r).then(i=>A(this,we,od).call(this,i)).finally(()=>A(this,we,ld).call(this)));return}if(c(this,ta)){const r=c(this,ta);v(this,ta,null),this._uiManager.enableWaiting(!0),v(this,ea,this._uiManager.imageManager.getFromFile(r).then(i=>A(this,we,od).call(this,i)).finally(()=>A(this,we,ld).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=$x.join(",");const s=this._uiManager._signal;v(this,ea,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,we,od).call(this,i)}r()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:s})}).finally(()=>A(this,we,ld).call(this))),t.click()},rm=function(){var f;const{div:t}=this;let{width:s,height:r}=c(this,Fe);const[i,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*i,r=this.height*a;else if(s>o*i||r>o*a){const p=Math.min(o*i/s,o*a/r);s*=p,r*=p}const[l,d]=this.parentDimensions;this.setDims(s*l/i,r*d/a),this._uiManager.enableWaiting(!1);const h=v(this,Xr,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/i,this.height=r/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,we,Gy).call(this),c(this,ru)||(this.parent.addUndoableEditor(this),v(this,ru,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,nu)&&this.div.setAttribute("aria-description",c(this,nu)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},im=function(t,s){const{width:r,height:i}=c(this,Fe);let a=r,o=i,l=c(this,Fe);for(;a>2*t||o>2*s;){const d=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,d,h,0,0,a,o),l=f.transferToImageBitmap()}return l},Gy=function(){const[t,s]=this.parentDimensions,{width:r,height:i}=this,a=new dr,o=Math.ceil(r*t*a.sx),l=Math.ceil(i*s*a.sy),d=c(this,Xr);if(!d||d.width===o&&d.height===l)return;d.width=o,d.height=l;const h=c(this,Ms)?c(this,Fe):A(this,we,im).call(this,o,l),f=d.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,l)},am=function(t){if(t){if(c(this,Ms)){const i=this._uiManager.imageManager.getSvgUrl(c(this,xt));if(i)return i}const s=document.createElement("canvas");return{width:s.width,height:s.height}=c(this,Fe),s.getContext("2d").drawImage(c(this,Fe),0,0),s.toDataURL()}if(c(this,Ms)){const[s,r]=this.pageDimensions,i=Math.round(this.width*s*ba.PDF_TO_CSS_UNITS),a=Math.round(this.height*r*ba.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(c(this,Fe),0,0,c(this,Fe).width,c(this,Fe).height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(c(this,Fe))},IE=function(t){var o;const{pageIndex:s,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}},W(qy,"_type","stamp"),W(qy,"_editorType",ae.STAMP);var Qo,iu,ar,sa,Kr,Ds,na,au,Jo,jn,Yr,yt,Qr,ra,ou,ee,ia,$e,ME,zn,Ky,Yy,om;const gn=class gn{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:r,accessibilityManager:i,annotationLayer:a,drawLayer:o,textLayer:l,viewport:d,l10n:h}){S(this,$e);S(this,Qo);S(this,iu,!1);S(this,ar,null);S(this,sa,null);S(this,Kr,null);S(this,Ds,new Map);S(this,na,!1);S(this,au,!1);S(this,Jo,!1);S(this,jn,null);S(this,Yr,null);S(this,yt,null);S(this,Qr,null);S(this,ra,null);S(this,ou,-1);S(this,ee);const f=[...c(gn,ia).values()];if(!gn._initialized){gn._initialized=!0;for(const p of f)p.initialize(h,e)}e.registerEditorTypes(f),v(this,ee,e),this.pageIndex=t,this.div=s,v(this,Qo,i),v(this,ar,a),this.viewport=d,v(this,yt,l),this.drawLayer=o,this._structTree=r,c(this,ee).addLayer(this)}get isEmpty(){return c(this,Ds).size===0}get isInvisible(){return this.isEmpty&&c(this,ee).getMode()===ae.NONE}updateToolbar(e){c(this,ee).updateToolbar(e)}updateMode(e=c(this,ee).getMode()){switch(A(this,$e,om).call(this),e){case ae.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ae.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ae.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of c(gn,ia).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,yt))==null?void 0:t.div)}setEditingState(e){c(this,ee).setEditingState(e)}addCommands(e){c(this,ee).addCommands(e)}cleanUndoStack(e){c(this,ee).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,ar))==null||t.div.classList.toggle("disabled",!e)}async enable(){var s;v(this,Jo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(s=c(this,ra))==null||s.abort(),v(this,ra,null);const e=new Set;for(const r of c(this,Ds).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(c(this,ee).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!c(this,ar)){v(this,Jo,!1);return}const t=c(this,ar).getEditableAnnotations();for(const r of t){if(r.hide(),c(this,ee).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}v(this,Jo,!1)}disable(){var r;if(v(this,au,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),c(this,yt)&&!c(this,ra)){v(this,ra,new AbortController);const i=c(this,ee).combinedSignal(c(this,ra));c(this,yt).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:d,timeStamp:h}=a,f=c(this,ou);if(h-f>500){v(this,ou,h);return}v(this,ou,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const m=document.elementsFromPoint(l,d);if(p.toggle("getElements",!1),!this.div.contains(m[0]))return;let y;const x=new RegExp(`^${jA}[0-9]+$`);for(const g of m)if(x.test(g.id)){y=g.id;break}if(!y)return;const _=c(this,Ds).get(y);(_==null?void 0:_.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),_.dblclick())},{signal:i,capture:!0})}const e=new Map,t=new Map;for(const i of c(this,Ds).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(r=this.getEditableAnnotation(i.annotationElementId))==null||r.show(),i.remove()}if(c(this,ar)){const i=c(this,ar).getEditableAnnotations();for(const a of i){const{id:o}=a.data;if(c(this,ee).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(c(this,ee).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}A(this,$e,om).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of c(gn,ia).values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,au,!1)}getEditableAnnotation(e){var t;return((t=c(this,ar))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,ee).getActive()!==e&&c(this,ee).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,yt))!=null&&e.div&&!c(this,Qr)){v(this,Qr,new AbortController);const t=c(this,ee).combinedSignal(c(this,Qr));c(this,yt).div.addEventListener("pointerdown",A(this,$e,ME).bind(this),{signal:t}),c(this,yt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,yt))!=null&&e.div&&c(this,Qr)&&(c(this,Qr).abort(),v(this,Qr,null),c(this,yt).div.classList.remove("highlighting"))}enableClick(){if(c(this,sa))return;v(this,sa,new AbortController);const e=c(this,ee).combinedSignal(c(this,sa));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,sa))==null||e.abort(),v(this,sa,null)}attach(e){c(this,Ds).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,ee).isDeletedAnnotationElement(t)&&c(this,ee).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,Ds).delete(e.id),(t=c(this,Qo))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,au)&&e.annotationElementId&&c(this,ee).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,ee).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,ee).addDeletedAnnotationElement(e.annotationElementId),Le.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,ee).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,Jo)),c(this,ee).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Kr)&&(e._focusEventsAllowed=!1,v(this,Kr,setTimeout(()=>{v(this,Kr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,ee)._signal}),t.focus())},0))),e._structTreeParentId=(s=c(this,Qo))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return c(this,ee).getId()}combinedSignal(e){return c(this,ee).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,$e,zn))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await c(this,ee).updateMode(e.mode);const{offsetX:s,offsetY:r}=A(this,$e,Yy).call(this),i=this.getNextId(),a=A(this,$e,Ky).call(this,{parent:this,id:i,x:s,y:r,uiManager:c(this,ee),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=c(gn,ia).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,ee)))||null}createAndAddNewEditor(e,t,s={}){const r=this.getNextId(),i=A(this,$e,Ky).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:c(this,ee),isCentered:t,...s});return i&&this.add(i),i}addNewEditor(e={}){this.createAndAddNewEditor(A(this,$e,Yy).call(this),!0,e)}setSelected(e){c(this,ee).setSelected(e)}toggleSelected(e){c(this,ee).toggleSelected(e)}unselect(e){c(this,ee).unselect(e)}pointerup(e){var r;const{isMac:t}=Pt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!c(this,na)||(v(this,na,!1),(r=c(this,$e,zn))!=null&&r.isDrawer&&c(this,$e,zn).supportMultipleDrawings))return;if(!c(this,iu)){v(this,iu,!0);return}const s=c(this,ee).getMode();if(s===ae.STAMP||s===ae.SIGNATURE){c(this,ee).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(c(this,ee).getMode()===ae.HIGHLIGHT&&this.enableTextSelection(),c(this,na)){v(this,na,!1);return}const{isMac:t}=Pt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(v(this,na,!0),(r=c(this,$e,zn))!=null&&r.isDrawer){this.startDrawingSession(e);return}const s=c(this,ee).getActive();v(this,iu,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),c(this,jn)){c(this,$e,zn).startDrawing(this,c(this,ee),!1,e);return}c(this,ee).setCurrentDrawingSession(this),v(this,jn,new AbortController);const t=c(this,ee).combinedSignal(c(this,jn));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(v(this,Yr,null),this.commitOrRemove())},{signal:t}),c(this,$e,zn).startDrawing(this,c(this,ee),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&v(this,Yr,t);return}c(this,Yr)&&setTimeout(()=>{var t;(t=c(this,Yr))==null||t.focus(),v(this,Yr,null)},0)}endDrawingSession(e=!1){return c(this,jn)?(c(this,ee).setCurrentDrawingSession(null),c(this,jn).abort(),v(this,jn,null),v(this,Yr,null),c(this,$e,zn).endDrawing(e)):null}findNewParent(e,t,s){const r=c(this,ee).findParent(t,s);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return c(this,jn)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,jn)&&c(this,$e,zn).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,ee).getActive())==null?void 0:e.parent)===this&&(c(this,ee).commitOrRemove(),c(this,ee).setActiveEditor(null)),c(this,Kr)&&(clearTimeout(c(this,Kr)),v(this,Kr,null));for(const s of c(this,Ds).values())(t=c(this,Qo))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,c(this,Ds).clear(),c(this,ee).removeLayer(this)}render({viewport:e}){this.viewport=e,ll(this.div,e);for(const t of c(this,ee).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,ee).commitOrRemove(),A(this,$e,om).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,ll(this.div,{rotation:s}),t!==s)for(const r of c(this,Ds).values())r.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,ee).viewParameters.realScale}};Qo=new WeakMap,iu=new WeakMap,ar=new WeakMap,sa=new WeakMap,Kr=new WeakMap,Ds=new WeakMap,na=new WeakMap,au=new WeakMap,Jo=new WeakMap,jn=new WeakMap,Yr=new WeakMap,yt=new WeakMap,Qr=new WeakMap,ra=new WeakMap,ou=new WeakMap,ee=new WeakMap,ia=new WeakMap,$e=new WeakSet,ME=function(e){c(this,ee).unselectAll();const{target:t}=e;if(t===c(this,yt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,yt).div.contains(t)){const{isMac:s}=Pt.platform;if(e.button!==0||e.ctrlKey&&s)return;c(this,ee).showAllEditors("highlight",!0,!0),c(this,yt).div.classList.add("free"),this.toggleDrawing(),Wm.startHighlighting(this,c(this,ee).direction==="ltr",{target:c(this,yt).div,x:e.x,y:e.y}),c(this,yt).div.addEventListener("pointerup",()=>{c(this,yt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,ee)._signal}),e.preventDefault()}},zn=function(){return c(gn,ia).get(c(this,ee).getMode())},Ky=function(e){const t=c(this,$e,zn);return t?new t.prototype.constructor(e):null},Yy=function(){const{x:e,y:t,width:s,height:r}=this.div.getBoundingClientRect(),i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+r),d=(i+o)/2-e,h=(a+l)/2-t,[f,p]=this.viewport.rotation%180===0?[d,h]:[h,d];return{offsetX:f,offsetY:p}},om=function(){for(const e of c(this,Ds).values())e.isEmpty()&&e.remove()},W(gn,"_initialized",!1),S(gn,ia,new Map([ky,$y,qy,Wm,Vy].map(e=>[e._editorType,e])));let Xy=gn;var Cn,Jt,Zo,Ef,ug,DE,hr,Jy,OE,Zy;const at=class at{constructor({pageIndex:e}){S(this,hr);S(this,Cn,null);S(this,Jt,new Map);S(this,Zo,new Map);this.pageIndex=e}setParent(e){if(!c(this,Cn)){v(this,Cn,e);return}if(c(this,Cn)!==e){if(c(this,Jt).size>0)for(const t of c(this,Jt).values())t.remove(),e.append(t);v(this,Cn,e)}}static get _svgFactory(){return ge(this,"_svgFactory",new Um)}draw(e,t=!1,s=!1){const r=Gt(at,Ef)._++,i=A(this,hr,Jy).call(this),a=at._svgFactory.createElement("defs");i.append(a);const o=at._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,Zo).set(r,o);const d=s?A(this,hr,OE).call(this,a,l):null,h=at._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(i,e),c(this,Jt).set(r,i),{id:r,clipPathId:`url(#${d})`}}drawOutline(e,t){const s=Gt(at,Ef)._++,r=A(this,hr,Jy).call(this),i=at._svgFactory.createElement("defs");r.append(i);const a=at._svgFactory.createElement("path");i.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=at._svgFactory.createElement("mask");i.append(f),l=`mask_p${this.pageIndex}_${s}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=at._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=at._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const d=at._svgFactory.createElement("use");r.append(d),d.setAttribute("href",`#${o}`),l&&d.setAttribute("mask",`url(#${l})`);const h=d.cloneNode();return r.append(h),d.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(r,e),c(this,Jt).set(s,r),s}finalizeDraw(e,t){c(this,Zo).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:r,rootClass:i,path:a}=t,o=typeof e=="number"?c(this,Jt).get(e):e;if(o){if(s&&A(this,hr,Zy).call(this,o,s),r&&A(l=at,ug,DE).call(l,o,r),i){const{classList:d}=o;for(const[h,f]of Object.entries(i))d.toggle(h,f)}if(a){const h=o.firstChild.firstChild;A(this,hr,Zy).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=c(this,Jt).get(e);s&&(c(t,Cn).append(s),c(this,Jt).delete(e),c(t,Jt).set(e,s))}remove(e){c(this,Zo).delete(e),c(this,Cn)!==null&&(c(this,Jt).get(e).remove(),c(this,Jt).delete(e))}destroy(){v(this,Cn,null);for(const e of c(this,Jt).values())e.remove();c(this,Jt).clear(),c(this,Zo).clear()}};Cn=new WeakMap,Jt=new WeakMap,Zo=new WeakMap,Ef=new WeakMap,ug=new WeakSet,DE=function(e,[t,s,r,i]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*i}%`},hr=new WeakSet,Jy=function(){const e=at._svgFactory.create(1,1,!0);return c(this,Cn).append(e),e.setAttribute("aria-hidden",!0),e},OE=function(e,t){const s=at._svgFactory.createElement("clipPath");e.append(s);const r=`clip_${t}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const i=at._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r},Zy=function(e,t){for(const[s,r]of Object.entries(t))r===null?e.removeAttribute(s):e.setAttribute(s,r)},S(at,ug),S(at,Ef,0);let Qy=at;globalThis._pdfjsTestingUtils={HighlightOutliner:jy};globalThis.pdfjsLib={AbortException:wa,AnnotationEditorLayer:Xy,AnnotationEditorParamsType:xe,AnnotationEditorType:ae,AnnotationEditorUIManager:cl,AnnotationLayer:Sy,AnnotationMode:_i,AnnotationType:Ze,build:ML,ColorPicker:Hm,createValidAbsoluteUrl:CA,DOMSVGFactory:Um,DrawLayer:Qy,FeatureTest:Pt,fetchData:Of,getDocument:L2,getFilenameFromUrl:NR,getPdfFilenameFromUrl:jR,getUuid:RA,getXfaPageViewport:TR,GlobalWorkerOptions:lr,ImageKind:Pp,InvalidPDFException:Ox,isDataScheme:$g,isPdfFile:ow,isValidExplicitDest:UR,MathClamp:es,noContextMenu:On,normalizeUnicode:AR,OPS:Om,OutputScale:dr,PasswordResponses:mR,PDFDataRangeTransport:I2,PDFDateString:lw,PDFWorker:Yd,PermissionFlag:pR,PixelsPerInch:ba,RenderingCancelledException:aw,ResponseException:Fm,setLayerDimensions:ll,shadow:ge,SignatureExtractor:Jr,stopEvent:et,SupportedImageMimeTypes:$x,TextLayer:Xd,TouchManager:Bm,updateUrlHash:TA,Util:te,VerbosityLevel:Dg,version:IL,XfaLayer:O2};const nI="/abtraining.ca/assets/pdf.worker-B8q3_SH5.mjs";lr.workerSrc=nI;const rI=({pdfUrl:n,lessonTitle:e,onClose:t,onComplete:s,showCompleteButton:r=!1})=>{const[i,a]=C.useState(null),[o,l]=C.useState(1),[d,h]=C.useState(0),[f,p]=C.useState(!0),[m,y]=C.useState(null),[x,_]=C.useState(1),[g,w]=C.useState(!1),[b,k]=C.useState(!1),E=C.useRef(null),N=C.useRef(null);C.useEffect(()=>{(async()=>{try{p(!0),y(null),console.log("Loading PDF from URL:",n);const D={url:n,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/cmaps/",cMapPacked:!0,enableXfa:!0};n.includes("supabase.co")&&(D.withCredentials=!1,D.httpHeaders={"Access-Control-Allow-Origin":"*"});const B=await L2(D).promise;console.log("PDF loaded successfully, pages:",B.numPages),a(B),h(B.numPages),l(1)}catch(D){console.error("Error loading PDF:",D),D instanceof Error?D.message.includes("404")||D.message.includes("Not Found")?y("PDF file not found. Please check if the file exists in Supabase Storage."):D.message.includes("CORS")?y("Unable to load PDF due to CORS restrictions. Please check Supabase Storage permissions."):D.message.includes("Unauthorized")||D.message.includes("403")?y("Access denied to PDF file. Please check file permissions in Supabase Storage."):y(`Failed to load PDF: ${D.message}`):y("PDF material could not be loaded. Please check the file path and permissions.")}finally{p(!1)}})()},[n]),C.useEffect(()=>{let $=null;return(async()=>{var Z;if(!(!i||!E.current))try{w(!0);const B=await i.getPage(o),I=E.current,P=I.getContext("2d");if(!P)return;$&&$.cancel();const O=B.getViewport({scale:1}),L=((Z=N.current)==null?void 0:Z.clientWidth)||window.innerWidth-100,H=window.innerHeight-200,U=(L>H?Math.min((L-40)/O.width,3):Math.min((H-40)/O.height,2))*x;console.log("Rendering page",o,"with scale:",U);const X=B.getViewport({scale:U});I.height=X.height,I.width=X.width,P.clearRect(0,0,I.width,I.height),$=B.render({canvasContext:P,viewport:X}),await $.promise,console.log("Page rendered successfully")}catch(B){(B==null?void 0:B.name)!=="RenderingCancelledException"&&(console.error("Error rendering page:",B),y(`Failed to render page ${o}. Please try again.`))}finally{w(!1)}})(),()=>{$&&$.cancel()}},[i,o,x]),C.useEffect(()=>{const $=D=>{switch(D.key){case"ArrowLeft":D.preventDefault(),j();break;case"ArrowRight":D.preventDefault(),T();break;case"Escape":D.preventDefault(),t();break}};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[o,d]);const j=()=>{o>1&&l(o-1)},T=()=>{o<d&&l(o+1)},M=()=>{_($=>Math.min($+.25,4))},F=()=>{_($=>Math.max($-.25,.25))},R=()=>{_(1)},V=async()=>{if(s){k(!0);try{await s(),setTimeout(()=>{t()},1500)}catch($){console.error("Error completing lesson:",$)}finally{k(!1)}}};return C.useEffect(()=>{const $=()=>{if(i&&o){const D=setTimeout(()=>{l(Z=>Z)},100);return()=>clearTimeout(D)}};return window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[i,o]),f?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-8 text-center",children:[u.jsx(bs,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading PDF"}),u.jsx("p",{className:"text-gray-600",children:"Please wait while we load your lesson materials..."})]})}):m?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-8 text-center max-w-md mx-4",children:[u.jsx(si,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Material"}),u.jsx("p",{className:"text-gray-600 mb-6",children:m}),u.jsx("button",{onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200",children:"Close"})]})}):u.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex flex-col z-50",children:[u.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm border-b px-4 py-3 flex items-center justify-between z-50",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate mr-4",children:e}),u.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",o," of ",d]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("div",{className:"flex items-center space-x-1 mr-4",children:[u.jsx("button",{onClick:F,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"Zoom Out",children:u.jsx(nR,{className:"h-5 w-5"})}),u.jsxs("button",{onClick:R,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition-colors duration-200",title:"Reset Zoom",children:[Math.round(x*100),"%"]}),u.jsx("button",{onClick:M,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"Zoom In",children:u.jsx(sR,{className:"h-5 w-5"})})]}),u.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"Close Viewer",children:u.jsx(NA,{className:"h-6 w-6"})})]})]}),u.jsx("div",{className:"flex-1 flex items-center justify-center p-4 overflow-hidden",children:u.jsxs("div",{ref:N,className:"pdf-container relative w-full h-full flex items-center justify-center",children:[u.jsx("button",{onClick:j,disabled:o<=1,className:`absolute left-4 top-1/2 transform -translate-y-1/2 z-10 p-3 rounded-full shadow-lg transition-all duration-200 ${o<=1?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50 hover:shadow-xl"}`,title:"Previous Page (Left Arrow)",children:u.jsx(zd,{className:"h-6 w-6"})}),u.jsx("button",{onClick:T,disabled:o>=d,className:`absolute right-4 top-1/2 transform -translate-y-1/2 z-10 p-3 rounded-full shadow-lg transition-all duration-200 ${o>=d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50 hover:shadow-xl"}`,title:"Next Page (Right Arrow)",children:u.jsx(Hd,{className:"h-6 w-6"})}),u.jsxs("div",{className:"relative bg-white shadow-2xl rounded-lg overflow-hidden",children:[g&&u.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10",children:u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600"})}),u.jsx("canvas",{ref:E,className:"pdf-canvas block"})]})]})}),u.jsx("div",{className:"bg-white border-t px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("button",{onClick:j,disabled:o<=1,className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 ${o<=1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[u.jsx(zd,{className:"h-4 w-4 mr-2"}),"Previous"]}),u.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",o," of ",d]}),u.jsxs("button",{onClick:T,disabled:o>=d,className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 ${o>=d?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:["Next",u.jsx(Hd,{className:"h-4 w-4 ml-2"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[r&&o===d&&u.jsx("button",{onClick:V,disabled:b,className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 ${b?"bg-gray-400 cursor-not-allowed text-white":"bg-green-600 text-white hover:bg-green-700"}`,children:b?u.jsxs(u.Fragment,{children:[u.jsx(bs,{className:"h-4 w-4 mr-2 animate-spin"}),"Completing..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Mark Complete"]})}),u.jsx("div",{className:"text-sm text-gray-500",children:"Use arrow keys to navigate  ESC to close"})]})]})}),u.jsx("style",{jsx:!0,children:`
        .pdf-container {
          width: 100%;
          height: calc(100vh - 200px);
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: auto;
        }
        
        .pdf-canvas {
          display: block;
          margin: 0 auto;
        }
        
        /* Responsive canvas sizing */
        @media (max-width: 768px) {
          .pdf-container {
            height: calc(100vh - 180px);
            padding: 10px;
          }
        }
      `})]})},E1=()=>{const{courseId:n}=Yv(),e=Ca(),{user:t}=ml(),[s,r]=C.useState(null),[i,a]=C.useState([]),[o,l]=C.useState([]),[d,h]=C.useState(!0),[f,p]=C.useState(null),[m,y]=C.useState(null),[x,_]=C.useState(null),[g,w]=C.useState(0),[b,k]=C.useState({isOpen:!1,pdfUrl:null,lessonTitle:null,lessonId:null,moduleId:null});C.useEffect(()=>{n&&(async()=>{if(!await zs()){e("/login",{replace:!0});return}N(),j(),T()})()},[n,t]),C.useEffect(()=>{if(i.length===0){w(0);return}const I=i.filter(O=>M(O.id)).length,P=Math.round(I/i.length*100);w(P)},[i,o]),C.useEffect(()=>{g===100&&t&&s&&m&&E()},[g,t,s,m]);const E=async()=>{try{console.log("Checking if certificate already exists...");const{data:I,error:P}=await se.from("certificates").select("*").eq("student_id",t.id).eq("course_id",n).maybeSingle();if(I){console.log("Certificate already exists, skipping creation.");return}if(P&&P.details&&!P.message.includes("No rows"))throw P;console.log("Generating certificate with Edge Function...");const{data:O,error:L}=await se.functions.invoke("generate-certificate",{body:{studentId:t.id,studentName:(m==null?void 0:m.full_name)||"Student",courseId:n}});if(L)throw console.error("Error invoking function:",L),L;console.log("Certificate generated!",O)}catch(I){console.error("Error generating certificate:",I)}},N=async()=>{try{console.log("Fetching course data for:",n),h(!0);const{data:I,error:P}=await se.from("courses_ats").select("*").eq("id",n).single();if(P){if(P.message.includes("JWT")){await Ht();return}throw P}r(I);const{data:O,error:L}=await se.from("ats_course_modules").select(`
          *,
          ats_module_lessons (
            *,
            ats_lesson_resources (*)
          )
        `).eq("course_id",n).order("order");if(L){if(L.message.includes("JWT")){await Ht();return}throw L}const H=O.map(G=>({id:G.id,title:G.title,description:G.description,order:G.order,lessons:G.ats_module_lessons.sort((ie,U)=>ie.order-U.order).map(ie=>({id:ie.id,title:ie.title,content:ie.content,type:ie.type,order:ie.order,resources:ie.ats_lesson_resources||[]}))}));a(H)}catch(I){console.error("Error fetching course data:",I),p("Failed to load course data")}finally{h(!1)}},j=async()=>{if(!t)return;if(!await zs()){e("/login",{replace:!0});return}try{console.log("Fetching module progress...");const{data:P,error:O}=await se.from("student_module_progress").select("*").eq("student_id",t.id).eq("course_id",n);if(O){if(O.message.includes("JWT")){await Ht();return}throw O}l(P||[])}catch(P){console.error("Error fetching module progress:",P)}},T=async()=>{if(t)try{console.log("Fetching profile...");const{data:I,error:P}=await se.from("students").select("*").eq("id",t.id).single();if(P){console.error("Error fetching profile:",P);return}y(I),console.log("Profile loaded:",I)}catch(I){console.error("Error fetching profile:",I)}},M=I=>o.some(P=>P.module_id===I&&P.completed),F=I=>I===1?!0:i.sort((L,H)=>L.order-H.order).filter(L=>L.order<I).every(L=>M(L.id)),R=I=>M(I.id)?u.jsx(Vt,{className:"w-5 h-5 text-green-500"}):F(I.order)?u.jsx($P,{className:"w-5 h-5 text-gray-400"}):u.jsx(AA,{className:"w-5 h-5 text-gray-400"}),V=async(I,P)=>{if(!t)return;if(!await zs()){e("/login",{replace:!0});return}try{console.log("Marking lesson complete:",I),_(I);const{error:L}=await se.from("student_module_progress").upsert([{student_id:t.id,course_id:n,module_id:P,completed:!0,completed_at:new Date().toISOString()}],{onConflict:"student_id,course_id,module_id"});if(L){if(L.message.includes("JWT")){await Ht();return}throw L}console.log("Lesson marked complete, refreshing progress..."),await j(),alert("Lesson marked as complete!")}catch(L){if(console.error("Error marking lesson complete:",L),L instanceof Error&&L.message.includes("JWT")){await Ht();return}alert("Failed to mark lesson as complete")}finally{_(null)}},$=(I,P,O,L)=>{console.log("Opening PDF viewer with resource:",I);let H="";if(I.url&&(H=I.url),!H){console.error("No PDF URL found for resource:",I),alert("PDF file not found");return}console.log("Final PDF URL:",H);try{new URL(H)}catch{console.error("Invalid PDF URL:",H),alert("Invalid PDF file path");return}k({isOpen:!0,pdfUrl:H,lessonTitle:P,lessonId:O,moduleId:L})},D=I=>{if(I.content&&I.content.trim()){const P=I.content.trim();if(P.startsWith("http"))return P;if(P.includes(".pdf"))return`https://nnhgbtrkxepkeotpdnxw.supabase.co/storage/v1/object/public/media-assets/${P}`}return null},Z=()=>{k({isOpen:!1,pdfUrl:null,lessonTitle:null,lessonId:null,moduleId:null})};C.useEffect(()=>{(async()=>{if(!t)return;await zs()||e("/login",{replace:!0})})()},[t,e]);const B=i.length>0&&i.every(I=>M(I.id));return d?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading course..."})]})}):f||!s?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-red-600 mb-4",children:f||"Course not found"}),u.jsx("button",{onClick:()=>e("/portal/training"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Back to Training"})]})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"min-h-screen bg-gray-50",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s&&u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Course Progress"}),u.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[g,"% Complete"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:u.jsx("div",{className:"bg-green-600 h-3 rounded-full transition-all duration-500",style:{width:`${g}%`}})}),g===100&&u.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Vt,{className:"h-5 w-5 text-green-600 mr-2"}),u.jsx("span",{className:"text-green-800 font-medium",children:"Course completed! Certificate available in your profile."})]})})]}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.title}),u.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),u.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(cn,{className:"w-4 h-4"}),u.jsx("span",{children:s.type})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(gu,{className:"w-4 h-4"}),u.jsx("span",{children:s.duration})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Gd,{className:"w-4 h-4"}),u.jsxs("span",{children:["Max ",s.max_students," students"]})]})]})]})})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[u.jsx("div",{className:"lg:col-span-2 space-y-6",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Course Modules"}),u.jsx("div",{className:"space-y-4",children:i.map(I=>{const P=F(I.order),O=M(I.id);return u.jsxs("div",{className:`border rounded-lg p-4 ${P?"border-gray-200 hover:border-blue-300 hover:shadow-sm":"border-gray-100 bg-gray-50"} transition-all duration-200`,children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[R(I),u.jsxs("div",{children:[u.jsx("h3",{className:`font-medium ${P?"text-gray-900":"text-gray-400"}`,children:I.title}),u.jsx("p",{className:`text-sm ${P?"text-gray-600":"text-gray-400"}`,children:I.description})]})]}),!P&&u.jsx("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"Complete previous modules to unlock"}),O&&u.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:"Completed"})]}),u.jsx("div",{className:"space-y-2",children:I.lessons.map(L=>u.jsx("div",{className:"ml-8",children:u.jsxs("div",{className:`flex items-center justify-between p-3 bg-gray-50 rounded-lg transition-all duration-200 ${P?"hover:bg-gray-100 cursor-pointer":"cursor-not-allowed"}`,onClick:()=>{if(P){const H=D(L);if(H){console.log("Opening PDF from lesson click:",{lessonTitle:L.title,courseTitle:s==null?void 0:s.title,pdfUrl:H});const G={id:"lesson-pdf",title:L.title,resource_type:"file",url:H,file_path:""};$(G,L.title,L.id,I.id)}else console.log("No PDF resource found for lesson:",{lessonTitle:L.title,courseTitle:s==null?void 0:s.title,availableResources:L.resources}),alert("No PDF material available for this lesson")}},children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(KP,{className:`w-4 h-4 ${P?"text-blue-500":"text-gray-300"}`}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-medium text-sm ${P?"text-gray-900":"text-gray-400"}`,children:L.title}),u.jsxs("p",{className:`text-xs ${P?"text-gray-500":"text-gray-400"}`,children:[L.type,"  Click to view slides"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[L.content&&L.content.includes(".pdf")&&u.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-xs ${P?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400"}`,children:[u.jsx(Mx,{className:"w-3 h-3"}),"PDF"]}),P&&!O&&u.jsxs("button",{onClick:H=>{H.stopPropagation(),V(L.id,I.id)},disabled:x===L.id,className:"flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded text-xs font-medium hover:bg-green-200 transition-colors disabled:opacity-50",children:[x===L.id?u.jsx("div",{className:"w-3 h-3 border border-green-600 border-t-transparent rounded-full animate-spin"}):u.jsx(Vt,{className:"w-3 h-3"}),"Mark Complete"]})]})]})},L.id))})]},I.id)})})]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),u.jsx("div",{className:"space-y-3",children:u.jsxs("button",{onClick:()=>e("/portal"),className:"w-full flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[u.jsx(cn,{className:"w-4 h-4"}),"Back to Dashboard"]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Practice Questions"}),u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Test your knowledge with practice questions for this course."}),u.jsxs("button",{onClick:()=>e(`/portal/practice-questions/${n}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[u.jsx(Mx,{className:"w-4 h-4"}),"Practice Questions"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Practice Exam"}),u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Take the practice exam once you've completed all modules."}),u.jsxs("button",{onClick:()=>e(`/portal/practice-exam/${n}`),disabled:!B,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${B?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[u.jsx(Wt,{className:"w-4 h-4"}),B?"Take Practice Exam":"Complete All Modules First"]}),!B&&u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Complete all course modules to unlock the practice exam."})]})]})]})]})}),b.isOpen&&b.pdfUrl&&u.jsx(rI,{pdfUrl:b.pdfUrl,lessonTitle:b.lessonTitle||"Untitled",onClose:Z,onComplete:b.lessonId&&b.moduleId?()=>V(b.lessonId,b.moduleId):void 0,showCompleteButton:b.moduleId?!M(b.moduleId):!1})]})},iI=()=>{const{courseId:n}=Yv(),e=Ca(),{user:t,signOut:s}=ml(),[r,i]=C.useState(null),[a,o]=C.useState(null),[l,d]=C.useState([]),[h,f]=C.useState(0),[p,m]=C.useState([]),[y,x]=C.useState(!0),[_,g]=C.useState(null),[w,b]=C.useState(!1);C.useEffect(()=>{(async()=>{try{const{data:Z,error:B}=await se.from("header_logo").select("*").eq("is_active",!0).order("order_index",{ascending:!0}).limit(1).single();!B&&Z&&i(Z)}catch(Z){console.error("Header logo fetch error:",Z)}})()},[]);const k=20;C.useEffect(()=>{(async()=>{if(!n||!t){e("/login",{replace:!0});return}if(!await zs()){e("/login",{replace:!0});return}try{console.log("Fetching practice questions data..."),x(!0),g(null);const{data:B,error:I}=await se.from("courses_ats").select("id, title, description").eq("id",n).single();if(I){if(I.message.includes("JWT")){await Ht();return}g("Course not found."),console.error("Error fetching course:",I);return}o(B);const{data:P,error:O}=await se.from("practice_questions").select("*").eq("course_id",n);if(O){if(O.message.includes("JWT")){await Ht();return}console.error("Error fetching questions:",O),g("Failed to load practice questions.");return}if(!P||P.length===0){d([]),m([]);return}const L=[...P].sort(()=>Math.random()-.5),H=L.slice(0,Math.min(k,L.length));d(H),m(H.map(()=>({selectedAnswer:null,submitted:!1,showExplanation:!1})))}catch(B){g("An unexpected error occurred."),console.error("Practice questions fetch error:",B)}finally{x(!1)}})()},[n,t,e]);const E=async()=>{try{await Ht()}catch(D){console.error("Sign out error:",D)}},N=D=>{if(p[h].submitted)return;const Z=[...p];Z[h].selectedAnswer=D,m(Z)},j=()=>{const D=[...p];D[h].submitted=!0,D[h].showExplanation=!0,m(D)},T=()=>{h<l.length-1?f(h+1):b(!0)},M=()=>{const D=[...l].sort(()=>Math.random()-.5);d(D),m(D.map(()=>({selectedAnswer:null,submitted:!1,showExplanation:!1}))),f(0),b(!1)},F=()=>{const D=[...p];D[h].showExplanation=!D[h].showExplanation,m(D)},R=D=>{switch(D){case"option_a":return"A";case"option_b":return"B";case"option_c":return"C";case"option_d":return"D";default:return"A"}},V=D=>{const Z=p[h],B=l[h];return Z.submitted?D===B.correct_answer?"bg-green-100 border-green-500 text-green-900":Z.selectedAnswer===D&&D!==B.correct_answer?"bg-red-100 border-red-500 text-red-900":"bg-gray-50 border-gray-300 text-gray-500":Z.selectedAnswer===D?"bg-blue-100 border-blue-500 text-blue-900":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},$=D=>{const Z=p[h],B=l[h];return Z.submitted?D===B.correct_answer?u.jsx(Vt,{className:"h-5 w-5 text-green-600"}):Z.selectedAnswer===D&&D!==B.correct_answer?u.jsx(kA,{className:"h-5 w-5 text-red-600"}):null:null};return y?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading practice questions..."})]})}):_||!a?u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-6",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:"/ATS.png",alt:"Aboriginal Training Services",className:"h-12 w-auto mr-4"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Portal"}),u.jsx("p",{className:"text-gray-600",children:"Practice Questions"})]})]}),u.jsxs("button",{onClick:E,className:"flex items-center px-4 py-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200",children:[u.jsx(Wd,{className:"h-5 w-5 mr-2"}),"Sign Out"]})]})})}),u.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx(si,{className:"h-16 w-16 text-red-400 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Practice Questions"}),u.jsx("p",{className:"text-gray-600 mb-8",children:_||"The requested course could not be found."}),u.jsxs(_e,{to:"/portal",className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Portal"]})]})})]}):u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-6",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:(r==null?void 0:r.logo_url)||"/ATS.png",alt:(r==null?void 0:r.alt_text)||"Aboriginal Training Services",className:"h-12 w-auto mr-4",onError:D=>{D.currentTarget.src="/ATS.png",D.currentTarget.alt="Aboriginal Training Services"}}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Portal"}),u.jsx("p",{className:"text-gray-600",children:"Practice Questions"})]})]}),u.jsxs("button",{onClick:E,className:"flex items-center px-4 py-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200",children:[u.jsx(Wd,{className:"h-5 w-5 mr-2"}),"Sign Out"]})]})})}),u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsx("div",{className:"mb-8",children:u.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[u.jsx(_e,{to:"/",className:"hover:text-blue-600 transition-colors duration-200",children:u.jsx(SA,{className:"h-4 w-4"})}),u.jsx("span",{children:"/"}),u.jsx(_e,{to:"/portal",className:"hover:text-blue-600 transition-colors duration-200",children:"Portal"}),u.jsx("span",{children:"/"}),u.jsx(_e,{to:`/student/courses/${n}`,className:"hover:text-blue-600 transition-colors duration-200",children:a.title||"Course"}),u.jsx("span",{children:"/"}),u.jsx("span",{className:"text-gray-900 font-medium",children:"Practice Questions"})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a.title||"Course Practice Questions"}),u.jsx("p",{className:"text-gray-600",children:"Test your knowledge with practice questions"})]}),u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Course"]})]})}),l.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[u.jsx(rw,{className:"h-16 w-16 text-gray-300 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Practice Questions Available"}),u.jsx("p",{className:"text-gray-600 mb-8",children:"Practice questions for this course are currently being updated. Please check back later."}),u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Course"]})]}):w?u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[u.jsx(Wt,{className:"h-16 w-16 text-green-600 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Practice Completed!"}),u.jsxs("p",{className:"text-gray-600 mb-8",children:["Great job! You've completed all ",l.length," practice questions. Keep practicing to reinforce your learning."]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[u.jsxs("button",{onClick:M,className:"inline-flex items-center px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(JP,{className:"h-5 w-5 mr-2"}),"Try New Questions"]}),u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(cn,{className:"h-5 w-5 mr-2"}),"Back to Course"]})]})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Question ",h+1," of ",l.length]}),u.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round((h+1)/l.length*100),"% Complete"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(h+1)/l.length*100}%`}})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:l[h].question}),l[h].image_url&&u.jsx("div",{className:"mb-6",children:u.jsx("img",{src:l[h].image_url,alt:"Question illustration",className:"max-w-full h-auto rounded-lg shadow-md",onError:D=>{D.currentTarget.style.display="none"}})})]}),u.jsx("div",{className:"space-y-3 mb-6",children:["option_a","option_b","option_c","option_d"].map(D=>{const Z=R(D),B=l[h][D];return u.jsxs("button",{onClick:()=>N(Z),disabled:p[h].submitted,className:`w-full p-4 border-2 rounded-lg text-left transition-all duration-200 flex items-center justify-between ${V(Z)} ${p[h].submitted?"cursor-not-allowed":"cursor-pointer"}`,children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("span",{className:"font-bold mr-3 text-lg",children:[Z,"."]}),u.jsx("span",{children:B})]}),$(Z)]},D)})}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:p[h].submitted?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:T,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors duration-200",children:h<l.length-1?"Next Question":"Complete Practice"}),u.jsx("button",{onClick:F,className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold transition-colors duration-200 flex items-center",children:p[h].showExplanation?u.jsxs(u.Fragment,{children:[u.jsx(HP,{className:"h-4 w-4 mr-2"}),"Hide Explanation"]}):u.jsxs(u.Fragment,{children:[u.jsx(nw,{className:"h-4 w-4 mr-2"}),"Show Explanation"]})})]}):u.jsx("button",{onClick:j,disabled:!p[h].selectedAnswer,className:`px-6 py-3 rounded-lg font-semibold transition-all duration-200 ${p[h].selectedAnswer?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Submit Answer"})}),p[h].submitted&&p[h].showExplanation&&u.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxs("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[u.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Explanation"]}),u.jsx("p",{className:"text-blue-800 leading-relaxed",children:l[h].explanation})]})]})]})]})]})},aI=()=>{const{courseId:n}=Yv(),e=Ca(),{user:t,signOut:s}=ml(),[r,i]=C.useState(null),[a,o]=C.useState(null),[l,d]=C.useState([]),[h,f]=C.useState(0),[p,m]=C.useState([]),[y,x]=C.useState(!0),[_,g]=C.useState(null),[w,b]=C.useState(!1),[k,E]=C.useState(null),[N,j]=C.useState(null),[T,M]=C.useState(null);C.useEffect(()=>{(async()=>{try{const{data:O,error:L}=await se.from("header_logo").select("*").eq("is_active",!0).order("order_index",{ascending:!0}).limit(1).single();!L&&O&&i(O)}catch(O){console.error("Header logo fetch error:",O)}})()},[]),C.useEffect(()=>{(async()=>{if(!n||!t){e("/login",{replace:!0});return}if(!await zs()){e("/login",{replace:!0});return}try{console.log("Fetching practice exam data..."),x(!0),g(null);const{data:L,error:H}=await se.from("courses_ats").select("id, title, description, exam_number_of_questions, exam_duration_minutes").eq("id",n).single();if(H){if(H.message.includes("JWT")){await Ht();return}g("Course not found."),console.error("Error fetching course:",H);return}o(L);const{data:G,error:ie}=await se.from("practice_questions").select("*").eq("course_id",n);if(ie){if(ie.message.includes("JWT")){await Ht();return}console.error("Error fetching questions:",ie),g("Failed to load exam questions.");return}if(!G||G.length===0){d([]),m([]);return}const U=L.exam_number_of_questions||50,X=L.exam_duration_minutes||60,he=[...G].sort(()=>Math.random()-.5),le=he.slice(0,Math.min(U,he.length));d(le),m(le.map(()=>({selectedAnswer:null}))),j(X*60),M(new Date)}catch(L){g("An unexpected error occurred."),console.error("Practice exam fetch error:",L)}finally{x(!1)}})()},[n,t,e]),C.useEffect(()=>{if(N===null||N<=0||w)return;const P=setInterval(()=>{j(O=>O===null||O<=1?(Z(),0):O-1)},1e3);return()=>clearInterval(P)},[N,w]);const F=P=>{const O=Math.floor(P/3600),L=Math.floor(P%3600/60),H=P%60;return O>0?`${O}:${L.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`:`${L}:${H.toString().padStart(2,"0")}`},R=async()=>{try{await Ht()}catch(P){console.error("Sign out error:",P)}},V=P=>{if(w)return;const O=[...p];O[h].selectedAnswer=P,m(O)},$=()=>{h>0&&f(h-1)},D=()=>{h<l.length-1&&f(h+1)},Z=async()=>{if(!t||!a)return;if(!await zs()){e("/login",{replace:!0});return}try{console.log("Submitting exam...");let O=0;l.forEach((U,X)=>{p[X].selectedAnswer===U.correct_answer&&O++});const L=Math.round(O/l.length*100),H=70,G=L>=H;E({score:O,percentage:L,passed:G,passingScore:H});const{error:ie}=await se.from("student_exam_attempts").insert([{student_id:t.id,course_id:n,started_at:T==null?void 0:T.toISOString(),completed_at:new Date().toISOString(),answers:p.map((U,X)=>({question_id:l[X].id,selected_answer:U.selectedAnswer,correct_answer:l[X].correct_answer,is_correct:U.selectedAnswer===l[X].correct_answer})),score:L,duration_minutes:a.exam_duration_minutes||60,is_submitted:!0}]);if(ie){if(ie.message.includes("JWT")){await Ht();return}console.error("Error saving exam attempt:",ie)}console.log("Exam submitted successfully"),b(!0)}catch(O){console.error("Error submitting exam:",O),O instanceof Error&&O.message.includes("JWT")&&await Ht()}},B=P=>{const O=p[h],L=l[h];return w?P===L.correct_answer?"bg-green-100 border-green-500 text-green-900":O.selectedAnswer===P&&P!==L.correct_answer?"bg-red-100 border-red-500 text-red-900":"bg-gray-50 border-gray-300 text-gray-500":O.selectedAnswer===P?"bg-blue-100 border-blue-500 text-blue-900":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},I=P=>{const O=p[h],L=l[h];return w?P===L.correct_answer?u.jsx(Vt,{className:"h-5 w-5 text-green-600"}):O.selectedAnswer===P&&P!==L.correct_answer?u.jsx(kA,{className:"h-5 w-5 text-red-600"}):null:null};return y?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bs,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading practice exam..."})]})}):_||!a?u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-6",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:"/ATS.png",alt:"Aboriginal Training Services",className:"h-12 w-auto mr-4"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Portal"}),u.jsx("p",{className:"text-gray-600",children:"Practice Exam"})]})]}),u.jsxs("button",{onClick:R,className:"flex items-center px-4 py-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200",children:[u.jsx(Wd,{className:"h-5 w-5 mr-2"}),"Sign Out"]})]})})}),u.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx(si,{className:"h-16 w-16 text-red-400 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Practice Exam"}),u.jsx("p",{className:"text-gray-600 mb-8",children:_||"The requested course could not be found."}),u.jsxs(_e,{to:"/portal",className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Portal"]})]})})]}):u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-6",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:(r==null?void 0:r.logo_url)||"/ATS.png",alt:(r==null?void 0:r.alt_text)||"Aboriginal Training Services",className:"h-12 w-auto mr-4",onError:P=>{P.currentTarget.src="/ATS.png",P.currentTarget.alt="Aboriginal Training Services"}}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Portal"}),u.jsx("p",{className:"text-gray-600",children:"Practice Exam"})]})]}),u.jsxs("button",{onClick:R,className:"flex items-center px-4 py-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200",children:[u.jsx(Wd,{className:"h-5 w-5 mr-2"}),"Sign Out"]})]})})}),u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsx("div",{className:"mb-8",children:u.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[u.jsx(_e,{to:"/",className:"hover:text-blue-600 transition-colors duration-200",children:u.jsx(SA,{className:"h-4 w-4"})}),u.jsx("span",{children:"/"}),u.jsx(_e,{to:"/portal",className:"hover:text-blue-600 transition-colors duration-200",children:"Portal"}),u.jsx("span",{children:"/"}),u.jsx(_e,{to:`/student/courses/${n}`,className:"hover:text-blue-600 transition-colors duration-200",children:a.title||"Course"}),u.jsx("span",{children:"/"}),u.jsx("span",{className:"text-gray-900 font-medium",children:"Practice Exam"})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a.title||"Course Practice Exam"}),u.jsx("p",{className:"text-gray-600",children:"Final assessment for course completion"})]}),u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Course"]})]}),N!==null&&!w&&u.jsxs("div",{className:"flex items-center justify-center p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[u.jsx(gu,{className:"h-5 w-5 text-yellow-600 mr-2"}),u.jsxs("span",{className:"font-semibold text-yellow-800",children:["Time Remaining: ",F(N)]})]})]}),l.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[u.jsx(rw,{className:"h-16 w-16 text-gray-300 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Exam Questions Available"}),u.jsx("p",{className:"text-gray-600 mb-8",children:"Exam questions for this course are currently being updated. Please check back later."}),u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(sl,{className:"h-5 w-5 mr-2"}),"Back to Course"]})]}):k?u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[u.jsx(Wt,{className:`h-16 w-16 mx-auto mb-6 ${k.passed?"text-green-600":"text-red-600"}`}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Exam Completed!"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-3xl font-bold text-gray-900",children:k.score}),u.jsx("div",{className:"text-gray-600",children:"Correct Answers"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:`text-3xl font-bold ${k.passed?"text-green-600":"text-red-600"}`,children:[k.percentage,"%"]}),u.jsx("div",{className:"text-gray-600",children:"Final Score"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:`text-lg font-bold ${k.passed?"text-green-600":"text-red-600"}`,children:k.passed?"PASSED":"FAILED"}),u.jsxs("div",{className:"text-gray-600",children:["Passing: ",k.passingScore,"%"]})]})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:u.jsxs(_e,{to:`/student/courses/${n}`,className:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[u.jsx(cn,{className:"h-5 w-5 mr-2"}),"Back to Course"]})})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Question ",h+1," of ",l.length]}),u.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round((h+1)/l.length*100),"% Complete"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${(h+1)/l.length*100}%`}})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:l[h].question}),l[h].image_url&&u.jsx("div",{className:"mb-6",children:u.jsx("img",{src:l[h].image_url,alt:"Question illustration",className:"max-w-full h-auto rounded-lg shadow-md",onError:P=>{P.currentTarget.style.display="none"}})})]}),u.jsx("div",{className:"space-y-3 mb-6",children:["option_a","option_b","option_c","option_d"].map(P=>{const O=P.split("_")[1].toUpperCase(),L=l[h][P];return u.jsxs("button",{onClick:()=>V(O),disabled:w,className:`w-full p-4 border-2 rounded-lg text-left transition-all duration-200 flex items-center justify-between ${B(O)} ${w?"cursor-not-allowed":"cursor-pointer"}`,children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("span",{className:"font-bold mr-3 text-lg",children:[O,"."]}),u.jsx("span",{children:L})]}),I(O)]},P)})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("button",{onClick:$,disabled:h===0,className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 ${h===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[u.jsx(zd,{className:"h-4 w-4 mr-2"}),"Previous"]}),u.jsx("div",{className:"flex gap-4",children:h===l.length-1?u.jsxs("button",{onClick:Z,className:"flex items-center px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors duration-200",children:[u.jsx(EA,{className:"h-4 w-4 mr-2"}),"Submit Exam"]}):u.jsxs("button",{onClick:D,className:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors duration-200",children:["Next",u.jsx(Hd,{className:"h-4 w-4 ml-2"})]})})]}),w&&u.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxs("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[u.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Explanation"]}),u.jsx("p",{className:"text-blue-800 leading-relaxed",children:l[h].explanation})]})]})]})]})]})},oI=()=>{const[n,e]=C.useState({full_name:"",email:"",phone:"",consent_to_terms:!1}),[t,s]=C.useState(!1),[r,i]=C.useState(!1),[a,o]=C.useState(null),l=h=>{const{name:f,value:p,type:m,checked:y}=h.target;e(x=>({...x,[f]:m==="checkbox"?y:p}))},d=async h=>{if(h.preventDefault(),o(null),!n.consent_to_terms){o("You must consent to the terms to sign up.");return}s(!0);try{const{error:f}=await se.from("student_signups").insert([{full_name:n.full_name.trim(),email:n.email.trim(),phone:n.phone.trim()||null,consent_to_terms:n.consent_to_terms}]);if(f)throw console.error("Error inserting signup:",f),f;i(!0),e({full_name:"",email:"",phone:"",consent_to_terms:!1}),setTimeout(()=>{i(!1)},5e3)}catch(f){console.error("Submit error:",f),o("There was a problem submitting your sign-up. Please try again.")}finally{s(!1)}};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:r?u.jsxs("div",{className:"text-center",children:[u.jsx(Vt,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Sign-up successful!"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"We have received your information. We will contact you soon."}),u.jsx(_e,{to:"/login",className:"inline-block mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Go to Login"})]}):u.jsxs(u.Fragment,{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Sign Up"}),u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[a&&u.jsxs("div",{className:"flex items-center bg-red-50 border border-red-200 text-red-800 text-sm rounded p-2",children:[u.jsx(si,{className:"w-5 h-5 mr-2"}),a]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),u.jsx("input",{type:"text",name:"full_name",required:!0,value:n.full_name,onChange:l,className:"w-full border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),u.jsx("input",{type:"email",name:"email",required:!0,value:n.email,onChange:l,className:"w-full border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),u.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:l,className:"w-full border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",name:"consent_to_terms",checked:n.consent_to_terms,onChange:l,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),u.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"I agree to the terms and privacy policy."})]}),u.jsx("button",{type:"submit",disabled:t,className:`w-full py-3 rounded text-white font-medium transition ${t?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:t?u.jsxs("span",{className:"flex items-center justify-center",children:[u.jsx(bs,{className:"w-5 h-5 animate-spin mr-2"}),"Submitting..."]}):"Sign Up"})]})]})})})};function lI(){return u.jsx(MP,{children:u.jsx(hC,{children:u.jsxs(iC,{children:[u.jsx(Ks,{path:"/",element:u.jsx(Lu,{children:u.jsx(lR,{})})}),u.jsx(Ks,{path:"/training",element:u.jsx(Lu,{children:u.jsx(cR,{})})}),u.jsx(Ks,{path:"/indigenous-relations",element:u.jsx(Lu,{children:u.jsx(uR,{})})}),u.jsx(Ks,{path:"/dashboard",element:u.jsx(Lu,{children:u.jsx(dR,{})})}),u.jsx(Ks,{path:"/sign-up",element:u.jsx(Lu,{children:u.jsx(oI,{})})}),u.jsx(Ks,{path:"/login",element:u.jsx(hR,{})}),u.jsx(Ks,{path:"/portal",element:u.jsx(Iu,{children:u.jsx(fR,{})})}),u.jsx(Ks,{path:"/student/courses/:courseId",element:u.jsx(Iu,{children:u.jsx(E1,{})})}),u.jsx(Ks,{path:"/course/:courseId",element:u.jsx(Iu,{children:u.jsx(E1,{})})}),u.jsx(Ks,{path:"/portal/practice-questions/:courseId",element:u.jsx(Iu,{children:u.jsx(iI,{})})}),u.jsx(Ks,{path:"/portal/practice-exam/:courseId",element:u.jsx(Iu,{children:u.jsx(aI,{})})})]})})})}BS(document.getElementById("root")).render(u.jsx(C.StrictMode,{children:u.jsx(lI,{})}));
